//
// Copyright (c) Microsoft Corporation.  All rights reserved.
//

(function(n,t){"use strict";n.es3Shims={},Object.create===t&&(n.es3Shims.create=function(i,r){function u(){}i!==null&&(u.prototype=i);var f=new u;return r!==t&&n.es3Shims.defineProperties(f,r),f},n.es3Shims.defineProperty=function(n,i,r){if(n!==null)if(r.value!==t)n[i]=r.value;else if(r.get)n[i]=r.get.call(n);else throw"Can not shim property";},n.es3Shims.defineProperties=function(n,i){var r,u;if(n!==null)for(r in i)u=i[r],u.value!==t&&(n[r]=u.value)},n.es3Shims.freeze=function(n){return n},n.es3Shims.keys=function(n){var t=[],i;for(i in n)t.push(i);return t}),n.es3Shims.bind=function(n){var i=this,t=Array.prototype.slice,r=t.call(arguments,1);return function(){return i.apply(n,r.concat(t.call(arguments)))}},Object.create=Object.create||n.es3Shims.create,Object._defineProperty=function(){if(Object.defineProperty)try{return Object.defineProperty({},"x",{}),Object.defineProperty}catch(t){return n.es3Shims.defineProperty}else return Object.defineProperty=n.es3Shims.defineProperty}(),Object.defineProperties=Object.defineProperties||n.es3Shims.defineProperties,Object.freeze=Object.freeze||n.es3Shims.freeze,Object.keys=Object.keys||n.es3Shims.keys,Function.prototype.bind=Function.prototype.bind||n.es3Shims.bind,Date.now||(Date.now=function(){return(new Date).valueOf()})})(this),function(n,t){"use strict";function i(n,i){for(var s=Object.keys(i),u,e=0,h=s.length;e<h;e++){var f=s[e],o=f.charCodeAt(0)!==95,r=i[f];if(r&&typeof r=="object"&&(r.value!==t||typeof r.get=="function"||typeof r.set=="function")){r.enumerable===t&&(r.enumerable=o),u=u||{},u[f]=r;continue}if(!o){u=u||{},u[f]={value:r,enumerable:o,configurable:!0,writable:!0};continue}n[f]=r}u&&Object.defineProperties(n,u)}(function(t){function u(n,t,r){for(var u=n,o=t.split("."),e,f=0,s=o.length;f<s;f++)e=o[f],u[e]||Object._defineProperty(u,e,{value:{},writable:!1,enumerable:!0,configurable:!0}),u=u[e];return r&&i(u,r),u}function f(t,i){return u(n,t,i)}n[t]||(n[t]=Object.create(Object.prototype));var r=n[t];r.Namespace||(r.Namespace=Object.create(Object.prototype)),Object.defineProperties(r.Namespace,{defineWithParent:{value:u,writable:!0,enumerable:!0,configurable:!0},define:{value:f,writable:!0,enumerable:!0,configurable:!0}})})("WinJS"),function(n){function t(n,t,r){return n=n||function(){},t&&i(n.prototype,t),r&&i(n,r),n}function r(n,r,u,f){if(n){r=r||function(){};var e=n.prototype;return r.prototype=Object.create(e),Object._defineProperty(r.prototype,"constructor",{value:r,writable:!0,configurable:!0,enumerable:!0}),u&&i(r.prototype,u),f&&i(r,f),r}return t(r,u,f)}function u(n){n=n||function(){};for(var t=1,r=arguments.length;t<r;t++)i(n.prototype,arguments[t]);return n}n.Namespace.define("WinJS.Class",{define:t,derive:r,mix:u})}(WinJS)}(this),function(n){"use strict";function i(n){var t="_on"+n+"state";return{get:function(){var n=this[t];return n&&n.userHandler},set:function(i){var r=this[t];i?(r||(r={wrapper:function(n){return r.userHandler(n)},userHandler:i},Object._defineProperty(this,t,{value:r,enumerable:!1,writable:!0,configurable:!0}),this.addEventListener(n,r.wrapper,!1)),r.userHandler=i):r&&(this.removeEventListener(n,r.wrapper,!1),this[t]=null)},enumerable:!0}}function r(){for(var r={},u,t=0,f=arguments.length;t<f;t++)u=arguments[t],r["on"+u]=i(u);return r}var u=n.Class.define(function(n,t,i){this.detail=t,this.target=i,this.timeStamp=Date.now(),this.type=n},{bubbles:{value:!1,writable:!1},cancelable:{value:!1,writable:!1},currentTarget:{get:function(){return this.target}},defaultPrevented:{get:function(){return this._preventDefaultCalled}},trusted:{value:!1,writable:!1},eventPhase:{value:0,writable:!1},target:null,timeStamp:null,type:null,preventDefault:function(){this._preventDefaultCalled=!0},stopImmediatePropagation:function(){this._stopImmediatePropagationCalled=!0},stopPropagation:function(){}},{supportedForProcessing:!1}),f={_listeners:null,addEventListener:function(n,t,i){var r,u,e,f;for(i=i||!1,this._listeners=this._listeners||{},r=this._listeners[n]=this._listeners[n]||[],u=0,e=r.length;u<e;u++)if(f=r[u],f.useCapture===i&&f.listener===t)return;r.push({listener:t,useCapture:i})},dispatchEvent:function(n,t){var i=this._listeners&&this._listeners[n],r,f,e;if(i){for(r=new u(n,t,this),i=i.slice(0,i.length),f=0,e=i.length;f<e&&!r._stopImmediatePropagationCalled;f++)i[f].listener(r);return r.defaultPrevented||!1}return!1},removeEventListener:function(n,t,i){var r,u,e,f;if(i=i||!1,r=this._listeners&&this._listeners[n],r)for(u=0,e=r.length;u<e;u++)if(f=r[u],f.listener===t&&f.useCapture===i){r.splice(u,1),r.length===0&&delete this._listeners[n];break}}};n.Namespace.define("WinJS.Utilities",{_createEventProperty:i,createEventProperties:r,eventMixin:f})}(WinJS),function(n){"use strict";n.fn.isVisible=function(){return this.is(":visible")&&this.css("visibility")!=="hidden"};var i=function(n,t,i){var r;return function(){function e(){i||n.apply(u,f),r=null}var u=this,f=arguments;r||(i&&n.apply(u,f),r=setTimeout(e,t||50))}},r=function(n,t){var i=n.width(),r=n.height();return function(){var u=n.width(),f=n.height();(u!==i||f!==r)&&(i=u,r=f,t.call(this,arguments))}};jQuery.fn.smartresize=function(n){if(n){var t=i(n);this.on("resize",r(this,t));this.on("orientationchange",t)}else this.trigger("smartresize")}}(jQuery);
/*! jQuery.XDomainRequest.js version 1.0

Microsoft grants you the right to use these script files for the sole purpose of either: (i) interacting through your browser with the Microsoft website, subject to the website’s terms of use; or (ii) using the files as included with a Microsoft product subject to that product’s license terms. Microsoft reserves all other rights to the files not expressly granted by Microsoft, whether by implication, estoppel or otherwise. The notices and licenses below are for informational purposes only.


Provided for Informational Purposes Only
MIT License
Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
(function(n){if(!n.support.cors&&n.ajaxTransport&&window.XDomainRequest){var t=/^https?:\/\//i,i=/^get|post$/i,r=new RegExp("^"+location.protocol,"i"),u=/text\/html/i,f=/\/json/i,e=/\/xml/i;n.ajaxTransport("* text html xml json",function(o,s){if(o.crossDomain&&o.async&&i.test(o.type)&&t.test(o.url)&&r.test(o.url)){var c=null,l=(s.dataType||"").toLowerCase();return{send:function(t,i){c=new XDomainRequest,/^\d+$/.test(s.timeout)&&(c.timeout=s.timeout),c.ontimeout=function(){i(500,"timeout")},c.onload=function(){var s="Content-Length: "+c.responseText.length+"\r\nContent-Type: "+c.contentType,r={code:200,message:"success"},o={text:c.responseText},t;try{if(l==="html"||u.test(c.contentType))o.html=c.responseText;else if(l==="json"||l!=="text"&&f.test(c.contentType))try{o.json=n.parseJSON(c.responseText)}catch(a){r.code=500,r.message="parseerror"}else if(l==="xml"||l!=="text"&&e.test(c.contentType)){t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1;try{t.loadXML(c.responseText)}catch(a){t=undefined}if(!t||!t.documentElement||t.getElementsByTagName("parsererror").length){r.code=500,r.message="parseerror";throw"Invalid XML: "+c.responseText;}o.xml=t}}catch(h){throw h;}finally{i(r.code,r.message,o,s)}},c.onprogress=function(){},c.onerror=function(){i(500,"error",{text:c.responseText})};var r="";s.data&&(r=n.type(s.data)==="string"?s.data:n.param(s.data)),c.open(o.type,o.url),c.send(r)},abort:function(){c&&c.abort()}}}})}})(jQuery);
/*! End jQuery.XDomainRequest.js version 1.0 */
(function(n,t,i){"use strict";var r=navigator.userAgent,e=r.match(/Android/i)&&r.match(/Mozilla\/5\.0/i)&&r.match(/AppleWebKit/i)&&!r.match(/Chrome/i);if(!window.matchMedia||e){var u=function(t){if(t===i)throw"TypeError: Not enough arguments";this.media=t,this._eventListeners=[],f.call(this),n(window).smartresize(o.bind(this))},o=function(){f.call(this)},f=function(){var i=this.matches,n=t.testStyles("@media "+this.media+" { #modernizr { position: absolute; } }",function(n){return(window.getComputedStyle?getComputedStyle(n,null):n.currentStyle).position==="absolute"});this.matches=n,i!==n&&s.call(this)},s=function(){for(var t=this._eventListeners,n=0,i=t.length;n<i;n++)t[n].call(window,this)};u.prototype.addListener=function(n){for(var t=this._eventListeners,i=0,r=t.length;i<r;i++)if(t[i]===n)return;t.push(n)},u.prototype.removeListener=function(n){var i,t,r;if(n)for(i=this._eventListeners,t=0,r=i.length;t<r;t++)if(i[t]===n){i.splice(t,1);break}},window.matchMedia=function(n){return new u(n)}}})(jQuery,Modernizr),Type.registerNamespace("Wol.Util"),Wol.Util.TypeCheck={StringType:1,NumberType:2,BooleanType:4,isString:function(n){return n==undefined||n==null?!1:typeof n=="string"?!0:n instanceof String?!0:!1},isNumber:function(n){return n==undefined||n==null?!1:typeof n=="number"?!0:n instanceof Number?!0:!1},isBoolean:function(n){return n==undefined||n==null?!1:typeof n=="boolean"?!0:n instanceof Boolean?!0:!1},isOfType:function(n,t){if(Sys.Debug.assert(arguments.length==2),!Wol.Util.TypeCheck.isNumber(t))throw Error.argument("type","type must be integer!");var i=!1;return t|Wol.Util.TypeCheck.StringType==Wol.Util.TypeCheck.StringType&&(i=Wol.Util.TypeCheck.isString(n),i==!0)?!0:t|Wol.Util.TypeCheck.StringType==Wol.Util.TypeCheck.NumberType&&(i=Wol.Util.TypeCheck.isNumber(n),i==!0)?!0:t|Wol.Util.TypeCheck.StringType==Wol.Util.TypeCheck.BooleanType&&(i=Wol.Util.TypeCheck.isBoolean(n),i==!0)?!0:i}},Wol.Util.Event=function(n){Sys.Debug.assert(arguments.length<=1),n?(Sys.Debug.assert(Wol.Util.TypeCheck.isString(n)),this._name=n):this._name="GenericEvent"},Wol.Util.Event.prototype={get_events:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},addHandler:function(n){Sys.Debug.assert(arguments.length==1),Sys.Debug.assert(n!=undefined&&n!=null),this.get_events().addHandler(this._name,n)},removeHandler:function(n){Sys.Debug.assert(arguments.length==1),Sys.Debug.assert(n!=undefined&&n!=null),this.get_events().removeHandler(this._name,n)},raiseEvent:function(n){Sys.Debug.assert(arguments.length<=1);var t=this.get_events().getHandler(this._name);t&&((n==undefined||n==null)&&(n=Sys.EventArgs.Empty),t(this,n))}},Wol.Util.Event.registerClass("Wol.Util.Event"),Wol.Util.RefCountEvent=function(){Wol.Util.RefCountEvent.initializeBase(this),this._handlerList=[]},Wol.Util.RefCountEvent.prototype={get_HandlersCount:function(){return this._handlerList.length},onHandlersChange:new Wol.Util.Event("on"+this._name+"_HandlersChange"),addHandler:function(n){var t=!1,i;return this._handlerList&&!Array.contains(this._handlerList,n)&&(Array.add(this._handlerList,n),t=!0),i=Wol.Util.RefCountEvent.callBaseMethod(this,"addHandler",[n]),t&&this.onHandlersChange.raiseEvent(),i},removeHandler:function(n){var t=!1,i;return this._handlerList&&(Array.remove(this._handlerList,n),t=!0),i=Wol.Util.RefCountEvent.callBaseMethod(this,"removeHandler",[n]),t&&this.onHandlersChange.raiseEvent(),i}},Wol.Util.RefCountEvent.registerClass("Wol.Util.RefCountEvent",Wol.Util.Event),Wol.Util.Direction=function(n){"use strict";var t=function(){return t=n("body").css("direction")==="ltr"?function(){return!0}:function(){return!1},t()},i=function(){return t()?"left":"right"},r=function(){return t()?"right":"left"},u=function(i,r,u){var e=n(i),o=r?e.outerWidth(u):e.width(),f=e.position();return f.right=f.left+o,t()?(f.near=f.left,f.far=f.right):(f.near=f.right,f.far=f.left),f},f=function(i,r,u,f){var e=n(i),o;t()?e.css("left",r+"px"):(o=u?e.outerWidth(f):e.width(),e.css("left",r-o+"px"))},e=function(i,r,u,f){var e=n(i),o=u?e.outerWidth(f):e.width();t()?e.css("left",r-o+"px"):e.css("left",r+"px")};return{isLtr:t,nearString:i,farString:r,position:u,setNearPixels:f,setFarPixels:e}}(jQuery),Wol.Util.Tools={cloneProperties:function(n,t,i){Sys.Debug.assert(arguments.length==3),Sys.Debug.assert(n!=undefined&&n!=null),Sys.Debug.assert(t!=undefined&&t!=null),Sys.Debug.assert(i!=undefined&&i!=null&&i.length>=0);for(var r=0;r<i.length;r++)t[i[r]]=n[i[r]].clone()},parseUrlParams:function(n){var r,e,t,o;if(n===null||n==="")return{};if(typeof n!="string")throw"parseUrlParams: the input parameter must be a string";var i={},u=n.trim().split("&"),f=/[?#&]*([^=]+)(\=([^#]*))?/;for(r=0,e=u.length;r<e;r++){t=f.exec(u[r]);try{t[2]?(o=t[3].replace(/\+/g,"%20"),i[decodeURIComponent(t[1])]=jQuery.trim(decodeURIComponent(o))):i[decodeURIComponent(t[1])]=null}catch(s){}}return i},toUrlParams:function(n){var f=[],i=[],r,t,u,e;for(t in n)n.hasOwnProperty(t)&&(r=typeof n[t],r==="string"||r==="number"||r==="boolean"||n[t]===null)&&i.push(t);for(i.sort(),u=0,e=i.length;u<e;u++)value=n[i[u]],t=encodeURIComponent(i[u]),value===null?f.push(t):(value=encodeURIComponent(value).replace(/\%20/g,"+").replace(/'/g,"%27"),f.push(t+"="+value));return f.join("&")},truncateWithEllipsis:function(n,t,i){var r=n.text(),f;if(n.width()<=i)return r;var e=t+r,o=function(t){return n.text(e.substring(0,t+1)),n.width()<=i},u=Wol.Util.Algorithm.partitionPoint(e,o)-t.length;return n.text(r),u<0?"":u<2?t:(f=r.substring(0,u),f=jQuery.trim(f)+t)},scrollToInPageAnchor:function(){var t=[],r=Wol.Util.HashParameters.getHash(),u,i,f,n;for(u in r)r[u]||t.push(u);for(i=0;i<t.length;i++)if(f=t[i],n=$("#"+f).first(),n.length||(n=$("[name='"+f+"']").first()),n.length&&n.isVisible()){$(document).scrollTop(n.offset().top);break}},generateGuid:function(){var n=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}},Wol.Util.OnBeforeUnload=function(){"use strict";var t=new Wol.Util.RefCountEvent("onBeforeUnloadEvent"),n=!1,i;$(function(){window.addEventListener?window.addEventListener("beforeunload",r,!0):window.attachEvent&&window.attachEvent("onbeforeunload",r)});var r=function(r){n?(clearTimeout(i),n=!1):t.raiseEvent(r)},u=function(n){t.addHandler(n)},f=function(n){t.removeHandler(n)},e=function(){n=!0,clearTimeout(i),i=setTimeout(function(){n=!1},1e3)};return{attach:u,detach:f,suppressNextEvent:e}}(),Wol.Util.HashParameters=function(){var t=!("onhashchange"in window),n;return t&&(n=function(){var i=!0,f=300,t=null,r=window.location.hash,n=new Wol.Util.RefCountEvent("hashChangeEvent"),u=function(){i&&n.get_HandlersCount()!==0?t||(t=setInterval(e,f)):(clearInterval(t),t=null)},o,e;return n.onHandlersChange.addHandler(u),o=function(t){i&&(i=!1,u()),n.raiseEvent(t)},e=function(){var t=window.location.hash;return r!==t?(r=t,n.raiseEvent(),!0):!1},{onHashChange:n}}()),{attachToHashChangeEvent:function(i){t&&n?n.onHashChange.addHandler(i):jQuery(window).bind("hashchange",i)},detachFromHashChangeEvent:function(i){t&&n?n.onHashChange.removeHandler(i):jQuery(window).unbind("hashchange",i)},getHash:function(n){var t=Wol.Util.Tools.parseUrlParams(window.location.hash);return n!==undefined?t[n.toString()]:t},setHash:function(i,r){var e=window.location.hash,u="",f=typeof i,o;if(i===undefined||f!=="object"&&f!=="string")throw"Wol.Util.HashParameters: setHash() requires an object or a string to set the hash.";else u=f==="string"?i:"#"+Wol.Util.Tools.toUrlParams(i);r===undefined&&(r=!1),e!==u&&(_hashLastValue=u,r?(o=window.location.href.split("#",1)[0],$.browser.msie&&Wol.Util.OnBeforeUnload.suppressNextEvent(),window.location.replace(o+u)):window.location.hash=u,t&&n&&n.onHashChange.raiseEvent())},setHashValue:function(n,t,i){var r=Wol.Util.HashParameters.getHash();if(n===undefined)throw"Wol.Util.HashParameters: setHashValue() parameterName must be defined";r[n]=t,Wol.Util.HashParameters.setHash(r,i)}}}(),Wol.Util.CustomEvent=function(){var n={_oSourceElement:null};return{Handlers:{},Attach:function(n,t){t!=null&&n!=null&&(this.Handlers[n]=t)},Detach:function(n){n!=null&&this.Handlers[n]&&delete this.Handlers[n]},Raise:function(t){n._oSourceElement=typeof t!="undefined"?t:null;for(var i in this.Handlers)this.Handlers[i](n._oSourceElement)}}},Wol.Util.AnchorClick=function(n){"use strict";var i=function(n){var t=n.target;do{if(t.tagName.toUpperCase()==="A")return!0;t=t.parentElement}while(t);return!1},r=function(t,i){var r=n(t),u=r.attr("href");u&&(Wol.ContentInstrumentation.Logging.FireClickEvent(i,r.get(0)),window.location=u)};return{isClickOnAnchorElement:i,clickOnAnchor:r}}(jQuery),Wol.Util.Visibility=function(n,t){"use strict";var i={showEventName:"show-listener",hideEventName:"hide-listener",manipulatorClass:"visibility-manipulator"},r=function(n,i){var r=n.data(i);if(r){if(typeof r!="object")throw"$element data already has item '"+i+"' with an unexpected type";if(r.callbacks&&(typeof r.callbacks!="object"||r.callbacks.length===t))throw"$element data already has item '"+i+".callbacks' with an unexpected type";}return r},u=function(n,t,i){if(!n.length||n.length!==1||n[0].nodeType!==1)throw"$element parameter must contain be a single valid HTML element";if(!i||typeof i!="function")throw"callback parameter must be a valid function";n.addClass(t);var u=r(n,t);u?u.callbacks||(u.callbacks=[]):(n.data(t,{callbacks:[]}),u=n.data(t)),u.callbacks.push(i)},f=function(n,t){u(n,i.hideEventName,t)},e=function(n,t){u(n,i.showEventName,t)},s=function(n,t,r){f(n,t),e(n,r),n.addClass(i.manipulatorClass)},o=function(t,u){var f=t.get(0),e=this,o=t.find("."+u).filter(function(){var t=n(this).parent(),r=t.closest("."+i.manipulatorClass,f).length>0;return!r});o.each(function(){var t=r(n(this),u);t&&t.callbacks&&n.each(t.callbacks,function(){typeof this=="function"&&this.call(e,f)})})},h=function(n){o(n,i.hideEventName)},c=function(n){o(n,i.showEventName)};return{initHideListener:f,initShowListener:e,initVisibilityManipulator:s,notifyHideListeners:h,notifyShowListeners:c}}(jQuery),Wol.Util.Algorithm=function(){"use strict";var i=function(n,t){for(var r=0,i=n.length,u,f;i>0;)u=Math.floor(i/2),f=r+u,t(f)?(r=f+1,i=i-u-1):i=u;return r};return{partitionPoint:i}}(jQuery),Wol.Util.BrowserSpecific=function(){"use strict";var i=document.all&&!document.querySelector,r=function(){return i};return{isIE7orLower:r}}(jQuery),Wol.Util.Math=function(){"use strict";var i=function(n){return n<0?Math.ceil(n):Math.floor(n)};return{truncate:i}}(jQuery),typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),typeof Ms.Wol.Cookies=="undefined"&&(Ms.Wol.Cookies={}),Ms.Wol.Cookies=function(){var n={_bCookiesEnabled:null,_sCookieNs:"Ms.Wol.",_GetCookieEnabledState:function(){return n._bCookiesEnabled===null&&(document.cookie="cookiesEnabled=true;",n._bCookiesEnabled=document.cookie.indexOf("cookiesEnabled=true")>-1?!0:!1),n._bCookiesEnabled},_UniquePageIdAvailable:function(){return typeof PageData!="undefined"&&typeof PageData.TopLevelAssetSystemId!="undefined"?!0:!1},_GetUniquePageId:function(){return typeof PageData!="undefined"&&typeof PageData.TopLevelAssetSystemId!="undefined"?PageData.TopLevelAssetSystemId:null},_BuildCookie:function(t,i){var r=i?"":n._GetUniquePageId()+".";return n._sCookieNs+r+t},_GetCurrentDatePlusDays:function(n){var t=new Date;return t.setDate(t.getDate()+n),t.toUTCString()}};return{SetCookie:function(t,i,r,u){if(u||n._UniquePageIdAvailable()&&n._GetCookieEnabledState()&&t&&i){var f=typeof r=="number"?"; expires="+n._GetCurrentDatePlusDays(r):"",e="; path=/";document.cookie=n._BuildCookie(t,u)+"="+escape(i)+f+e}},SetCookieField:function(t,i,r,u,f){var o,s,e,h,c,l;if((f||n._UniquePageIdAvailable()&&n._GetCookieEnabledState())&&i&&r){if(o=this.GetCookie(t,!0),newCookieVal=i+"="+r,o)for(s=o.split("&"),e=0;e<s.length;e++)if(h=s[e],c=h.split("="),c.length===2){if(l=c[0],l==i)continue;newCookieVal+="&"+h}this.SetCookie(t,newCookieVal,u,f)}},GetCookie:function(t,i){var r,u;if(i||n._UniquePageIdAvailable()&&n._GetCookieEnabledState()&&t){var e=n._BuildCookie(t,i),f=document.cookie.split("; "),o=/^([^=]*)=(.*)/i;for(r=0;r<f.length;r++)if(u=o.exec(f[r]),u&&e===u[1])return unescape(u[2])}return null},DeleteCookie:function(n){this.SetCookie(n,"",-1,!0)},CookiesEnabled:function(){return n._GetCookieEnabledState()},CookieStringNotNullEmpty:function(n){return n?!0:!1}}}(),typeof Bing=="undefined"&&(Bing={}),typeof Wol=="undefined"&&(Wol={}),typeof Wol.ContentInstrumentation=="undefined"&&(Wol.ContentInstrumentation={}),Bing.Logging={bingTags:{},customEvents:{},nonBingScn:"nonBingDS",sanitizeGuidRegex:null,entityType:null,loggingCallback:null,appId:null,pageNamePrefix:null,clientId:null,coreInfo:null,clientInfo:null,deviceInfo:null,anid:null,userAgent:null,loggingHeaders:null,timeZone:null,initLogging:null,eventQueue:[],resWidth:null,resHeight:null,dpi:null,bingResObject:null,resOrnt:null,langOrnt:null,Init:function(n,t,i,r){var u=Bing.Logging,e,f,s,o;u._initRegex(),u.clientId=n,u.coreInfo=t,u.clientInfo=i,u.deviceInfo=r,u._setTimeZone(),document.body.clientWidth!=="undefined"&&(u.resWidth=document.body.clientWidth,u.resHeight=document.body.clientHeight);var h="",c="",l="",v="",a="";i!==null&&typeof i!="undefined"&&(i.Client!==null&&(e=i.Client,e.Ver!=="undefined"&&e.Name!=="undefined"&&(h=e.Name+"/"+e.Ver,u.pageNamePrefix="Page."+e.Name),e.Id!=="undefined"&&(u.appId=e.Id)),i.OS!=="undefined"&&(f=i.OS,f.MajorVer!=="undefined"&&f.MinorVer!=="undefined"&&f.BuildVer!=="undefined"&&f.QfeNum!=="undefined"&&(c=f.MajorVer+"."+f.MinorVer+"."+f.BuildVer+"."+f.QfeNum))),r!==null&&typeof r!="undefined"&&(r.Device!=="undefined"&&r.Device.Architecture!=="undefined"&&(l=r.Device.Architecture),r.Oem!=="undefined"&&(s=r.Oem,s.Name!=="undefined"&&s.Model!=="undefined"&&(a=s.Name+";"+s.Model)),r.Screen!=="undefined"&&(o=r.Screen,o.Dpi!=="undefined"&&o.ResOrnt!=="undefined"&&o.LangOrnt!=="undefined"&&(u.resOrnt=o.ResOrnt,u.langOrnt=o.LangOrnt,u.dpi=o.Dpi))),u.bingResObject={w:u.resWidth,h:u.resHeight,dpi:u.dpi},u.userAgent=h+"("+c+";"+l+";"+v+";"+a+")",u._refreshLoggingHeaders(),u.initLogging=!0,u._flushQueuedEvents()},SetLoggingCallback:function(n){var t=Bing.Logging;typeof n=="function"&&n!==null&&(t.loggingCallback=n)},SetEntityType:function(n){var t=Bing.Logging;name!==null&&name!=="undefined"&&(t.entityType=n)},SetUserId:function(n){var t=Bing.Logging;n!==null&&n!=="undefined"&&(t.anid=n),t._refreshLoggingHeaders()},LogClickEvent:function(n){var t=Bing.Logging,i;t._supportedTileClickEvent(n)?t._logEvent("Event.Click",n):t._supportedClientClickEvent(n)&&(i=t._getBingExtensionDataObject("Click",n),t._logEvent("Event.ClientClick",n,i))},LogCustomEvent:function(n,t){var i=Bing.Logging,r=i.customEvents[n],u,f;r&&(u=r.BingEventName,u&&i._supportedCustomEvent(t)&&(f=i._getBingExtensionDataObject(n,t),i._logEvent(u,t,f)))},LogLayoutEvent:function(n,t){var i=Bing.Logging;i._logEvent("Event.GridImpression",n,t)},_logEvent:function(n,t,i){var r=Bing.Logging,f=r._getBingLoggingTimestamp(),u=r._eventLogFactories[n],e;u&&typeof u=="function"&&(e={loggingFactory:u,eventTime:f,biDataObject:t,extendedDataObjects:i},r.eventQueue.push(e),r._flushQueuedEvents())},_flushQueuedEvents:function(){var n=Bing.Logging,i;if(n.initLogging===!0){for(i=0;i<n.eventQueue.length;i++)try{var t=n.eventQueue[i],f=t.loggingFactory,u=t.eventTime,e=t.biDataObject,o=t.extendedDataObjects,s=f(u,e,o);n._sendLoggingRequest(s,u)}catch(r){r&&r.toString&&typeof console!="undefined"&&typeof console.log!="undefined"&&console.log("Error on Bing.Logging._flushQueuedEvents: "+r.toString())}n.eventQueue=[]}},_eventLogFactories:{"Event.GridImpression":function(n,t,i){var r=Bing.Logging,u=r._getBingDataObject(t),e=r._generateRequestUrlObject(u),s=r._generateDisplayBoundingBoxObject(u),o=r._generateFlightInfoObject(u),h=r._generateDataSourceObject(i),c=r._generateLayoutObject(i),f={pn:u.PageId,resOrnt:r.resOrnt,langOrnt:r.langOrnt,res:r.bingResObject,dspGrd:s,DS:h,L:c},l;return e!==null&&e!=="undefined"&&(f.urlData=e),u.pNum!==null&&u.pNum!=="undefined"&&(f.pNum=u.pNum),o&&(f.fltInfo=o),l={T:"Event.GridImpression",TS:n,IG:u.PageIg,D:f}},"Event.Click":function(n,t){var r=Bing.Logging,i=r._getBingDataObject(t),u=r._generateDisplayBoundingBoxObject(i);return{T:"Event.Click",TS:n,IG:i.PageIg,D:{pn:i.PageId,AppNS:i.AppNS,K:i.K,origIG:i.IG,dspSz:u}}},"Event.ClientClick":function(n,t,i){var u=Bing.Logging,r=u._getBingDataObject(t);return{T:"Event.ClientClick",TS:n,IG:r.PageIg,D:{pn:r.PageId,Src:r.Src,Ext:i,origIG:r.IG}}},"Event.Swipe":function(n,t){var r=Bing.Logging,i=r._getBingDataObject(t),u=r._generateDisplayBoundingBoxObject(i);return{T:"Event.Swipe",TS:n,IG:i.PageIg,D:{pn:i.PageId,dspSz:u,dir:i.Dir,ti:i.Time}}}},_supportedTileClickEvent:function(n){for(var t in n)if(t.toLowerCase()==="entity.id")return!0;return!1},_supportedClientClickEvent:function(n){for(var t in n)if(t.toLowerCase()==="src")return!0;return!1},_supportedCustomEvent:function(n){for(var t in n)if(t.toLowerCase()==="search.sug.type")return n[t].toLowerCase()==="n"?!1:!0;return!0},_getBingDataObject:function(n){var t=Bing.Logging,i={};return n!==null&&n!=="undefined"&&t._translateDictionary(t.bingTags,n,i),i},_getBingExtensionDataObject:function(n,t){var r=Bing.Logging,i=null,u,f;return n&&t!==null&&t!=="undefined"&&(u=r.customEvents[n],u&&u.ExtData&&(f=u.ExtData,f==="*"?i=r._getBingDataObject(t):typeof f=="object"&&(i={},r._translateDictionary(f,t,i)))),i},_translateDictionary:function(n,t,i){var f=Bing.Logging,e,o,r,s,u,h,c;if(n&&typeof n=="object")for(e in n){o=!1,r=n[e];for(s in t)if(e.toLowerCase()===s.toLowerCase()){u=t[s],r==="PageId"?(h=f.pageNamePrefix+"."+u,i[r]=h):r==="PageIg"||r==="IG"||r==="Entity.Id"?(c=f._sanitizeGuid(u),i[r]=c):i[r]=u,o=!0;break}o||(i[r]="")}},_generateFlightInfoObject:function(n){var t=null,u,i,r,f;if(n.FltInfo)for(t=[],u=n.FltInfo.split(","),i=0;i<u.length;i++)r=u[i].split(":"),r.length===2&&(f={fltId:r[0],numLn:r[1]},t.push(f));return t},_generateDataSourceObject:function(n){var i=Bing.Logging,r=[],f;for(f in n){var t=i._getBingDataObject(n[f]),e=t.scn===""||t.scn==="undefined"?i.nonBingScn:t.scn,u={scn:e,AppNS:t.AppNS,K:t.K,origIG:t.IG};t["Entity.Id"]&&(u.Entity={Val:t["Entity.Id"],Type:i.entityType}),r.push(u)}return r},_generateLayoutObject:function(n){var r=Bing.Logging,i=[],u,t,f;for(u in n)t=r._getBingDataObject(n[u]),(t.R||t.S||t.Ornt)&&(f={R:t.R,AppNS:t.AppNS,K:t.K,S:t.S,Ornt:t.Ornt},i.push(f));return i},_generateDisplayBoundingBoxObject:function(n){return{FirstVisibleItem:{K:n.FirstVisibleItemKValue,R:n.FirstVisibleItemRValue,AppNS:n.FirstVisibleItemAppNSValue},LastVisibleItem:{K:n.LastVisibleItemKValue,R:n.LastVisibleItemRValue,AppNS:n.LastVisibleItemAppNSValue}}},_generateRequestUrlObject:function(n){var i=Bing.Logging,t=null;return(n.RequestQueryTerm!==""||n.RequestQueryForm!=="")&&(t={FORM:n.RequestQueryForm,FORMIG:n.RequestQueryFormIg,Query:n.RequestQueryTerm,extraParams:{Sort:n.RequestQuerySort,Filter:n.RequestQueryFilter}}),t},_getBingLoggingTimestamp:function(){return Math.round((new Date).getTime())},_sendLoggingRequest:function(n,t){var i=Bing.Logging,u=i.loggingHeaders,f={STS:t,TZ:i.timeZone,AppID:i.appId,E:[n]},e={headers:u,body:f};try{i.loggingCallback(e)}catch(r){r&&r.toString&&typeof console!="undefined"&&typeof console.log!="undefined"&&console.log("Error on Bing.Logging._sendLoggingRequest: "+r.toString())}},_refreshLoggingHeaders:function(){var n=Bing.Logging,t=[{name:"X-Search-ClientID",value:n.clientId},{name:"X-Inst-ANID",value:n.anid},{name:"User-Agent",value:n.userAgent}],i=[],r;for(r in t)n._isNullOrWhitespace(t[r].value)||i.push(t[r]);n.loggingHeaders=i},_isNullOrWhitespace:function(n){return typeof n=="undefined"||n===null?!0:typeof n=="string"&&n.trim()===""?!0:!1},_setTimeZone:function(){var t=Bing.Logging,i=new Date,n=i.getTimezoneOffset(),r=Math.floor(Math.abs(n/60)),u=Math.abs(n%60),f=n>0?"-":"";t.timeZone=f.toString()+r.toString()+":"+u.toString()+":00"},_initRegex:function(){var n=Bing.Logging;n.sanitizeGuidRegex=new RegExp(/[^a-fA-F0-9]/g)},_sanitizeGuid:function(n){var t=Bing.Logging;if(n!==null)return n.replace(t.sanitizeGuidRegex,"")}},Wol.ContentInstrumentation.Logging={SharedTags:{},Max_UInt32:4294967295,Max_Int64:0x7FFFFFFFFFFFFFFF,Min_Int64:-0x7FFFFFFFFFFFFFFF,Str_NullArg:"Parameter must not be null or empty",clientBiSettingsUri:"ClientBISettings.js",customEventField:"CustomEvent",userInfo:null,clientInfo:null,deviceInfo:null,coreTags:[],coreTagsRegex:null,envDomain:null,env:null,explicitBiInitParam:"&cot=201",explicitClickEventParam:"&cot=206",explicitSamplingInitParam:"&cot=202",httpScheme:"http:",impressionFilter:"*",bingImpressionFilter:"*",initLogging:null,bingLoggingEnabled:!1,isBiSelectorSupported:typeof document.querySelectorAll!="undefined",maxPartitionKey:"0",sampling_None:{"":{InSample:1,IsDefault:!0,FlexField:""}},sampling_Default:null,sessionDomain:".microsoft.com",scriptPath:null,scriptIsReady:!1,tagPrefix:"ms.",tagRegex:null,viewDataIsReady:!1,batchBeacons:[],customEventBeacons:[],clickEvents:[],samplingEvents:[],onInitComplete:null,loggingCallback:null,Annotate:function(n,t,i){var r=Wol.ContentInstrumentation.Logging,u,f;try{if(n==null||n=="")throw Error.argument("dataname",r.Str_NullArg);if(u=r._getDomTarget([i,this]),u==null)throw Error.argument("element","Parameter can only be null if 'this' is a DOM element");f=r._getAnnotationName(n),r._setAttr(u,f,t)}catch(e){r._logError(e)}},AnnotateMetatag:function(n,t){var i=Wol.ContentInstrumentation.Logging,r;try{if(n==null||n=="")throw Error.argument("dataname",i.Str_NullArg);r=i._getAnnotationName(n),i._setAnnotatedMetatag(r,t)}catch(u){i._logError(u)}},AnnotateMany:function(n,t){var i=Wol.ContentInstrumentation.Logging,r;try{if(n==null)throw Error.argument("dictionary",i.Str_NullArg);for(r in n)i.Annotate(r,n[r],t)}catch(u){i._logError(u)}},AnnotateManyMetaTag:function(n){var t=Wol.ContentInstrumentation.Logging,i;try{if(n==null)throw Error.argument("dictionary",t.Str_NullArg);for(i in n)t.AnnotateMetatag(i,n[i])}catch(r){t._logError(r)}},GetSessionID:function(){var t=Wol.ContentInstrumentation.Logging,n="",i;try{i=Wol.Mscom.sessionGuidCookieName,n=t._getCookieValue(i),n=n.indexOf("=")===-1?n:null}catch(r){t._logError("GetSessionID Error:"+r)}return n},GetUserHash:function(){return Wol.Mscom.userHashField},GetMuid:function(){var i=Wol.ContentInstrumentation.Logging,r="",u="",e,f,n,t;try{for(e=Wol.Mscom.visitorCookieName,r=i._getCookieValue(e),f=r.split("&"),n=0;n<f.length;n++)if(t=f[n].split("="),t.length===2&&t[0]==="GUID"){u=unescape(t[1]);break}}catch(o){i._logError("GetMuid Error:"+o)}return u},GuidTo32bit:function(n){var i=Wol.ContentInstrumentation.Logging,t=null;return n&&typeof n=="string"&&n.length===32&&(t=i.HexTo32bit(n)),t},HexTo32bit:function(n){var t=Wol.ContentInstrumentation.Logging;return t.HexToInt(n.substring(0,8))},HexToInt:function(n){var t=isNaN("0x"+n)?null:parseInt(n,16);return t&&isFinite(t)?t:null},SetSessionID:function(n){var t=Wol.ContentInstrumentation.Logging,i=Wol.Mscom,r=i.sessionGuidCookieName,u;i.previousSessionID=t.GetSessionID(),u=r+"="+escape(n)+";domain="+t.sessionDomain+";path=/",document.cookie=u,t.InitSessionID()},SetUserInfo:function(n,t){var i=Wol.ContentInstrumentation.Logging,u=Bing.Logging,r=Wol.Mscom;r.userHashField!==n&&(r.userHashField=typeof n=="string"&&n.length>0&&n.length<=16?n:"",i.InitSampling()),t!==null&&typeof t!="undefined"&&(i.userInfo=t,t.ANID!=="undefined"&&u.SetUserId(t.ANID))},SetEntityType:function(n){var t=Bing.Logging;n!=="undefined"&&t.SetEntityType(n)},LogCustomEventsBatch:function(n,t,i,r){var u=Wol.ContentInstrumentation.Logging,s=Wol.Mscom,y,d,o,c,f,e,g,nt,h,rt,l;if(u.initLogging===!0&&u._checkSampling(r))try{if(n===null||n==="")throw Error.argument("eventName",u.Str_NullArg);if(t===null||typeof t!="object"||t.length===undefined)throw Error.argument("eventBatch","Parameter must not be a non-null array of json objects");var p=1800,w=s.GetBaseSrcString()+s.customEventParam,a="&"+u._getAnnotationName(n)+"=",v="%1E",tt="%1D",b=u._getBiDataMap(null,i,null),k=u._getAnnotatedMetatags();for(y=0;y<k.length;y++)d=k[y],b.Push(d.shortname,d.value);for(o=s.EncodeCustomEventStr(b.GetMscomArray()),c="";t.length>0;)if(f=t.pop(),typeof f=="object"){e={biDataObject:null,element:null},e.element=u._getDomTarget([f.element,f]),e.biDataObject=typeof f.biDataObject=="object"?f.biDataObject:f!==e.element?f:null,g=u._getBiDataMap(null,e.biDataObject,e.element),nt="";for(h in g.Values)rt=h.indexOf(u.tagPrefix)===0?h.substr(u.tagPrefix.length):h,nt+=h+"="+g.Values[h]+tt;l=s.Encode(nt),p<l.length?u.LogCustomBI(n,e.biDataObject,e.element):p>=a.length+o.length+l.length+v.length?o+=v+l:(c=w+a+o,u.batchBeacons.push(c),o=s.Encode(pageMetadataStr)+v+l)}o!==""&&(c=w+a+o,u.batchBeacons.push(c)),u._flushQueuedEvents()}catch(it){u._logError(it)}},LogCustomBI:function(n,t,i,r){var u=Wol.ContentInstrumentation.Logging,f=Wol.Mscom,s,o,c;if(u.initLogging===!0)try{if(s=u._checkSampling(r),s||u.bingLoggingEnabled){if(n==null||n=="")throw Error.argument("eventName",u.Str_NullArg);var l=u._getDomTarget([i,this]),e=u._getBiDataMap(n,t,l),h=u._getAnnotatedMetatags();for(o=0;o<h.length;o++)c=h[o],e.Push(c.shortname,c.value);if(e.Push(u.customEventField,n),s){var a=f.GetBaseSrcString(),v=a+f.customEventParam+f.EncodeCustomEventStr(e.GetMscomArray()),y=f.EnsureBeaconSrcLength(v);u.customEventBeacons.push(y),u._flushQueuedEvents()}u.bingLoggingEnabled&&Bing.Logging.LogCustomEvent(n,e.GetBingArray())}}catch(p){u._logError(p)}},LogImpressions:function(n,t,i,r){var u=Wol.ContentInstrumentation.Logging,k=Bing.Logging,l,a,e,v,y,s,p,w,b,o,f,g;if(u.initLogging===!0)try{var d=u._checkSampling(r),h=d&&u.impressionFilter!=="",c=u.bingLoggingEnabled&&u.bingImpressionFilter!=="";if(h||c){if(l=u._getDomTarget([n,this]),l==null)throw Error.argument("element","Parameter 'element' can only be null if 'this' is a DOM element");if(a=u._getAnnotatedComponents(l),h&&(e=[],v=u._queryFilter(a,u.impressionFilter),v.length>0&&(e=u._map(v,function(){return{biDataObject:t,element:this}})),Object.prototype.toString.call(i)==="[object Array]"&&i.length>0&&(y=u._map(i,function(n){var i=t,r;for(r in n)i[r]=n[r];return{biDataObject:i}}),e=e.length===0?y:e.concat(y)),e.length>0&&u.LogCustomEventsBatch("Impression",e)),c&&(s=u._queryFilter(a,u.bingImpressionFilter),Object.prototype.toString.call(i)==="[object Array]"&&i.length>0||s.length>0)){for(p=u._getBiDataMap(null,t,n),w=u._getAnnotatedMetatags(),f=0;f<w.length;f++)b=w[f],p.Push(b.shortname,b.value);for(o=[],f=0;f<s.length;f++)g=u._getBiDataMap(null,null,s[f]),o[f]=g.GetBingArray();Object.prototype.toString.call(i)==="[object Array]"&&(o=o.length===0?i:o.concat(i)),k.LogLayoutEvent(p.GetBingArray(),o)}}}catch(nt){u._logError(nt)}},SetEnvironment:function(n){var t=Wol.ContentInstrumentation.Logging;n!=""&&(t.envDomain=n)},SetTagConfig:function(n,t,i,r,u){var f=Wol.ContentInstrumentation.Logging;try{f.tagPrefix=n+".",f.impressionFilter=r,f.bingImpressionFilter=u,f.coreTags=f._map(i,function(n){return f.tagPrefix+n}),f._initRegex()}catch(e){f._logError("SetTagConfig Error: "+e)}},SetClientConfig:function(n){var t=Wol.ContentInstrumentation.Logging;(n==null||n=="")&&(n="ClientBISettings.js"),n.indexOf(":")<0&&t.scriptPath!=null&&(n=t.scriptPath+n),t.clientBiSettingsUri=n},SetLoggingCallback:function(n){var t=Wol.ContentInstrumentation.Logging,i=Bing.Logging;typeof n=="function"&&n!==null&&(t.loggingCallback=n,i.SetLoggingCallback(n))},Init:function(n,t,i,r,u){var f=Wol.ContentInstrumentation.Logging,s=Bing.Logging,e,o;if(f.bingLoggingEnabled=t,i!==null&&i!=="undefined"&&(f.coreInfo=i),r!==null&&r!=="undefined"&&(f.clientInfo=r,f._refreshClientInfo()),u!==null&&u!=="undefined"&&(f.deviceInfo=u),typeof n=="undefined"&&(n=!0),f.initLogging!=!1&&(f.initLogging=f._getLogEnabledHHSetting()&&f._getLogEnabledMetatagValue()),f.initLogging){if(f.envDomain==null||f.envDomain=="")throw Error.argument("env","WEDCS Environment has not properly initialized");f.viewDataIsReady=!0,e=!1,o=function(){t!==null&&typeof t!="undefined"&&t&&s.Init(f.GetMuid(),i,r,u),e&&f.scriptIsReady&&typeof Wol.ContentInstrumentation.BiSettings!="undefined"&&(n?f.FirePageViewEvent():f._flushQueuedEvents())},typeof Ms!="undefined"&&typeof Ms.Wol!="undefined"&&typeof Ms.Wol.BIPreloadDatabag!="undefined"&&f.AnnotateManyMetaTag(Ms.Wol.BIPreloadDatabag),f.InitClientSettings(o),f._onDomReady(function(){e=!0,o()})}},InitClientSettings:function(n){var t=Wol.ContentInstrumentation.Logging,r,i,u,f;try{r=new Date,r.setMinutes(0,0,0),i=t.clientBiSettingsUri.indexOf("?")>=0?"&":"?",u=t.clientBiSettingsUri+i+"t="+r.getTime().toString(),f=function(){var i,u,r,f;typeof Wol.ContentInstrumentation.BiSettings!="undefined"&&(i=Wol.ContentInstrumentation.BiSettings,i.get=function(n,t){return typeof i[n]=="undefined"?t:i[n]},t.initLogging=i.get("BILog",t.initLogging),t.impressionFilter=i.get("ImpressionFilter",t.impressionFilter),t.maxPartitionKey=i.get("MaxPartitionKey",t.maxPartitionKey),t.sessionDomain=i.get("SessionDomain",t.sessionDomain),t.httpScheme=i.get("BIScheme",t.httpScheme),t.httpScheme==="auto"&&(t.httpScheme=window.location.protocol),t.env=t.httpScheme+"//"+t.envDomain,t.SharedTags=i.get("SharedTags",t.SharedTags),u=Bing.Logging,t.bingImpressionFilter=i.get("BingImpressionFilter",t.bingImpressionFilter),u.bingTags=i.get("BingTags",u.bingTags),u.customEvents=i.get("BingCustomEvents",u.customEvents),r=Wol.Mscom,r.tagPrefix=t.tagPrefix.toLowerCase(),r.wedcsUriBase=t.env,r.browserDelay=i.get("BrowserDelay",r.browserDelay),r.varClickTracking=i.ClickTracking!=null&&typeof i.ClickTracking!="undefined"?i.ClickTracking:!0,i.FlexInfo||(i.FlexInfo={}),r.InitFlexInfo(i.FlexInfo),f=function(){var u,i,r;for(t.InitSessionID(),t.scriptIsReady=!0,u=[t.onInitComplete,n],i=0;i<u.length;i++)if(r=u[i],typeof r=="function"&&r!==null)try{r()}catch(f){t._logError("SessionInit Completed callback error: "+f)}},t.InitCookieData(f))},t._loadScript(u,f)}catch(e){t._logError("InitClientSettings Error: "+e)}},_loadScript:function(n,t){var r=!1,u=document.getElementsByTagName("head")[0]||document.body,i=document.createElement("script"),e,f;i.src=n,e=function(){var n=i.parentNode;i.onload=null,i.onreadystatechange=null,n&&n.removeChild&&n.removeChild(i)},f=function(){r=!0,t(),e()},i.onload=function(){r||f()},i.onreadystatechange=function(){r||(i.readyState==="loaded"||i.readyState==="complete")&&f()},u.insertBefore(i,u.firstChild)},InitCookieData:function(n){var t=Wol.ContentInstrumentation.Logging,r=Wol.ContentInstrumentation.BiSettings,i=Wol.Mscom,u=t.GetSessionID(),f=t.GetMuid(),e=function(){try{typeof n=="function"&&n!==null&&n()}catch(i){t._logError("InitCookieData Completed callback error: "+i)}},o;u&&u.length>0&&f&&f.length>0?e():(i.InitRoute(r.ControlCode,r.RoutingCode,"I"),o=i.GetBaseSrcString()+t.explicitBiInitParam,i.SendBeacon(o,e))},InitSessionID:function(){var t=Wol.ContentInstrumentation.Logging,r,i;try{r=Wol.Mscom,i=Wol.ContentInstrumentation.BiSettings,r.InitRoute(i.ControlCode,i.RoutingCode,t._getPartitionKey()),t.InitSampling()}catch(u){t._logError("InitSessionID Error: "+u)}},InitSampling:function(){var n=Wol.ContentInstrumentation.Logging,t=Wol.ContentInstrumentation.BiSettings,r=Wol.Mscom,u,e,f,i,o,s,h;if(n.initLogging===!0&&t)try{if(u=!0,e="",t.Sampling){o=0;for(i in t.Sampling)t.Sampling.hasOwnProperty(i)&&(o++,f=t.Sampling[i],u=n._initSamplingRule(i,f)&&u,e+=f.FlexField+";");s=t.SamplingDefault||(o===1?i:""),n.sampling_Default=t.Sampling[s]||n.sampling_None}else t.Sampling=n.sampling_None,n.sampling_Default=n.sampling_None[""];u||(r.samplingInfo=e,h=r.GetBaseSrcString()+n.explicitSamplingInitParam,n.samplingEvents=[h],r.samplingInfo="")}catch(c){n._logError("InitSampling Error: "+c)}},FirePageViewEvent:function(n,t,i,r){var u=Wol.ContentInstrumentation.Logging,f;if(u.initLogging===!0)try{f=function(){if(u.viewDataIsReady===!0&&u.scriptIsReady===!0&&u._checkSampling(i)){n==null?Wol.Mscom.Init():u._logJsonPageViewEvent(n),t||(t=document.body);var f=t.getAttribute("BI.SuppressImpression");(f===null||typeof f=="undefined"||f!==1)&&u.LogImpressions(t,n,r,i),u._flushQueuedEvents()}},f()}catch(e){u._logError("FirePageView Error: "+e)}},FireClickEvent:function(n,t,i,r,u,f){var s=Wol.ContentInstrumentation.Logging,b=Bing.Logging,o=Wol.Mscom,y,a,p,v,w,e,g;if(s.initLogging===!0)try{if(y=s._checkSampling(f),y||s.bingLoggingEnabled){for(a=s._getBiDataMap(null,n,t),p=s._getAnnotatedMetatags(),v=0;v<p.length;v++)w=p[v],a.Push(w.shortname,w.value);if(s.bingLoggingEnabled&&b.LogClickEvent(a.GetBingArray()),y){var k=o.GetBaseSrcString(),d=o.EncodeCustomEventStr(a.GetMscomArray()),l="",c="",h="";if(t&&(e=s._getDomTarget([t,this]),e&&e.tagName)){l=o.GetId(e);switch(e.tagName){case"A":c=e.innerText||"",h=e.href||"";break;case"IMG":c=e.alt||"",h=o.GetImageHREF(e);break;case"AREA":c=e.alt||"",h=e.href||"";break;case"INPUT":type=e.type,(type=="button"||type=="reset"||type=="submit"||type=="image"||type=="text"||type=="search")&&(g=e.value||e.name||e.alt||e.id,c=g||"",h=e.form?e.form.action||window.location.pathname:window.location.pathname)}}l=u||l,c=r||c,h=i||h;var nt="&cn="+o.GetUrlParameter("cn",o.Encode(c))+"&cid="+o.GetUrlParameter("cid",o.Encode(l))+"&ct="+o.GetUrlParameter("ct",o.Encode(h)),tt=k+s.explicitClickEventParam+nt+d,it=o.EnsureBeaconSrcLength(tt);s.clickEvents.push(it),s._flushQueuedEvents(),o.browserDelay>0&&o.Pause(o.browserDelay)}}}catch(rt){s._logError("FireClickEvent Error: "+rt)}},FireClickTrackingEvent:function(n,t){var i=Wol.ContentInstrumentation.Logging;if(i.initLogging===!0&&i._checkSampling(t))try{if(n==null)throw Error.argument("event",i.Str_NullArg);Wol.Mscom.ProcessClick(n)}catch(r){i._logError(r)}},_isInt:function(n){var t=parseInt(n);return isNaN(t)?!1:t==n&&t.toString()==n.toString()},_checkSampling:function(n){var t=Wol.ContentInstrumentation.Logging,r=Wol.ContentInstrumentation.BiSettings,i;return t.initLogging===!0&&t.scriptIsReady===!0?(t._flushQueuedSamplingEvents(),i=n&&(n.InSample===0||n.InSample===1)?n:t.sampling_Default,Wol.Mscom.samplingInfo=i.FlexField||"",i.InSample):!0},_refreshClientInfo:function(){var t=Wol.ContentInstrumentation.Logging,o=Wol.Mscom,i=t.clientInfo,n,e;if(i!==null&&typeof i!="undefined"){var s="",r="",u="",f="";i.OS!=="undefined"&&(n=i.OS,n.MajorVer!=="undefined"&&t._isInt(n.MajorVer)&&n.MinorVer!=="undefined"&&t._isInt(n.MinorVer)&&n.BuildVer!=="undefined"&&t._isInt(n.BuildVer)&&n.QfeNum!=="undefined"&&t._isInt(n.QfeNum)&&(r="o:"+n.MajorVer+"."+n.MinorVer+"."+n.BuildVer+"-"+n.QfeNum),n.AppModel!=="undefined"&&t._isInt(n.AppModel)&&(u="am:"+n.AppModel)),i.Client!==null&&(e=i.Client,e.Ver!=="undefined"&&t._isInt(e.Ver)&&(f="c:"+e.Ver)),r!=""&&u!=""&&f!=""&&(o.clientInfoField=r+";"+f+";"+u)}},_getBiDataMap:function(n,t,r){var f=Wol.ContentInstrumentation.Logging,c=Bing.Logging,o=Wol.Mscom,u={MscomValues:{},BingValues:{},Push:function(t,r){var h,p,y,v;if(r!==null&&typeof r!="undefined"&&(h=r.toString(),h!=="")){var a=!1,e=!1,s=f._getAnnotationName(t,n),l=f._getFieldName(s);for(p in c.bingTags)if(p.toLowerCase()===l.toLowerCase()){for(v in u.BingValues)if(v.toLowerCase()===s.toLowerCase()){e=!0;break}e||(u.BingValues[l]=h,e=!0);break}y=!1;for(i in o.mscomTags)if(o.mscomTags[i].toLowerCase()===l.toLowerCase()){y=!0;break}if(y||!e){for(v in u.MscomValues)if(v.toLowerCase()===s.toLowerCase()){a=!0;break}a||(u.MscomValues[s]=h)}}},PushList:function(n){var t,i;if(n)for(t=0;t<n.length;t++)i=n[t],u.Push(i.name,i.value)},GetBingArray:function(){return u.BingValues},GetMscomArray:function(){var n=[],t,i;for(t in u.MscomValues)i=u.MscomValues[t],typeof i=="string"&&n.push(t,i);return n}},s,h,e,l,a;if(t!=null)for(s in t)u.Push(s,t[s]);if(r!=null){for(h=[],e=r.parentNode;e;e=e.parentNode)h.push(e);l=f._getAnnotatedData(r),a=f._map(h,f._getAnnotatedData),u.PushList(l),u.PushList(a)}return u},_getPartitionKey:function(){var n=Wol.ContentInstrumentation.Logging,r,t,i;if(n.maxPartitionKey&&n.maxPartitionKey!=""){r=n._getRandPartition(n.maxPartitionKey),t=r;try{i=n.GetSessionID(),i!=null&&i.length>=n.maxPartitionKey.length&&(i=i.toLowerCase(),t=i.substring(0,n.maxPartitionKey.length),t=t<=n.maxPartitionKey.toLowerCase()?t:r)}catch(u){n._logError("Error determining partition key: "+u)}return t}return""},_getRandPartition:function(n){try{var t=parseInt(n,16);return Math.floor(Math.random()*(t+1)).toString(16)}catch(i){return Math.floor(Math.random()*16).toString(16)}},_getDomTarget:function(n){for(var r,t,i=0;i<n.length;i++)if(t=n[i],t!==null&&typeof t!="undefined"&&typeof t.nodeType!="undefined"&&t.nodeType==1){r=t;break}return r},_getElementsUnder:function(n,t){var i=Wol.ContentInstrumentation.Logging;return i._filter(i._queryDom(n,t),function(n){for(var i=n.parentNode;i&&i!==t;i=i.parentNode);return i===t})},_getAnnotationName:function(n,t){var i=Wol.ContentInstrumentation.Logging;return t=t==null||typeof t!=" string"?"":t+".",i._isBiAnnotation(n)?n:i.tagPrefix+t+n},_getAnnotatedData:function(n){var t=Wol.ContentInstrumentation.Logging;return t._map(n.attributes,function(i){var r;return t._isBiAnnotation(i.name)&&i.value!=""&&(r={domElement:n,name:i.name,shortname:i.name.substr(t.tagPrefix.length),value:i.value}),r})},_getCookieValue:function(n){for(var u="",f=document.cookie.split("; "),t,r,i=0;i<f.length;i++)if(t=f[i],r=t.indexOf("="),r!==-1&&t.substring(0,r)===n){u=unescape(t.substring(r+1,t.length));break}return u},_getFieldName:function(n){var i=Wol.ContentInstrumentation.Logging.tagPrefix,t=n;return t&&typeof t=="string"&&t.toLowerCase().indexOf(i.toLowerCase())===0?t.slice(i.length):t},_initRegex:function(){var n=Wol.ContentInstrumentation.Logging;n.tagRegex=new RegExp("^"+n.tagPrefix,"i"),n.coreTagsRegex=new RegExp(n._getCoreTagsRegex(),"i")},_isBiAnnotation:function(n){var t=Wol.ContentInstrumentation.Logging.tagRegex;return t!=null?t.test(n):!1},_getComponentSelectors:function(){var n=Wol.ContentInstrumentation.Logging;return n._getHasAttributeSelectors(n.coreTags)},_getCoreTagsRegex:function(){var t=Wol.ContentInstrumentation.Logging,n=t.coreTags;return typeof n=="string"&&(n=[n]),"^("+t._map(n,function(n){return t._escapeAttributeName(n)}).join("|")+")$"},_getHasAttributeSelectors:function(n){var t=Wol.ContentInstrumentation.Logging;return typeof n=="string"&&(n=[n]),t._map(n,function(n){return"["+t._escapeAttributeName(n)+"]"}).join(", ")},_getAnnotatedComponents:function(n){var t=Wol.ContentInstrumentation.Logging,i=t.isBiSelectorSupported?t._getComponentSelectors():"*",r=t.isBiSelectorSupported?null:t.coreTagsRegex;return t._findChildrenByAttributes(n,i,r)},_findBySingleAttribute:function(n,t){var i=Wol.ContentInstrumentation.Logging,r=i.isBiSelectorSupported?i._getHasAttributeSelectors(t):"*",u=i.isBiSelectorSupported?null:new RegExp("^"+i._escapeAttributeName(t)+"$");return i._findChildrenByAttributes(n,r,u)},_findChildrenByAttributes:function(n,t,i){var s=Wol.ContentInstrumentation.Logging,u=s._getElementsUnder(t,n),o,f,r,e;if(i!=null){for(o=[],f=0;f<u.length;f++)if(r=u[f],r.attributes&&r.attributes.length)for(e=0;e<r.attributes.length;e++)if(i.test(r.attributes[e].name)){o.push(r);break}u=o}return u},_escapeAttributeName:function(n){return n.replace(/\./g,"\\.")},_getAttr:function(n,t){var i=n.getAttribute?n.getAttribute(t):n[t];return i===null?undefined:i},_setAttr:function(n,t,i){i?n.setAttribute?n.setAttribute(t,i):n[t]=i:n.removeAttribute?n.removeAttribute(t):n[t]=undefined},_getLogEnabledHHSetting:function(){try{return!(typeof window.external=="object"&&typeof window.external.NoImplicitFeedback=="boolean"&&window.external.NoImplicitFeedback==!0)}catch(n){return!0}},_getLogEnabledMetatagValue:function(){for(var u=Wol.ContentInstrumentation.Logging,i=!0,f=document.getElementsByTagName("head")[0],r=f.getElementsByTagName("meta"),t,n=0;n<r.length;n++)t=r[n],t&&t.name==="BI.Log"&&!new Boolean(u._getAttr(t,"content"))&&(i=!1);return i},_getAnnotatedMetatags:function(){var n=Wol.ContentInstrumentation.Logging,t=document.getElementsByTagName("head")[0],i=n._filter(t.getElementsByTagName("meta"),function(t){return t&&t.name.toLowerCase().indexOf(n.tagPrefix.toLowerCase())===0});return n._map(i,function(t){var r=t,i=n._getAttr(t,"name"),u=n._getAttr(t,"content");return{domElement:r,name:i,shortname:i.substr(n.tagPrefix.length),value:u}})},_getSessionSampleHash:function(){var n=Wol.ContentInstrumentation.Logging,t=n.GetSessionID();return n.GuidTo32bit(t)},_getRandomSampleHash:function(){return Math.random()*Wol.ContentInstrumentation.Logging.Max_UInt32},_initSamplingRule:function(n,t){var r=Wol.ContentInstrumentation.Logging,f=!0,u=1,i,e;return n&&t&&(typeof t.Type=="undefined"&&(t.Type=0),t.Type===1?!t.Rate||t.Rate<0||t.Rate>100?(t.Rate=100,t.inSample=1):(i=null,u=t.Rate/100,typeof t.getUserHash=="function"&&t.getUserHash!==null&&(i=t.getUserHash()),(!i||isNaN(i)||i<0||i>r.Max_UInt32)&&(i=r._getSessionSampleHash()||r._getRandomSampleHash()),t.InSample=i<u*r.Max_UInt32?1:0):t.InSample=1,e=u===1?"":u.toString().substring(2,6),t.FlexField=n+":"+t.Type.toString()+","+e+","+t.InSample.toString(),f=t.InSample),f},_setAnnotatedMetatag:function(n,t){for(var s=Wol.ContentInstrumentation.Logging,f=!1,e=document.getElementsByTagName("head")[0],o=e.getElementsByTagName("meta"),i,u,r=0;r<o.length;r++)i=o[r],i&&i.name&&i.name.toLowerCase()===n.toLowerCase()&&(f=!0,s._setAttr(i,n,t));f||(u=document.createElement("meta"),u.setAttribute("name",n),u.setAttribute("content",t),e.appendChild(u))},_flushQueuedEvents:function(){var t=Wol.ContentInstrumentation.Logging,n;if(t.scriptIsReady===!0){for(n=0;n<t.batchBeacons.length;n++)Wol.Mscom.SendBeacon(t.batchBeacons[n]);for(t.batchBeacons=[],n=0;n<t.customEventBeacons.length;n++)Wol.Mscom.SendBeacon(t.customEventBeacons[n]);for(t.customEventBeacons=[],n=0;n<t.clickEvents.length;n++)Wol.Mscom.SendBeacon(t.clickEvents[n]);t.clickEvents=[]}},_flushQueuedSamplingEvents:function(){var n=Wol.ContentInstrumentation.Logging,t;if(n.scriptIsReady===!0&&n.samplingEvents&&n.samplingEvents.length>0){for(t=0;t<n.samplingEvents.length;t++)Wol.Mscom.SendBeacon(n.samplingEvents[t]);n.samplingEvents=[]}},_initCurrentScriptPath:function(){var n=Wol.ContentInstrumentation.Logging;if(n.scriptPath==null){try{var r=document.getElementsByTagName("script"),i=r[r.length-1].src,t=i.lastIndexOf("/");t=t<0?i.lastIndexOf("\\"):t,t=t<0?0:t,n.scriptPath=i.substring(0,t)+"/"}catch(u){n.scriptPath="/",n._logError(u)}n.clientBiSettingsUri=n.scriptPath+n.clientBiSettingsUri}},_filter:function(n,t){for(var r=[],u,i=0;i<n.length;i++)u=n[i],t(u)&&r.push(u);return r},_intersect:function(n,t){var e=Wol.ContentInstrumentation.Logging,o=[],u={},i=n,f=t,r;for(n.length>t.length&&(i=t,f=n),r=0;r<i.length;r++)u[i[r]]=1;return e._filter(f,function(n){return n in u})},_map:function(n,t){var f=[],r,i,u;if(n)for(r=0;r<n.length;r++)if(i=t(n[r]),i!==undefined&&i!==null)for(i=i.length===undefined||typeof i!="object"?[i]:i,u=0;u<i.length;u++)f.push(i[u]);return f},_onDomReady:function(n){typeof jQuery!="undefined"?jQuery(document).ready(n):document.addEventListener("DOMContentLoaded",n)},_queryDom:function(n,t){var r=Wol.ContentInstrumentation.Logging,i=[];return n&&(t=t||document,typeof jQuery!="undefined"?i=jQuery(n,t):t.querySelectorAll?i=t.querySelectorAll(n):r._logError("_queryDom Error: Unable to evaluate CSS selector - browser does not support querySelector APIs")),i},_queryFilter:function(n,t){var r=Wol.ContentInstrumentation.Logging,i=[];return t&&(i=t==="*"?n:r._intersect(n,r._queryDom(t))),i},_logJsonPageViewEvent:function(n){var i=Wol.ContentInstrumentation.Logging,t,r,e,s,h;if(i.initLogging==!0){t=Wol.Mscom,t.HandleSession(),t.setEvents();var o=t.GetBaseSrcString(),u=i._getBiDataMap(null,n,null),f=i._getAnnotatedMetatags();for(r=0;r<f.length;r++)e=f[r],u.Push(e.shortname,e.value);s=t.EncodeCustomEventStr(u.GetMscomArray()),h=t.EnsureBeaconSrcLength(o+s),t.SendBeacon(h)}},_logError:function(n){if(n!=null&&typeof console!="undefined"&&typeof console.log!="undefined"){var t=n.toString();console.log(t)}}},Wol.ContentInstrumentation.Logging._initCurrentScriptPath(),Wol.Mscom={fl:0,sessionId:"",sessionDuration:18e5,sessionCookieName:"MC0",sessionGuidCookieName:"MS0",visitorCookieName:"MC1",cookieDisabled:0,pvInfo:[],metaTags:"",customTags:"",clickInfo:"",flexInfo:"",qs:"",currTimeTicks:0,currTimeAsString:"",imgArray:[],imgArrayIndex:0,imgArrayMax:25,customInfo:"",tz:420,slC:"",flC:"",cntC:"",bsC:"",clickedElements:["A","IMG","AREA","INPUT"],pKey:"",routeCode:"",ctrlCode:"",routeParams:"",customEventParam:"&cot=5",tagPrefix:"ms.",clickPrefix:"Click.",debugOn:!1,previousSessionID:"",samplingInfo:"",userHashField:"",clientInfoField:"",disableDefaultLoggingAttribute:"data-disabledefaultlogging",queryParamLength:{ti:[1e3,1e3],sr:[20,0],bs:[20,0],cn:[500,500],cid:[100,100],ct:[500,500]},optInfoHandler:null,wedcsUriBase:"http://__REPLACE_FQDN__",varClickTracking:0,browserDelay:0,CustomEvent:function(){var n=Wol.Mscom;try{n.HandleSession(),n.customInfo+=n.EncodeCustomEventStr(arguments),n.customInfo!=""&&n.Beacon()}catch(t){n.debug("CustomEvent:"+t)}},EncodeCustomEventStr:function(n){for(var i=Wol.Mscom,r="",f=n.length,u,t=0;t<f;t=t+2)u=n[t].toString().toLowerCase(),u.indexOf(i.tagPrefix)==0&&(r+="&"+i.Encode(u)+"="+(n[t+1]==undefined?"":i.Encode(n[t+1].toString())));return r},SetPVInfoCore:function(){var n=Wol.Mscom,t;n.SetTime(),n.pvInfo.push("tz="+n.tz/-60),window.varSegmentation!=undefined&&varSegmentation==1&&n.pvInfo.push("&cs=1"),n.cookieDisabled==1&&n.pvInfo.push("&cd=1"),n.pvInfo.push("&ti="+n.GetUrlParameter("ti",n.Encode(document.title))),t=n.Encode(document.referrer),t!=null&&t!=""&&n.pvInfo.push("&r="+t),n.pvInfo.push("&ts="+n.currTimeAsString),typeof screen=="object"&&n.pvInfo.push("&sr="+n.GetUrlParameter("sr",screen.width+"x"+screen.height)),n.GetBrowserSize(),n.samplingInfo!=""&&n.pvInfo.push("&ff3="+n.samplingInfo),n.userHashField!=""&&n.pvInfo.push("&ff4="+n.userHashField),n.previousSessionID!=""&&(n.pvInfo.push("&ff5="+n.previousSessionID),n.previousSessionID=""),n.clientInfoField!=""&&n.pvInfo.push("&ff6="+n.clientInfoField),n.flexInfo!=""&&n.pvInfo.push(n.flexInfo)},SetPVInfo:function(){var n=Wol.Mscom;n.SetPVInfoCore(),n.optInfoHandler!==null&&typeof n.optInfoHandler=="object"&&n.optInfoHandler()},GetBrowserSize:function(){var n=Wol.Mscom;if(n.bsC!=""){n.pvInfo.push(n.bsC);return}document.body.clientWidth!=undefined?n.bsC=document.body.clientWidth+"x"+document.body.clientHeight:document.documentElement&&document.documentElement.clientWidth!=undefined?n.bsC=document.documentElement.clientWidth+"x"+document.documentElement.clientHeight:window.innerWidth!=undefined&&(n.bsC=window.innerWidth+"x"+window.innerHeight),n.bsC!=""&&(n.bsC="&bs="+n.GetUrlParameter("bs",n.bsC),n.pvInfo.push(n.bsC))},HandleSession:function(){var n=Wol.Mscom,i,t,r,u;if(n.SetTime(),i="",t=document.cookie.indexOf(n.sessionCookieName+"="),t==-1){if(n.sessionId=n.currTimeAsString,n.cookieDisabled==1)return;i=n.sessionCookieName+"="+n.sessionId}else r=t+n.sessionCookieName.length+1,u=document.cookie.length,i=n.sessionCookieName+"="+document.cookie.substring(r,u);document.cookie=i,t=document.cookie.indexOf(n.sessionCookieName+"="),t==-1&&(n.cookieDisabled=1)},SetTime:function(){var n=Wol.Mscom,t=new Date;n.tz=t.getTimezoneOffset(),n.currTimeTicks=Math.max(n.currTimeTicks+1,t.getTime()),n.currTimeAsString=n.currTimeTicks.toString()},debug:function(n){Wol.Mscom.debugOn===!0&&Wol.ContentInstrumentation.Logging(n)},Pause:function(n){for(var t=new Date,i=t.getTime()+n;t.getTime()<i;)t=new Date},GetUrlParameter:function(n,t){var i=Wol.Mscom;return n in i.queryParamLength&&t.length>i.queryParamLength[n][0]&&(t=t.substring(0,i.queryParamLength[n][1])),t},ProcessClick:function(n){var t=Wol.Mscom,c=Wol.ContentInstrumentation.Logging,f,i,o,r,s,l,e,h,u,a,v;try{if(t.HandleSession(),f=n||window.event,f)for(i=f.srcElement||f.target;i.tagName&&t.IsInList(i.tagName)==!1;)i=i.parentElement||i.parentNode;if(i&&i.tagName&&c._getAttr(i,t.disableDefaultLoggingAttribute)===undefined){switch(i.tagName){case"A":o=document.all?i.innerText||"":i.text||"",t.clickInfo="&cot=1&cn="+t.GetUrlParameter("cn",t.Encode(o))+"&cid="+t.GetId(i)+"&ct="+t.GetUrlParameter("ct",i.href?t.Encode(i.href):"");break;case"IMG":t.clickInfo="&cot=2&cn="+t.GetUrlParameter("cn",i.alt?t.Encode(i.alt):"")+"&cid="+t.GetId(i)+"&ct="+t.GetUrlParameter("ct",t.GetImageHREF(i));break;case"AREA":t.clickInfo="&cot=3&cn="+t.GetUrlParameter("cn",i.alt?t.Encode(i.alt):"")+"&cid="+t.GetId(i)+"&ct="+t.GetUrlParameter("ct",i.href?t.Encode(i.href):"");break;case"INPUT":if(r=i.type||"",s="",r&&(r=="button"||r=="reset"||r=="submit"||r=="image"||r=="text"||r=="search")&&(f.which||f.keyCode)==13){if(l=i.value||i.name||i.alt||i.id,t.clickInfo="&cot=4&cn="+t.GetUrlParameter("cn",l?t.Encode(l):"")+"&cid="+t.GetId(i)+"&ct=",i.form)for(t.clickInfo+=t.GetUrlParameter("ct",t.Encode(i.form.action)||t.Encode(window.location.pathname)),e=i.form.elements,h=1,u=0;u<e.length;u++)a=e[u].type,a=="text"&&(s+="&t"+h+"="+t.Encode(e[u].name||e[u].id)+"&v"+h+"="+t.Encode(e[u].value),h++);else t.clickInfo+=t.GetUrlParameter("ct",t.Encode(window.location.pathname));s!=""&&(t.clickInfo+=s)}break;default:t.clickInfo=""}t.clickInfo!=""&&(v=c._getBiDataMap(null,null,i),t.customTags=t.EncodeCustomEventStr(v.GetMscomArray()),t.Beacon(),t.browserDelay>0&&t.Pause(t.browserDelay))}}catch(y){t.debug("ProcessClick:"+y)}},Beacon:function(){var n=Wol.Mscom,i,t;try{i=n.GetFullSrcParts(),t=i.join(""),t=n.EnsureBeaconSrcLength(t),n.SendBeacon(t)}catch(r){n.debug("Beacon:"+r)}},EnsureBeaconSrcLength:function(n){return n.length>2048&&(n=n.substring(0,2042),n.lastIndexOf("&")>=0&&(n=n.substring(0,n.lastIndexOf("&"))),n=n+"&tr=1"),n},SendBeacon:function(n,t){var i=Wol.Mscom,r;try{document.images?(r=document.createElement("IMG"),t&&(r.onload=t,r.onerror=t),i.imgArray[i.imgArrayIndex]=r,i.imgArray[i.imgArrayIndex].src=n,i.imgArrayIndex++,i.imgArrayIndex>i.imgArrayMax&&(i.imgArray=i.imgArray.splice(0,i.imgArrayIndex-i.imgArrayMax))):(document.write('<IMG ALT="" BORDER="0" NAME="bImg" WIDTH="1" HEIGHT="1" SRC="'+n+'"/>'),t&&setTimeout(t,250))}catch(u){i.debug("SendBeacon:"+u)}finally{i.clickInfo="",i.customInfo="",i.customTags=""}},GetBaseSrcParts:function(){var n=Wol.Mscom,t;try{return t=[],t.push(n.wedcsUriBase+"/trans_pixel.aspx?"),n.routeParams!=""&&t.push(n.routeParams),n.pvInfo.length=0,n.SetPVInfo(),t.push(n.pvInfo.join("")),t}catch(i){n.debug("GetBaseSrcParts:"+i)}},GetFullSrcParts:function(){var n=Wol.Mscom,t;try{return t=n.GetBaseSrcParts(),n.clickInfo!=""&&t.push(n.clickInfo),n.InitMeta(),n.metaTags!=""&&t.push(n.metaTags),n.customTags!=""&&t.push(n.customTags),n.customInfo!=""&&(t.push(n.customEventParam),t.push(n.customInfo)),t}catch(i){n.debug("GetFullSrcParts:"+i)}},GetBaseSrcString:function(){var n=Wol.Mscom;return n.GetBaseSrcParts().join("")},GetId:function(n){var t=Wol.Mscom;return n?n.id==undefined?"":t.GetUrlParameter("cid",t.Encode(n.id)):""},GetImageHREF:function(n){var i=Wol.Mscom,t=n;if(n){if(n=n.parentElement||n.parentNode,n&&n.tagName=="A")return n.href?i.Encode(n.href):"";if(t&&t.src)return i.Encode(t.src)}return""},ReadAllTags:function(n){for(var i=Wol.Mscom,t=[];n&&n!="undefined";)t.push(i.ReadElementTags(n)),n=n.parentElement||n.parentNode;return t.join("")},ReadClickTags:function(n){var t=Wol.Mscom,r=[],i,u;return r.push(t.ReadElementTags(n,t.clickPrefix)),i=n.parentElement||n.parentNode,typeof i!="undefined"&&i!==null&&(u=t.ReadAllTags(i)),r.join("")+u},ReadElementTags:function(n,t){var i=Wol.Mscom,e="",u,r,f;if(n)for(u in n.attributes)u!=undefined&&n.attributes[u]!=null&&n.attributes[u]!=undefined&&(r=n.attributes[u].name,r!=null&&r!=undefined&&(f=r.toLowerCase(),f.indexOf(i.tagPrefix)==0?(t!=null&&(r=i.tagPrefix+t+r.substring(i.tagPrefix.length)),e+="&"+i.Encode(r)+"="+i.Encode(n.attributes[u].value)):(f.indexOf("s.")==0||f.indexOf("wt.")==0||f.indexOf("dcs.")==0||f.indexOf("dcsext.")==0)&&(e+="&"+i.Encode(r)+"="+i.Encode(n.attributes[u].value))));return e},IsInList:function(n){var t=Wol.Mscom,i;for(i in t.clickedElements)if(t.clickedElements[i]==n.toUpperCase())return!0;return!1},setEvents:function(){var n=Wol.Mscom,t,i;n.varClickTracking!=undefined&&n.varClickTracking==1&&(document.body.addEventListener?document.body.addEventListener("click",n.ProcessClick):typeof jQuery!="undefined"?jQuery(document.body).click(n.ProcessClick):document.body.attachEvent?document.body.attachEvent("onclick",n.ProcessClick):(t=document.body.onclick,i=t?function(i){n.ProcessClick(i),t(i)}:n.ProcessClick,document.body.onclick=i))},InitMeta:function(){var n=Wol.Mscom;n.metaTags=n.GetMetaTagsStr()},GetMetaTagsStr:function(){var r=Wol.Mscom,n,f,u,i,t;if(document.all?n=document.all.tags("meta"):document.documentElement&&(n=document.getElementsByTagName("meta")),f="",typeof n!="undefined")for(u=0;u<n.length;u++)i=n.item(u),i.name&&(t=i.name.toLowerCase(),(t.indexOf(r.tagPrefix)==0||t.indexOf("s.")==0||t.indexOf("wt.")==0||t.indexOf("dcs.")==0||t.indexOf("dcsext.")==0)&&(f+="&"+r.Encode(i.name)+"="+r.Encode(i.content)));return f},Init:function(){var n=Wol.Mscom;try{n.HandleSession(),n.setEvents(),n.Beacon()}catch(t){n.debug("Mscom - Init:"+t)}},InitRoute:function(n,t,i){var r=Wol.Mscom;r.ctrlCode=n,r.routeCode=t,r.pKey=i,r.pKey&&r.pKey!==""&&r.routeCode&&r.routeCode!==""&&r.ctrlCode&&r.ctrlCode!==""&&(r.routeParams="pKey="+r.pKey+"&route="+r.routeCode+"&ctrl="+r.ctrlCode+"&")},InitFlexInfo:function(n){var t=Wol.Mscom,i;if(t.flexInfo="",n!==null&&typeof n=="object")for(i in n)t.flexInfo+="&"+t.Encode(i)+"="+t.Encode(n[i])},Encode:function(n){return typeof encodeURIComponent=="function"?encodeURIComponent(n):escape(n)}},typeof Wol=="undefined"&&(Wol={}),typeof Wol.ContentInstrumentation=="undefined"&&(Wol.ContentInstrumentation={}),typeof Wol.ContentInstrumentation.Logging=="undefined"&&(Wol.ContentInstrumentation.Logging={}),Wol.ContentInstrumentation.Logging.Rio={InitRIO:function(n,t,i,r,u,f){var e=Wol.ContentInstrumentation.Logging,p,c,w;if(typeof e!="undefined"&&(e.rioEnv=null,e.initLogging))try{var l=e._getAnnotationName(i),a="meta[name='"+l+"']",h=jQuery(a).attr("content"),v=e._getAnnotationName(r),y="meta[name='"+v+"']",o=e._getAnnotationName(u),s=jQuery(y).attr("content");s||(p=e._findBySingleAttribute(document.body,o),s=jQuery(p).first().attr(o)),h&&s&&(e.rioEnv=window.location.protocol+"//"+n+"/RioTracking2.js",jQuery.getScript(e.rioEnv,function(){typeof RioTracking!="undefined"?(RioTracking.guestCellCode=h,RioTracking.uniqueActionTagCode=s):e._logError(new Error("RIO tracking client script was downloaded, but not evaluated successfully - RioTracking namespace is not defined."))}),c=e._getAnnotationName(f),w=e._findBySingleAttribute(document.body,c),jQuery(w).click(function(){try{var t=jQuery(this),i=t.attr(c),n=t.attr(o);n||(n=t.parents().filter(function(){return typeof jQuery(this).attr(o)!="undefined"}).first().attr(o)),n||(n=s),RioTracking.clickNoWait(i,n)}catch(r){e._logError(r)}}))}catch(b){e._logError(b)}}},typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),typeof Ms.Wol.BIPreloadDatabag=="undefined"&&(Ms.Wol.BIPreloadDatabag={}),typeof Wol=="undefined"&&(Wol={}),typeof Wol.SiteInstrumentation=="undefined"&&(Wol.SiteInstrumentation={}),Wol.SiteInstrumentation.Logging={queryStringParameters:{semid:"MS.PaidSearch",ocid:"MS.CampaignRef"},InitCustomInstrumentation:function(){var t=Wol.SiteInstrumentation.Logging,i=t.queryStringParameters,n=window.location.search.replace(/\+/g," "),r,u;try{n=decodeURIComponent(n.substr(1))}catch(f){n=""}for(r in i)try{u=t.ParseQueryString(n,r),u!=""&&(Ms.Wol.BIPreloadDatabag[i[r]]=u)}catch(f){}},ParseQueryString:function(n,t){for(var r=n.split("&"),u,i=0;i<r.length;i++)if(u=r[i].split("="),jQuery.trim(u[0].toLowerCase())==t)return jQuery.trim(u[1]);return""}},Wol.SiteInstrumentation.Logging.InitCustomInstrumentation(),function(){var i=function(){if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)){var n=document.querySelector('meta[name="viewport"]');n&&(n.content="width=device-width, minimum-scale=1.0, maximum-scale=1.0",document.body.addEventListener("gesturestart",function(){n.content="width=device-width, minimum-scale=0.25, maximum-scale=1.6"},!1))}};i()}(jQuery),typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),typeof Ms.Wol.Dogfood=="undefined"&&(Ms.Wol.Dogfood={}),Ms.Wol.GetQueryParameters=function(){for(var r={},u=location.search.substring(1),t=u.split("&"),i,f,e,n=0;n<t.length;n++)(i=t[n].indexOf("="),i!=-1)&&(f=t[n].substring(0,i),e=t[n].substring(i+1),r[decodeURIComponent(f)]=decodeURIComponent(e));return r},Ms.Wol.Dogfood.GetIsDogfoodUserPage=function(){var n=document.getElementsByName("MS.IsDFUser");return n==null?null:n.length!=1?null:n[0].content==="true"},Ms.Wol.Dogfood.TryDogfoodRedirect=function(n){var i,t,r,u,f;if(typeof n=="boolean"&&(i=Ms.Wol.Dogfood.GetIsDogfoodUserPage(),!!i!=n)){if(t=null,location.search=="")t="?woldogcb=0";else try{if(r=Ms.Wol.GetQueryParameters(),u=r.woldogcb||"",u=="0")return;t=location.search+"&woldogcb=0"}catch(e){t=null}t!=null&&(f=location.protocol+"//"+location.hostname+location.port+location.pathname+t+location.hash,location.replace(f))}};var link_expandAllText=link_expandAllText?link_expandAllText:"",link_collapseAllText=link_collapseAllText?link_collapseAllText:"";(function(n){function l(t){var c=t.target?t.target:t.srcElement,i=n(c),r="",e=!0,l=!1,s,h,u,f;for(s in o)e?(e=!1,r+="."+s):r+=",."+s;if(i=i.closest(r),i.attr("class"))for(h=i.attr("class").split(/\s+/),u=0;u<h.length;u++)if(f=h[u],o[f]&&(o[f](i.get(0),f,!0),!b(t)))return!1}function d(){var t=jQuery("a.link_expandAll"),i,o,s;jQuery.each(t,function(){e(this)===r.expand&&f(this,"link_expandAll",!1)}),i=jQuery("a.link_collapseAll"),jQuery.each(i,function(){e(this)===r.collapse&&f(this,"link_collapseAll",!1)}),o=jQuery("a.link_expand"),jQuery.each(o,function(){var t=n(this).closest(".faqEntry, .procedure, .section");t.length!==0&&Wol.Util.Visibility.initVisibilityManipulator(t,v.bind(t),a.bind(t)),e(this)===r.expand&&u(this,"link_expand",!1)}),s=jQuery("a.link_collapse"),jQuery.each(s,function(){var t=n(this).closest(".faqEntry, .procedure, .section");t.length!==0&&Wol.Util.Visibility.initVisibilityManipulator(t,v.bind(t),a.bind(t)),e(this)===r.collapse&&u(this,"link_collapse",!1)})}function g(n,t){if(!n||!t)return-1;if(n===t)return 0;for(var r=1,i=n.parentNode;i&&i!==document;){if(i===t)return r;r++,i=i.parentNode}return-1}function y(n,t,i){var r=g(n,t);return r<0||r>i?!1:!0}function u(t,r,u){if(t){var e=jQuery(t).closest(".link_container").parent().closest("div")[0],f=e.childNodes[1],s=e.parentNode,l=jQuery(t).closest(".link_container"),o=l.find(".link_image_container");e&&f&&(r==="link_collapse"?(i(t,"link_expand"),i(f,"expand"),o.removeClass("link_image_collapse").addClass("link_image_expand"),Wol.Util.Visibility.notifyShowListeners(n(f)),u&&c(t)):r==="link_expand"&&(i(t,"link_collapse"),i(f,"collapse"),o.removeClass("link_image_expand").addClass("link_image_collapse"),Wol.Util.Visibility.notifyHideListeners(n(f)),u&&h(t)),nt(s))}}function p(n,t,i){if(n){var f=jQuery(n).closest(".link_container"),r=f.find("a")[1],e=r.attributes["class"].value;u(r,e,i)}}function f(t,r,u){var y,e,l,b,p,s,k,o,a,d,v,g,f;if(t){for(y=t.parentNode.childNodes,r==="link_expandAll"&&(i(t,"link_collapseAll"),w(t,link_collapseAllText),u&&h(t)),r==="link_collapseAll"&&(i(t,"link_expandAll"),w(t,link_expandAllText),u&&c(t)),e=[],f=0;f<y.length;f++)if((l=jQuery(y[f]).attr("class"),l)&&(l.indexOf("faqEntry")!==-1||l.indexOf("procedure")!==-1||l.indexOf("section")!==-1))for(b=y[f].childNodes,p=0;p<b.length;p++)(s=b[p],k=s.attributes["class"],k)&&(o=k.value,(o==="question"||o==="title_procedure ecTitle"||o==="title_section ecTitle")&&(a=jQuery(s).find(".link_container").children(),a&&a.length===2&&(d=jQuery(a[0]),v=jQuery(a[1]).find("a")[0],r==="link_expandAll"?(d.removeClass("link_image_collapse").addClass("link_image_expand"),i(v,"link_expand"),u&&c(v)):r==="link_collapseAll"&&(d.removeClass("link_image_expand").addClass("link_image_collapse"),i(v,"link_collapse"),u&&h(v)))),(o==="collapse"||o==="expand")&&(g=s,r==="link_expandAll"?i(g,"expand"):r==="link_collapseAll"&&i(g,"collapse")),r==="link_collapseAll"?e.push(n(s)):r==="link_expandAll"&&o==="collapse"&&e.push(n(s)));if(r==="link_expandAll")for(f=0;f<e.length;f++)Wol.Util.Visibility.notifyShowListeners(e[f]);else if(r==="link_collapseAll")for(f=0;f<e.length;f++)Wol.Util.Visibility.notifyHideListeners(e[f])}}function i(n,t){n&&t&&(n.attributes["class"].value=t)}function w(n,t){n&&t&&(n.innerHTML=t)}function e(n){var t=n.getAttribute(s);return t?Ms.Wol.Cookies.GetCookie(t):null}function h(n){if(n){var t=jQuery(n).attr(s);t&&Ms.Wol.Cookies.SetCookie(t,r.expand)}}function c(n){if(n){var t=jQuery(n).attr(s);t&&Ms.Wol.Cookies.SetCookie(t,r.collapse)}}function b(n){return n.preventDefault?(n.preventDefault(),!0):!1}function k(){jQuery("span.button>a").keypress(function(n){var t,i;n.which===32&&(t=Boolean(jQuery(this).attr("href")),this.onClick&&(this.onClick()||(t=!1)),t&&(this.click?this.click():(i=document.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.dispatchEvent(i),window.location.href=jQuery(this).attr("href")),b(n)))})}function nt(n){if(n){var r=jQuery(n).children(".link_expandAll"),u=jQuery(n).children(".link_collapseAll"),t=jQuery(n).find("a.link_expand"),i=jQuery(n).find("a.link_collapse");t=t.filter(function(){return y(jQuery(this)[0],n,7)}),i=i.filter(function(){return y(jQuery(this)[0],n,7)}),jQuery(i).length>0?(jQuery(u).attr("class","link_expandAll"),jQuery(u).html(link_expandAllText)):jQuery(t).length>0&&(jQuery(r).attr("class","link_collapseAll"),jQuery(r).html(link_collapseAllText))}}var o={link_expand:u,link_collapse:u,link_expandAll:f,link_collapseAll:f,link_image_expand:p,link_image_collapse:p},s="data-id",r={expand:"e",collapse:"c"},a,v;(function(){document.attachEvent?document.attachEvent("onclick",l):document.addEventListener&&document.addEventListener("click",l,!1),jQuery(document).ready(d)})(),a=function(){var n=this.find(".expand").first();n.length>0&&Wol.Util.Visibility.notifyShowListeners(n)},v=function(){var n=this.find(".expand").first();n.length>0&&Wol.Util.Visibility.notifyHideListeners(n)},typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"?Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(k):jQuery(document).ready(k)})(jQuery),function(n){"use strict";n(function(){var r=n("<div><\/div>").css({"background-color":"#009cc7",width:"0",height:"0"}),u,t,f,e;if(r.appendTo(document.body),u=i(r.css("background-color")),u==="#000000")n("body").addClass("hcDark"),t="data-HCDkAltSrc";else if(u==="#ffffff")n("body").addClass("hcLight"),t="data-HCLtAltSrc";else return;f="img["+t+"]",e=n(f),e.each(function(){this.src=this.getAttribute(t)})});var i=function(n){var t=function(n){return("0"+parseInt(n).toString(16)).slice(-2)};return n.search("rgb")===-1?n:(n=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/),"#"+t(n[1])+t(n[2])+t(n[3]))}}(jQuery),function(n,t){"use strict";var r="queryObj";t(function(){var n=t("div.SearchQuery").map(function(){return new Wol.SearchBox(this)}).get();Wol.Search&&Wol.Search.SearchBoxCoordinator&&Wol.Search.SearchBoxCoordinator.initialize(n)});var u={query:"q",allowed:["q","prd","s","osd"]},f=function(n){var i=t(n),u,f;if(!i.hasClass("SearchQuery"))throw"Wol.SearchBox: Unable to instantiate due to invalid root element";this.$rootElement=i.first(),this.$inputElement=this.$rootElement.find("input").first(),this.$buttonElement=this.$rootElement.find("button").first(),this.searchPageUrl=this.$rootElement.data("action"),this.isRtl=this.$inputElement.css("direction")==="rtl",this.initialSetSearchTerm=!!this.$rootElement.data("load-search-term"),u=e.bind(this),f=o.bind(this),this.$inputElement.focus(u),this.$inputElement.blur(f),this.$buttonElement.focus(u),this.$buttonElement.blur(f),this.$inputElement.keypress(s.bind(this));this.$inputElement.on("input",h.bind(this));this.$buttonElement.click(c.bind(this)),this.resizeTextBox(),t(window).resize(l.bind(this)),this.$rootElement.data(r,this)},e=function(){this.$rootElement.addClass("SearchQueryHasFocus"),this.$rootElement.removeClass("SearchQueryHasNoFocus"),this.$buttonElement.addClass("accentBackgroundHover")},o=function(){this.$rootElement.removeClass("SearchQueryHasFocus"),this.$rootElement.addClass("SearchQueryHasNoFocus")},s=function(n){n.which===13&&(this.performSearch(n),n.preventDefault())},h=function(n){this.dispatchEvent("changed",n)},c=function(n){this.performSearch(n)},l=function(){this.resizeTextBox()},a=function(n){var e=this.$inputElement.val(),o,t,i,r,f;if(e){for(Wol.Header.setCompactNavCookieState(!1),o=Wol.Util.HashParameters.getHash(),t={},i=0;i<u.allowed.length;i++)r=u.allowed[i],o[r]&&(t[r]=o[r]);return t[u.query]=e,f=this.searchPageUrl+"#"+Wol.Util.Tools.toUrlParams(t),Wol.ContentInstrumentation.Logging.FireClickEvent(null,n.currentTarget,f,n.currentTarget.title),location.href!==f?location.href=f:Wol.Search&&Wol.Search.refreshResults(),!0}return this.$inputElement.focus(),!1},v=function(n){this.$inputElement.attr("value",n)},y=function(n){var i=this.$inputElement,r=n.$inputElement;this.setSearchTerm(r.val()),n.$rootElement.hasClass("SearchQueryHasFocus")&&(i.focus(),t.each(["selectionStart","selectionEnd","selectionDirection"],function(n,t){i.prop(t,r.prop(t))}))},p=function(){this.setSearchTerm("")},w=function(){var n=this.$buttonElement.parent(),t=n.outerWidth(!0),i=this.$inputElement.parent(),r=this.isRtl?"left":"right";i.css(r,t+6)},b=function(n){var i=t(n);return i.data(r)||i.find("div.SearchQuery").data(r)};n.Namespace.define("Wol",{SearchBox:n.Class.define(f,{performSearch:a,setSearchTerm:v,copyState:y,clear:p,resizeTextBox:w},{getInstance:b})}),n.Class.mix(Wol.SearchBox,n.Utilities.createEventProperties("changed")),n.Class.mix(Wol.SearchBox,n.Utilities.eventMixin)}(WinJS,jQuery),typeof Wol=="undefined"&&(Wol={}),Wol.SocialFeedback=function(n){"use strict";function u(){var n=Math.floor(Math.random()*65536).toString(16),t=n.length;return t==4||(n=t==3?"0"+n:t==2?"00"+n:"000"+n),n}function w(){return u()+u()+"-"+u()+"-"+u()+"-"+u()+"-"+u()+u()+u()}function p(){var n=window.location.hash;return n!==""?n.substr(1):null}var i={yes:"1",no:"0",somewhat:"0.5"},e,r,o,s,l,a,h,v;n(function(){var t=n(".socRatingButton:disabled");t.removeAttr("disabled"),n("#socRatingYesBtn").click(c.bind(this,i.yes)),n("#socRatingNoBtn").click(c.bind(this,i.no)),n("#socRatingSomewhatBtn").click(c.bind(this,i.somewhat)),n("#socCommentYesBtn").click(y.bind(this,i.yes)),n("#socCommentNoBtn").click(y.bind(this,i.no)),r=n(".socCommentVerboseText"),r.keyup(f),r.change(f),r.focus(f),r.bind("paste",function(){window.setTimeout(f,200)}),o=n("#feedbackRoot"),s=parseInt(n("#socCommentMaxSize").text()),l=parseInt(n("#socCommentMaxEncodedSize").text()),a=n(".socRatingPnl"),h=n(".socCommentPnl"),v=n(".socThankPnl")});var c=function(t){if(!Wol.ContentInstrumentation||!Wol.ContentInstrumentation.Logging){Sys.Debug.assert(!1,"ContentInstrumentation library is not available",!0);return}e=w();var f={Rating:t,FeedbackId:e},s=p();return s!==null&&(f.UrlHash=s),Wol.ContentInstrumentation.Logging.LogCustomBI("Rating",f,o[0]),t===i.no?(n("#socCommentTitle").html(n("#socCommentNoPrompt").html()),n("#socCommentVerboseText").attr("aria-label",n("#socCommentNoPrompt").text()),n("#socCommentYesBtn").html(n("#socCommentNoYesString").html()),n("#socCommentNoBtn").html(n("#socCommentNoNoString").html())):t===i.somewhat?(n("#socCommentTitle").html(n("#socCommentSomewhatPrompt").html()),n("#socCommentVerboseText").attr("aria-label",n("#socCommentSomewhatPrompt").text()),n("#socCommentYesBtn").html(n("#socCommentSomewhatYesString").html()),n("#socCommentNoBtn").html(n("#socCommentSomewhatNoString").html())):n("#socCommentVerboseText").attr("aria-label",n("#socCommentYesPrompt").text()),a.hide(),h.show(),r.focus(),!1},f=function(){var n=r[0],e=5;n.value.length>s&&(n.value=n.value.substr(0,s));var t=escape(n.value),h=t.length,i=l-e;if(h>i){var u=t.substr(0,i),f=t.substr(i,e),o=f.lastIndexOf("%"),c;u+=o==-1?f:f.substr(0,o),n.value=unescape(u)}},y=function(n){var u,f,s;if(!Wol.ContentInstrumentation||!Wol.ContentInstrumentation.Logging){Sys.Debug.assert(!1,"ContentInstrumentation library is not available",!0);return}return u=r[0],n===i.yes&&u.value.length>0&&(f={Verbatim:u.value,FeedbackId:e},s=p(),s!==null&&(f.UrlHash=s),Wol.ContentInstrumentation.Logging.LogCustomBI("Feedback",f,o[0])),h.hide(),v.show(),!1}}(jQuery),window.CanvasHelper||(window.CanvasHelper={}),CanvasHelper.initCanvas=function(n,t,i,r,u){var f=document.getElementById(n),e=document.getElementById(t);CanvasHelper.isCanvasSupported()?(jQuery(f).show(),jQuery(e).hide(),i(r,u)):(jQuery(e).show(),jQuery(f).hide())},CanvasHelper.isCanvasSupported=function(){var n=document.createElement("canvas");return!!(n.getContext&&n.getContext("2d"))},jQuery(document).ready(function(){jQuery("iframe.iframeNoBorder").attr("frameborder","0")}),window.Wol||(window.Wol={}),Wol.Authentication=function(n){"use strict";var t={silentAuth:0,signedOut:1,signedIn:2},f="MS.LiveSignIn",c="SignedState",l="meta[name='MS\\.AuthenticationDisabled']",a="meta[name='MS\\.BIAuthStateLoggingDisabled']",e="LiveId",o="wol.auth.ifrm",r=t.signedOut,v=function(){var n=t.signedOut,u=Ms.Wol.Cookies.GetCookie(e,!0),o,i,s,r,h;if(u)for(o=u.split("&"),i=0;i<o.length;i++)if(s=o[i],r=s.split("="),r.length===2&&(h=r[0],h==f)){n=parseInt(r[1]),(isNaN(n)||n!==t.silentAuth&&n!==t.signedIn&&n!==t.signedOut)&&(n=t.signedOut);break}return n},s=function(t,i,r){var h=n(t)[0],u,e,f,o,c,s;h&&(u=h.href,u)&&(e=r?"%3d":"=",f=-1,r?f=u.indexOf("%3f"+i+e):(o=u.indexOf("?"+i+e),c=u.indexOf("&"+i+e),o^c&&(f=o!=-1?o:c)),f!=-1&&(s=u.indexOf("&",f+1),s!=-1?n(t)[0].href=u.substring(0,s)+encodeURIComponent(encodeURIComponent(window.location.hash))+u.substring(s):n(t)[0].href+=encodeURIComponent(encodeURIComponent(window.location.hash))))},r=v();s(".hdr-signin-button","wreply"),s(".hdr-signout-button","ru");var h=function(t){var i,r=n(t);return r.length&&(i=r.attr("content")),i},i=function(t){var e=t&&t.authenticated,r=n(".hdr-signin"),s=r.height()*1.5,i,u,o,f,c,l;if(n(".hdr-loading-text").hide(),e){if(r.css("visibility","hidden"),n(".hdr-signout-button").show(),i=[],t.displayName&&i.push(t.displayName),t.firstName&&i.push(t.firstName),i.length>0){for(u=n(".hdr-user-name"),u.show(),o=!1,f=0,c=i.length;f<c;f++)if(u.text(i[f]),r.height()<=s){o=!0;break}o||u.hide()}r.css("visibility","")}else n(".hdr-signin-button").show();h(a)||y(e),l=t&&t.isWLDogfoodUser,Ms.Wol.Dogfood.TryDogfoodRedirect(l)},u=function(n){Wol.ContentInstrumentation.Logging.LogCustomBI(c,{"Ms.LiveSignIn":n}),Ms.Wol.Cookies.SetCookieField(e,f,n,"",!0)},y=function(n){var i=t.signedOut;n&&(i=document.getElementById(o)!=null?t.silentAuth:t.signedIn),r==t.silentAuth?i==t.signedOut&&u(i):r==t.signedIn?i==t.signedOut&&u(i):r==t.signedOut&&(i==t.signedIn||i==t.silentAuth)&&u(i)},p=function(){n.ajax({type:"POST",url:"/WolAuthenticationHandler.ashx",dataType:"json",success:function(t){if(t&&t.authenticationEnabled){if(t.authenticated){i(t);return}if(!t.silentAuthDisabled){n("<iframe/>",{id:o,src:WolAuthenticationSilentAuthHref,style:"display: none"}).appendTo("body");return}}i()},error:function(){i()}})};return n(window).bind("load",function(){var t,r;h(l)||(t=n(".hdr-auth-img"),t.remove().appendTo("body").css({display:"block",visibility:"hidden",position:"absolute",bottom:0}),r=t[0]&&t[0].complete&&t.width()===1&&t.height()===1,t.hide(),r?p():i())}),{setAuthenticationState:i}}(jQuery),window.Wol||(window.Wol={}),Wol.PictureSwitcher=function(n){"use strict";n(document).ready(function(){i("picture-switcher",document).each(function(){r(this)})});var i=function(t,i){return n("."+t,i)},r=function(t){var g=Wol.ContentInstrumentation.Logging,nt=Wol.Util.Tools,r,tt,it=1e3,f,u,rt=!1,s,v,y=window.matchMedia("screen and (min-width:59.375em)"),p=window.matchMedia("screen and (min-width:50em)"),w=window.matchMedia("screen and (min-width:39.375em)"),ut=window.matchMedia("screen and (max-width:39.36875em)"),o=window.matchMedia("only all").matches,lt=function(t){r=n(t),tt=i("ps-wait",r),a(),at(),i("ps-thumb-container",r).click(pt),i("ps-preview-container",r).click(function(n){ut.matches?l(!0)&&c(this):(l(!1),c(this)),n.preventDefault()}),i("ps-image-next",r).click(function(n){l(!0)&&c(this),n.preventDefault()}),i("ps-image-previous",r).click(function(n){wt()&&c(this),n.preventDefault()}),i("ps-page-prev",r).click(function(){ht()&&st(this)}),i("ps-page-next",r).click(function(){ct()&&st(this)}),i("ps-preview",r).bind("load",ft),setTimeout(function(){tt.show()},it),o&&n(window).smartresize(b),n(window).bind("load",function(){b(),rt=!0,ft()})},b=function(){var v,s,u;if(ut.matches?(s=i("ps-preview",r),v=s.height()/2,s.css("margin-top",-1*v)):(s=i("ps-preview",r),s.css("margin-top",0)),!r.hasClass("ps-labeled-thumbnails")){var w=i("ps-page",r).first(),c=i("ps-thumb-container-outer",w).length-1,b=i("ps-thumb-strip",r).width(),t;t=y.matches||!o?6:p.matches?5:4;var c=t-1,k=t*i("ps-active .ps-thumb-container-outer",r).first().width(),d=b-k,l=d/c,a=Wol.Util.Direction.isLtr()?"margin-left":"margin-right",g=Wol.Util.Direction.isLtr()?"margin-right":"margin-left",h=i("ps-thumb-container-outer",r);for(u=0;u<h.length;u++)u%t==0?n(h[u]).css(a,"0"):u%t===c?n(h[u]).css(a,Math.floor(l)-1+"px"):n(h[u]).css(a,l+"px");f.css(g,l+"px"),e()}},at=function(){o&&(y.addListener(function(){a(),e()}),p.addListener(function(){a(),e()}),w.addListener(function(){a(),e()}),i("ps-thumb-container-outer",r).length<=1&&(i("ps-image-next-container",r).hide().attr("aria-hidden","true"),i("ps-image-prev-container",r).hide().attr("aria-hidden","true")))},e=function(){for(var t=0,o,s,e=0;e<u;e++)t+=n(f[e]).outerWidth(!0);o=Wol.Util.Direction.isLtr()?-1:1,s=Wol.Util.Direction.isLtr()?{right:t+"px"}:{left:t+"px"},Modernizr.csstransitions?i("ps-thumb-strip-inner",r).css(Modernizr.prefixed("transform"),"translateX("+o*t+"px)"):(i("ps-thumb-strip-inner",r).clearQueue(),i("ps-thumb-strip-inner",r).animate(s,700,"swing")),i("ps-inner-thumb-container",r).not(i("ps-page.ps-active .ps-inner-thumb-container",r)).attr("tabindex","-1"),i("ps-page.ps-active .ps-inner-thumb-container",r).removeAttr("tabindex")},h=function(){var n="ps-disabled",h,c,l,a,v;u>0?i("ps-page-prev",r).removeClass(n):i("ps-page-prev",r).addClass(n),u<f.length-1?i("ps-page-next",r).removeClass(n):i("ps-page-next",r).addClass(n),vt();var o=i("ps-selection",r),t=o.closest(".ps-thumb-container-outer"),e=t.parent(),s=t.next();s.length===0&&(h=e.next(".ps-page"),h.length===0&&(c=!0)),c?i("ps-image-next",r).addClass(n):i("ps-image-next",r).removeClass(n),l=t.prev(),l.length===0&&(a=e.prev(".ps-page"),a.length===0&&(v=!0)),v?i("ps-image-previous",r).addClass(n):i("ps-image-previous",r).removeClass(n)},vt=function(){i("ps-thumb-container-outer",r).each(function(){n(this).attr("aria-hidden","true")}),w.matches||!o?(n(f[u]).find(".ps-thumb-container-outer").attr("aria-hidden","false"),i("ps-image-next-container",r).attr("aria-hidden","true"),i("ps-image-prev-container",r).attr("aria-hidden","true"),f.length>1&&i("ps-page-nav",r).attr("aria-hidden","false"),i("ps-footnotes-up",r).attr("aria-hidden","true"),i("ps-button-below",r).attr("aria-hidden","true"),i("ps-footnotes",r).attr("aria-hidden","false"),i("ps-button",r).attr("aria-hidden","false")):(i("ps-thumb-container-outer",r).length>1&&(i("ps-image-next-container",r).attr("aria-hidden","false"),i("ps-image-prev-container",r).attr("aria-hidden","false"),i("ps-image-count",r).show().attr("aria-hidden","false")),i("ps-page-nav",r).attr("aria-hidden","true"),i("ps-footnotes-up",r).attr("aria-hidden","false"),i("ps-button-below",r).attr("aria-hidden","false"),i("ps-footnotes",r).attr("aria-hidden","true"),i("ps-button",r).attr("aria-hidden","true"))},ft=function(){if(rt){var n=d(!1),t=new Image;t.src=n.find(".ps-thumb-container").data("preview-url")}},et=function(){s&&s.unbind("load"),v&&clearTimeout(v)},k=function(t){var e;et();var u=t.find(".ps-thumb-container"),o=i("ps-inner-thumb-container",u).children("img").attr("alt"),f=i("ps-preview",r);s=n("<img/>",{"class":f.attr("class"),src:u.data("preview-url"),alt:o,"data-disabledefaultlogging":!0}),e=function(){et(),f.remove(),s.appendTo(i("ps-preview-container-inner",r)),i("ps-caption",r).text(u.data("caption")),ot(u),b()},v=setTimeout(e,it),s.bind("load",e)},ot=function(n){var t=n.data("preview-height")/n.data("preview-width");i("ps-preview-container-inner",r).css("padding-bottom",100*t+"%"),i("ps-preview-container",r).css("max-height",n.data("preview-height"))},d=function(n){var o=i("ps-selection",r),e=o.closest(".ps-thumb-container-outer"),t=e.next(),s,u;if(t.length===0){if(s=e.parent(),u=s.next(".ps-page"),u.length===0){if(n)return!1;u=f.first()}t=i("ps-thumb-container-outer",u).first()}return t},yt=function(){var f=i("ps-selection",r),t=f.closest(".ps-thumb-container-outer"),n=t.prev(),e,u;if(n.length===0){if(e=t.parent(),u=e.prev(".ps-page"),u.length===0)return!1;n=i("ps-thumb-container-outer",u).last()}return n},st=function(n){var t=r.data("control-id"),u=i("ps-page-prev",r),f=n===u[0]?"prev":"next",e=encodeURI("/PictureSwitcher?"+nt.toUrlParams({controlId:t,pagination:f}));g.FireClickEvent(null,n,e)},c=function(n){var u=i("ps-selection",r),t=u.closest(".ps-thumb-container"),f=r.data("control-id"),e=t.data("preview-tfs-id"),o=t.data("preview-revision"),s=encodeURI("/PictureSwitcher?"+nt.toUrlParams({controlId:f})),h={"MS.Cid":e,"MS.CVer":o};g.FireClickEvent(h,n,s)},pt=function(t){var f=n(this),u=i("ps-selection",r),e;u.closest(".ps-thumb-container").removeClass("accentColor").removeClass("ps-active"),u.closest(".ps-thumb-container-outer").attr("aria-expanded","false"),u.remove(),f.addClass("accentColor").addClass("ps-active"),i("ps-inner-thumb-container",f).prepend(u),e=f.closest(".ps-thumb-container-outer"),e.attr("aria-expanded","true"),k(e),c(this),t.preventDefault()},ht=function(){return u>0?(n(f[u]).removeClass("ps-active"),--u,n(f[u]).addClass("ps-active"),h(),e(),!0):!1},ct=function(){return u<f.length-1?(n(f[u]).removeClass("ps-active"),++u,n(f[u]).addClass("ps-active"),h(),e(),!0):!1},l=function(t){var s=i("ps-selection",r),c=s.closest(".ps-thumb-container-outer"),o;if(t){if(o=d(!0),!o)return!1}else o=d(!1);return c.attr("aria-expanded","false"),o.attr("aria-expanded","true"),n(f[u]).removeClass("ps-active"),u=o.parent().index(),n(f[u]).addClass("ps-active"),e(),c.removeClass("accentColor").removeClass("ps-active"),s.remove(),o.addClass("accentColor").addClass("ps-active"),i("ps-inner-thumb-container",o).prepend(s),k(o),h(),!0},wt=function(){var e=i("ps-selection",r),o=e.closest(".ps-thumb-container-outer"),t=yt();return t?(o.attr("aria-expanded","false"),t.attr("aria-expanded","true"),n(f[u]).removeClass("ps-active"),u=t.parent().index(),n(f[u]).addClass("ps-active"),o.removeClass("accentColor").removeClass("ps-active"),e.remove(),t.addClass("accentColor").addClass("ps-active"),i("ps-inner-thumb-container",t).prepend(e),k(t),h(),!0):!1},a=function(){var t,e,s,c;t=y.matches||!o?6:p.matches?5:4,i("ps-inactive-page",r).each(function(){var t=n(this);t.children().length===0&&(t.removeClass("ps-inactive-page"),t.addClass("ps-page"))}),bt(t),!w.matches&&o&&(i("ps-thumb-container-outer",r).length<=1&&i("ps-glass-color",r).length===0?i("ps-divider",r).hide().attr("aria-hidden","true"):i("ps-divider",r).show().attr("aria-hidden","false")),i("ps-page",r).each(function(){var t=n(this);t.children().length===0&&(t.removeClass("ps-page"),t.addClass("ps-inactive-page"))}),f=i("ps-page",r),f.filter(".ps-active").removeClass("ps-active"),e=i("ps-selection",r),s=e.closest(".ps-page"),u=s.index(),s.addClass("ps-active"),c=e.closest(".ps-thumb-container"),ot(c),h()},bt=function(t){for(var e=i("ps-thumb-container-outer",r),f=0,u=0;u<e.length;u++)u%t==0&&u!==0&&f++,n(i("ps-page",r)[f]).append(e[u]);f===0?(i("ps-page-nav",r).hide().attr("aria-hidden","true"),i("ps-image-count",r).hide().attr("aria-hidden","true"),i("ps-glass-color",r).length===0&&i("ps-divider",r).hide().attr("aria-hidden","true")):f>0&&(i("ps-page-nav",r).show().attr("aria-hidden","false"),i("ps-image-count",r).show().attr("aria-hidden","false"),i("ps-divider",r).show().attr("aria-hidden","false"))};return lt(t),{paginateBack:ht,paginateForward:ct,selectNext:l}}}(jQuery),window.Wol||(window.Wol={}),Wol.ModernTabs=function(n){"use strict";var r=Wol.Util.Direction,u=Wol.Util.Visibility,ti=Wol.Util.Math,t={tabControlClassSelector:".modern-tab",horizontalControlClassSelector:".modern-tab-horizontal",tabLinkSelector:".modern-tab-link:not(.modern-tab-dropdown-link)",tabLinkSelectedClassSelector:".modern-tab-link-selected",dropdownBoxClassSelector:".modern-tab-dropdown",dropdownLinkClassSelector:".modern-tab-dropdown-link",dropdownTextClassSelector:".modern-tab-dropdown-text",headingContainerClassSelector:".modern-tab-heading-container",headingContainerWithTitleClassSelector:".modern-tab-heading-container-with-title",bodyClassSelector:".modern-tab-body",linkContainerClassSelector:".modern-tab-link-container",horizontalLinkContainerClassSelector:".modern-tab-link-container-horizontal",contentContainerClassSelector:".modern-tab-content-container",contentClassSelector:".modern-tab-content",titleClassSelector:".modern-tab-title",dropdownVariantClassSelector:".modern-tab-horizontal-variant-dropdown",navLinkContainerClassSelector:".modern-tab-navigation-links",previousLinkClassSelector:".modern-tab-previous",nextLinkClassSelector:".modern-tab-next",tabControlTopClassSelector:".modern-tab-adjusted-top",accordionTitleSelector:".tab-accordion-title",accordionExpandSelector:".tab-accordion-expand",accordionCollapseSelector:".tab-accordion-collapse",accordionSeparatorSelector:".tab-accordion-separator",dropUpVerticalSpacing:23,KeyCodes:{tab:9,enter:13,escape:27,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40},Aria:{selected:"aria-selected",activeDescendant:"aria-activedescendant",hidden:"aria-hidden"}},s=null,l={},f=window.matchMedia("screen and (max-width: 31.86875em)"),a=window.matchMedia("screen and (max-width: 44.99375em)");n(function(){ni()});var nt=function(n,i){var r=n.tabs[i];r.accordionTab.hasClass("modern-tab-link-selected")&&(r.accordionTab.removeClass("modern-tab-link-selected"),r.content.removeClass("modern-tab-content-visible"),r.accordionTabAnchor.attr(t.Aria.selected,"false"),r.content.attr(t.Aria.hidden,"true"),u.notifyHideListeners(r.content))},v=function(t,r,u){var e=t.tabs[r],s,o,c,l;r===t.selectedTabId?(s=!e.content.hasClass("modern-tab-content-visible")||e.isCollapsing,h(e,s),p(t,e)):(o=t.tabs[t.selectedTabId],c=o.content.hasClass("modern-tab-content-visible"),i(t,r,!0,u),c&&(l=function(){var t=n(window),i=e.accordionTab.offset().top,r;i<t.scrollTop()&&(o.content.stop(!0,!0),o.content.removeAttr("style"),r=e.accordionTab.offset().top,t.scrollTop(r))},h(o,!1,l)),h(e,!0))},h=function(n,i,r){n.content.stop(!0,!1),n.accordionTab.addClass("modern-tab-link-selected"),n.content.addClass("modern-tab-content-visible");var f={duration:700,easing:"fastToSlow"};r&&(f.progress=r),i?(n.content.hide(),f.complete=function(){n.accordionTabAnchor.attr(t.Aria.selected,"true"),n.content.attr(t.Aria.hidden,"false"),u.notifyShowListeners(n.content)},n.content.slideDown(f)):(n.isCollapsing=!0,f.complete=function(){n.accordionTab.removeClass("modern-tab-link-selected"),n.content.removeClass("modern-tab-content-visible"),n.accordionTabAnchor.attr(t.Aria.selected,"false"),n.content.attr(t.Aria.hidden,"true"),u.notifyHideListeners(n.content)},f.always=function(){n.isCollapsing=!1},n.content.slideUp(f))},tt=function(t){n(t.tabList).each(function(n,t){t.content.stop(!0,!0),t.content.removeAttr("style")})},i=function(n,i,r,f){var o,e;if(i&&n.tabs[i]){if(i===n.selectedTabId)return}else i=n.defaultTabId;n.selectedTabId&&(o=n.tabs[n.selectedTabId],o.inlineTab.removeClass("modern-tab-link-selected"),o.inlineTabAnchor.attr(t.Aria.selected,"false").attr("tabindex","-1"),o.content.removeClass("modern-tab-content-visible").attr(t.Aria.hidden,"true"),u.notifyHideListeners(o.content)),e=n.tabs[i],e.inlineTab.addClass("modern-tab-link-selected"),e.inlineTabAnchor.attr(t.Aria.selected,"true").removeAttr("tabindex"),e.content.addClass("modern-tab-content-visible").attr(t.Aria.hidden,"false"),n.isHorizontal&&rt(n,e,o),it(n,i),u.notifyShowListeners(e.content),r&&p(n,e),f&&(e.inlineTabAnchor.blur(),n.isHorizontal&&e.accordionTabAnchor.blur()),n.selectedTabId=i,Wol.Util.HashParameters.setHashValue(n.tabControlId,i,!0)},it=function(n,t){if(n.previousLink&&n.nextLink){var i=n.tabs[t].index;i===0?n.previousLink.hide():n.previousLink.show(),i===n.tabList.length-1?n.nextLink.hide():n.nextLink.show()}},rt=function(n,i,r){n.isDropdownVariant?c(n.dropdownLink,i.dropdownTabAnchor.text()):y(n,i.isDropdownItem||!1),i.dropdownTab.addClass("modern-tab-link-selected").addClass("accentBackground").addClass("accentForeground"),i.dropdownTabAnchor.attr(t.Aria.selected,"true"),i.accordionTab.addClass("modern-tab-link-selected"),i.accordionTabAnchor.attr(t.Aria.selected,"true").removeAttr("tabindex"),r&&(r.dropdownTab.removeClass("modern-tab-link-selected").removeClass("accentBackground").removeClass("accentForeground"),r.dropdownTabAnchor.attr(t.Aria.selected,"false"),r.accordionTab.removeClass("modern-tab-link-selected"),r.accordionTabAnchor.attr(t.Aria.selected,"false").attr("tabindex","-1"))},y=function(n,i){var r=n.dropdownLink.find("a").first();n.dropdownLink.toggleClass("modern-tab-dropdown-link-selected",i),r.attr(t.Aria.selected,i.toString()),i?r.removeAttr("tabindex"):r.attr("tabindex","-1")},p=function(n,t){var i="/modernTabs?"+Wol.Util.Tools.toUrlParams({controlId:n.tabControlId,tabId:t.tabId}),r=t.inlineTabAnchor.text();Wol.ContentInstrumentation.Logging.FireClickEvent(null,n.tabControl[0],i,r)},c=function(n,i){n.find(t.dropdownTextClassSelector).children("a").text(i)},ut=function(t){var r,u,f,e;if(t.tabList.length){if(t.tabList.length===1){t.tabList[0].inlineTab.addClass("modern-tab-link-visible");return}}else throw"Expected at least one tab in tab control '"+t.tabControlId+"'";t.dropdownLink.css("visibility","hidden"),t.dropdownLink.addClass("modern-tab-link-visible"),t.isTitlePresent&&(u=0,n(t.tabList).each(function(n,t){t.inlineTab.css("visibility","hidden"),t.inlineTab.addClass("modern-tab-link-visible"),t.inlineTab.width()>u&&(r=t,u=t.inlineTab.width()),t.inlineTab.removeClass("modern-tab-link-visible")}),c(t.dropdownLink,r.dropdownTabAnchor.text()),f=t.dropdownLink.outerWidth(!0),t.linkContainer.width(f),t.selectedTabId&&(e=t.tabs[t.selectedTabId],c(t.dropdownLink,e.dropdownTabAnchor.text()))),n(t.tabList).each(function(n,t){t.isDropdownItem=!0}),n(t.tabList).each(function(n,t){t.dropdownTab.show()}),t.dropdownLink.addClass("modern-tab-dropdown-link-selected"),t.dropdownLink.css("visibility","visible")},ft=function(t,i,r){var f=t.tabList.length,o,h,u,v,c,s,p,l,w;if(!f)throw"Expected at least one tab in tab control '"+t.tabControlId+"'";if(h=!1,u=t.preferredNumTabsVisible,u?u=Math.max(1,Math.min(f,u)):(h=!0,u=1),n(t.tabList).each(function(n,t){t.inlineTab.css("visibility","hidden"),t.inlineTab.removeClass("modern-tab-link-visible"),t.dropdownTab.hide()}),v=i.width()+1,t.dropdownLink.css("visibility","hidden"),t.dropdownLink.toggleClass("modern-tab-link-visible",u<f),h){for(c=r.height(),t.tabList[0].inlineTab.addClass("modern-tab-link-visible");c===r.height()&&u<f;)t.tabList[u].inlineTab.addClass("modern-tab-link-visible"),u++,u===f&&t.dropdownLink.removeClass("modern-tab-link-visible");c!==r.height()&&u>1&&(u===f&&t.dropdownLink.addClass("modern-tab-link-visible"),u--,t.tabList[u].inlineTab.removeClass("modern-tab-link-visible"))}else for(o=0;o<u;o++)t.tabList[o].inlineTab.addClass("modern-tab-link-visible");for(s=u<f?t.dropdownLink.outerWidth(!0):0,o=0;o<u;o++)s+=t.tabList[o].inlineTab.outerWidth(!0);for(p=function(){return a.matches?0:r.outerWidth(!0)};s+p()>v&&u>1;)u===f&&(t.dropdownLink.addClass("modern-tab-link-visible"),s+=t.dropdownLink.outerWidth(!0)),u--,l=t.tabList[u].inlineTab,s-=l.outerWidth(!0),l.removeClass("modern-tab-link-visible");u===f?e(t):t.selectedTabId&&(w=t.tabs[t.selectedTabId].index,y(t,w>=u)),n(t.tabList).each(function(n,t){t.inlineTab.css("visibility","visible"),t.isDropdownItem=n>=u,t.isDropdownItem&&t.dropdownTab.show()}),t.dropdownLink.css("visibility","visible")},w=function(n){if(!f.matches){var i=n.linkContainer.parents(t.headingContainerClassSelector),r=i.find(t.titleClassSelector);n.isDropdownVariant?n.isDropdownVariantLayoutRendered||(ut(n,i),n.isDropdownVariantLayoutRendered=!0):ft(n,i,r)}},b=function(t){var i=t.adjustedTopAnchor.offset(),r=n(window).scrollTop(),u=r+n(window).height();(i.top<r||i.top>u)&&window.scrollTo(0,i.top)},et=function(n){var r=n.tabs[n.selectedTabId].index,t=n.tabList[r-1];t&&(i(n,t.tabId,!0),b(n))},ot=function(n){var r=n.tabs[n.selectedTabId].index,t=n.tabList[r+1];t&&(i(n,t.tabId,!0),b(n))},st=function(n){o(n,n.dropdownFocusedIndex+1,!1)},ht=function(n){o(n,n.dropdownFocusedIndex-1,!1)},o=function(n,i,r){var u=n.tabList[i],f;u&&u.isDropdownItem&&(n.dropdownFocusedIndex!==undefined&&(f=n.tabList[n.dropdownFocusedIndex],f.dropdownTab.removeClass("modern-tab-dropdown-tab-link-focused-and-selected").removeClass("modern-tab-dropdown-tab-link-focused"),f.dropdownTabAnchor.removeAttr(t.Aria.activeDescendant)),u.tabId===n.selectedTabId?u.dropdownTab.addClass("modern-tab-dropdown-tab-link-focused-and-selected"):u.dropdownTab.addClass("modern-tab-dropdown-tab-link-focused"),u.dropdownTabAnchor.attr(t.Aria.activeDescendant,"true"),r||u.dropdownTabAnchor.focus(),n.dropdownFocusedIndex=i)},ct=function(t){var i=t.data.tabControlData,u,r;if(!i.isDropdownOpen){if(s&&e(s),i.dropdownBox.addClass("modern-tab-dropdown-open"),k(i),d(i),u=i.tabs[i.selectedTabId],u.isDropdownItem)o(i,u.index,!i.dropdownOpenedViaEnterKey);else for(r=0;r<i.tabList.length;r++)if(i.tabList[r].isDropdownItem){o(i,r,!i.dropdownOpenedViaEnterKey);break}t.stopPropagation();n(document).one("click",function(){e(i)});i.isDropdownOpen=!0,s=i,i.dropdownOpenedViaEnterKey=!1}},k=function(n){var i,u,e,t,f;a.matches||!n.isTitlePresent?(i=n.dropdownList.find("a").first(),u=(i.outerWidth(!0)-i.width()+n.dropdownList.outerWidth(!0)-n.dropdownList.width())/2,n.dropdownList.css(r.farString(),"auto"),e=r.position(n.dropdownLink,!0,!0),r.setFarPixels(n.dropdownList,e.far,!0,!0),t={left:-u,right:n.dropdownBox.outerWidth(!0)+u},f=r.position(n.dropdownList,!0,!0),r.isLtr()&&f.near<=t.left?r.setNearPixels(n.dropdownList,t.left,!0,!0):!r.isLtr()&&f.near>=t.right&&r.setNearPixels(n.dropdownList,t.right,!0,!0)):(n.dropdownList.css("left",""),n.dropdownList.css(r.farString(),""))},d=function(i){var l;i.dropdownList.css("top","");var e=i.dropdownLink.offset(),o=i.dropdownList.offset(),r=n(window).scrollTop(),s=e.top-r,h=o.top-r,c=n(window).height()-h,u=i.dropdownList.outerHeight(),f=u+t.dropUpVerticalSpacing;u>c&&f<=s&&(l=-(i.dropdownLink.outerHeight()+f),i.dropdownList.css("top",l+"px"))},e=function(n){n.isDropdownOpen&&(n.dropdownBox.removeClass("modern-tab-dropdown-open"),n.isDropdownOpen=!1,s=null)},lt=function(n){var t=Wol.Util.HashParameters.getHash(n.tabControlId);t?(t=t.toLowerCase(),t!==n.selectedTabId&&i(n,t,!1,!0)):Wol.Util.HashParameters.setHashValue(n.tabControlId,n.selectedTabId,!0)},at=function(n,r){if(n.isDropdownOpen)switch(r.which){case t.KeyCodes.tab:e(n);break;case t.KeyCodes.enter:i(n,n.tabList[n.dropdownFocusedIndex].tabId,!1),e(n),r.preventDefault();break;case t.KeyCodes.escape:e(n),r.preventDefault();break;case t.KeyCodes.upArrow:ht(n),r.preventDefault();break;case t.KeyCodes.downArrow:st(n),r.preventDefault()}},g=function(n,r){var e=function(t){t.isDropdownItem&&!f.matches?n.dropdownLink.find("a").first().focus():(n.isHorizontal&&f.matches?v(n,t.tabId,!1,r):i(n,t.tabId,!0,!1),f.matches?t.accordionTabAnchor.focus():t.inlineTabAnchor.focus())},o=n.tabs[n.selectedTabId].index,u,s;switch(r.which){case t.KeyCodes.leftArrow:case t.KeyCodes.upArrow:u=o-1,u<0&&(u=n.tabList.length-1),e(n.tabList[u]),r.preventDefault();break;case t.KeyCodes.rightArrow:case t.KeyCodes.downArrow:s=(o+1)%n.tabList.length,e(n.tabList[s]),r.preventDefault()}},vt=function(n,r){var e,f,u;if(!n.isDropdownOpen){e=n.tabs[n.selectedTabId].index,f=function(t){var r=e===t.index;i(n,t.tabId,!r,!0),t.inlineTabAnchor.focus()};switch(r.which){case t.KeyCodes.leftArrow:case t.KeyCodes.upArrow:for(u=n.tabList.length-1;n.tabList[u].isDropdownItem;)u--;f(n.tabList[u]),r.preventDefault();break;case t.KeyCodes.rightArrow:case t.KeyCodes.downArrow:f(n.tabList[0]),r.preventDefault()}}},yt=function(t){n(t.tabList).each(function(n,i){i.inlineTab.keydown(g.bind(this,t)),t.isHorizontal&&i.accordionTab.keydown(g.bind(this,t))}),t.isHorizontal&&!t.isDropdownVariant&&t.dropdownLink.keydown(vt.bind(this,t))},pt=function(n){var t=n.tabs[n.selectedTabId];u.notifyShowListeners(t.content)},wt=function(n){var t=n.tabs[n.selectedTabId];u.notifyHideListeners(t.content)},bt=function(i){if(i.isHorizontal){if(f.matches||tt(i),i.selectedTabId){var r=i.tabs[i.selectedTabId];r.content.hasClass("modern-tab-content-visible")||(r.accordionTab.addClass("modern-tab-link-selected").attr(t.Aria.selected,"true"),r.content.addClass("modern-tab-content-visible").attr(t.Aria.hidden,"false"),u.notifyShowListeners(r.content))}}else n(i.tabList).each(function(n,t){t.tabId!==i.selectedTabId&&(f.matches?Wol.Util.Visibility.notifyShowListeners(t.content):Wol.Util.Visibility.notifyHideListeners(t.content))})},kt=function(r){var e,s;u.initVisibilityManipulator(r.tabControl,wt.bind(this,r),pt.bind(this,r)),e=r.tabList,e.length>1&&n(e).each(function(n,t){var u=t.tabId;t.inlineTab.click(function(){i(r,u,!0,!0)}),r.isHorizontal&&(t.dropdownTab.click(function(){i(r,u,!0,!0)}),t.accordionTab.click(v.bind(this,r,u,!0)),t.dropdownTab.hover(function(){o(r,n,!0)}))}),r.isHorizontal&&(s=r.dropdownLink.find("a"),s.keydown({tabControlData:r},function(n){n.which===t.KeyCodes.enter&&(r.dropdownOpenedViaEnterKey=!0)}),s.click({tabControlData:r},ct),n(document).keydown(at.bind(this,r)),n(window).smartresize(function(){w(r),r.isDropdownOpen&&(k(r),d(r))})),f.addListener(bt.bind(this,r)),r.previousLink&&r.nextLink&&(r.previousLink.children("a").click(function(){et(r)}),r.nextLink.children("a").click(function(){ot(r)})),Wol.Util.HashParameters.attachToHashChangeEvent(function(){lt(r)}),yt(r)},dt=function(n){var r=Wol.Util.HashParameters.getHash(n.tabControlId),i=n.linkContainer.find(t.tabLinkSelectedClassSelector+" a").data("tab-id");return i?(i=i.toLowerCase(),n.defaultTabId=i):n.tabList.length&&(n.defaultTabId=n.tabList[0].tabId),r?(r=r.toLowerCase(),i&&i!==r&&(n.selectedTabId=i)):r=i,r},gt=function(r){var e=n(r),s=e.data("tab-control-id"),tt,it,h,ot,ii,st;if(l[s])throw"Duplicate tab control id encountered. Multiple tab controls on this page use id '"+s+"'";else l[s]=s;var ht=e.find(t.headingContainerClassSelector).first(),o=e.find(t.linkContainerClassSelector).first(),y=o.find(t.horizontalLinkContainerClassSelector).first(),ct=e.find(t.bodyClassSelector).first(),a=ct.children(t.contentContainerClassSelector).first(),k=a.children(t.navLinkContainerClassSelector).first(),d=o.find(t.dropdownBoxClassSelector),g=d.children("ul"),v;for(v=y.length?y.find(t.tabLinkSelector):o.find(t.tabLinkSelector),tt={},it=[],h=0;h<v.length;h++){var rt=n(v[h]),ut=rt.children("a"),c=ut.data("tab-id"),p="[data-tab-id='"+c+"']",lt=a.children(t.contentClassSelector+p),ft=g.find(t.tabLinkSelector+" a"+p),at=ft.parent(),et=a.find(t.accordionTitleSelector+" a"+p),vt=et.parent();c=c.toLowerCase(),ot={tabId:c,inlineTab:rt,inlineTabAnchor:ut,dropdownTab:at,dropdownTabAnchor:ft,accordionTab:vt,accordionTabAnchor:et,content:lt,index:h},tt[c]=ot,it[h]=ot}var yt=o.find(t.dropdownLinkClassSelector),pt=k.find(t.previousLinkClassSelector),wt=k.find(t.nextLinkClassSelector),bt=e.find(t.tabControlTopClassSelector),b=e.is(t.horizontalControlClassSelector),gt=o.is(t.dropdownVariantClassSelector),ni=ht.is(t.headingContainerWithTitleClassSelector),ti=o.data("number-of-tabs-displayed"),u={tabControl:e,tabControlId:s,tabs:tt,tabList:it,linkContainer:o,horizontalLinkContainer:y,contentContainer:a,dropdownBox:d,dropdownList:g,dropdownLink:yt,previousLink:pt,nextLink:wt,adjustedTopAnchor:bt,isHorizontal:b,isDropdownVariant:gt,isTitlePresent:ni,preferredNumTabsVisible:ti,selectedTabId:null,defaultTabId:null};kt(u),b&&w(u),u.tabList.length===1&&u.isHorizontal&&(ii=t.accordionExpandSelector+", "+t.accordionCollapseSelector,u.tabList[0].accordionTab.find(ii).hide(),u.tabList[0].content.css("margin-bottom","0"),u.contentContainer.find(t.accordionSeparatorSelector).hide()),st=dt(u),i(u,st,!1,!0),b&&u.tabList.length>1&&f.matches&&nt(u,st)},ni=function(){for(var r=n(t.tabControlClassSelector),i=0;i<r.length;i++)gt(r[i]);Wol.Util.Tools.scrollToInPageAnchor()};return{}}(jQuery),window.Wol||(window.Wol={}),Wol.Header=function(n){"use strict";var bi=Wol.Util.Algorithm,h=Wol.Util.Direction,ki=Wol.ContentInstrumentation.Logging,bt=Wol.Util.Tools,i={bodyContentPane:"#bodyContentPane",bodyContainer:"#bodyContainer",fullBleedMain:"#hdr-fb-main",header:"#hdr",opaquePanel:"#",transparentPanel:"#",farChild:"#hdr-far-child",nearChild:"#hdr-near-child",secondaryContainer:"#hdr-2c",primaryNav:"#hdr-nav-large-primary",secondaryNav:"#hdr-nav-large-secondary",compactNav:"#hdr-nav-compact",pagination:"#hdr-chevron-c",prevButton:"#hdr-prev-button",nextButton:"#hdr-next-button",prevButtonSpriteClip:"#hdr-prev-button-img",nextButtonSpriteClip:"#hdr-next-button-img",ellipsis:"#hdr-trunc-str",stubSearchButton:"#hdr-v-search",menuButton:"#hdr-v-menu",vectorLogo:"#hdr-v-logo",imgLogo:"#hdr-logo",search:"#SearchQuery",inPageSearchBox:"#SearchResults",searchBorder:"#hdr-search-border",skipToContent:"#hdr-skip-to-content",svgLogo:"#HeaderSvgWinLogo_href"},f={separator:".hdr-nav-separator",searchInput:".SearchQueryTextInput",searchSubmit:".SearchQuerySubmit",topOfContent:".hdr-inpage-anchor",peekTranslucency:".hdr-peek",userName:".hdr-user-name",signOutLink:".hdr-signout-button",signinLink:".hdr-signin-button"},e={compactNavTabletWidth:365,compactNavMiniTabletWidth:319,compactNavPhoneWidth:274,cookieExpandedState:"expand",cookieCollapsedState:"collapse",tabKey:9,peekOpacity:.6},v,y,r,c,u,p,l,tt,k,ot="…",di="_clone",kt=!1,dt=250,st=20,ht=10,d=366,gt=333,ct=50,it=166,ni=4,gi=2,rt=366,nr=!1,o,tr,s=0,ti={},ii={},ut=window.matchMedia("screen and (min-width:62.875em)"),ri=window.matchMedia("screen and (max-width:62.86875em)"),lt=window.matchMedia("screen and (max-width:62.86875em) and (min-width:47.5em)"),at=window.matchMedia("screen and (max-width:47.49375em)"),vt=window.matchMedia("screen and (max-width:31.86875em)"),ft=window.matchMedia("only all").matches;n(function(){if(wr(),br(),ar(n(i.secondaryNav)),n.easing.fastToSlow=er,n(i.secondaryContainer).data("enable-animations")||(dt=0,d=0,gt=0,ct=0,it=0,rt=0),v=n(i.menuButton),y=n(i.stubSearchButton),r=n(i.compactNav),c=n(i.bodyContainer),u=n(f.peekTranslucency),p=n(i.search),l=n(i.farChild),tt=n(i.farChild+" "+f.signinLink),k=n(i.compactNav+" "+f.signinLink),n(i.header).length>0&&(ir(),tr=n(i.opaquePanel).width()),n(i.inPageSearchBox).length>0&&(l.addClass("hdr-show-search"),a(l,p,"hdr-show-search")),vi(),hr(),ft&&!b()&&!Modernizr.csstransitions){var t=li(),o=Wol.Util.Direction.isLtr()?{right:-1*t+"px"}:{left:-1*t+"px"},s=Wol.Util.Direction.isLtr()?{right:"0px"}:{left:"0px"};r.css(o),u.css(s)}ft&&b()&&(r.css("transition","none"),u.css("transition","none"),wt(!0)),n(i.compactNav+" "+f.signinLink+", "+i.compactNav+" "+f.signOutLink).keydown(function(t){t.which===e.tabKey&&!t.shiftKey&&b()&&(t.preventDefault(),n(i.svgLogo).focus())}),n(i.svgLogo).keydown(function(t){t.which===e.tabKey&&t.shiftKey&&b()&&(t.preventDefault(),n(i.compactNav+" "+f.signinLink+":visible").length>0?n(f.signinLink).focus():n(f.signOutLink).focus())})});var ir=function(){n(i.prevButton).click(function(){yi(-1),et(i.prevButton,n(i.prevButton)[0],"PrevNavPage")}),n(i.nextButton).click(function(){yi(1),et(i.nextButton,n(i.nextButton)[0],"NextNavPage")}),v.click(function(){et(i.menuButton,v[0],n("html").hasClass("hdr-expanded-nav")?"HideCompactNav":"ShowCompactNav"),wt()}),y.click(function(){ai(),et(i.stubSearchButton,y[0],l.hasClass("hdr-show-search")?"ShowFullSearch":"HideFullSearch")}),ur()},et=function(n,t,i){var r=encodeURI("/Header?"+bt.toUrlParams({controlId:n,action:i}));ki.FireClickEvent(null,t,r)},ui=function(n){n.matches&&(v.attr("aria-hidden","true"),y.attr("aria-hidden","true"),r.attr("aria-hidden","true"),k.attr("aria-hidden","true"),p.attr("aria-hidden","true"),tt.attr("aria-hidden","false"),wi()&&Wol.Util.Visibility.notifyShowListeners(c))},fi=function(t){n("html").hasClass("hdr-expanded-nav")&&w(),t.matches&&(v.attr("aria-hidden","false"),y.attr("aria-hidden","true"),a(n("html"),r,"hdr-expanded-nav"),a(n("html"),k,"hdr-expanded-nav"),p.attr("aria-hidden","false"),tt.attr("aria-hidden","true"),n("html").hasClass("hdr-expanded-nav")&&!Modernizr.csstransitions&&g(e.compactNavTabletWidth))},ei=function(t){n("html").hasClass("hdr-expanded-nav")&&w(),t.matches&&(v.attr("aria-hidden","false"),y.attr("aria-hidden","false"),tt.attr("aria-hidden","true"),n(f.searchInput).is(":focus")&&!l.hasClass("hdr-show-search")&&ai(),a(n("html"),r,"hdr-expanded-nav"),a(n("html"),k,"hdr-expanded-nav"),a(l,p,"hdr-show-search"),n("html").hasClass("hdr-expanded-nav")&&!Modernizr.csstransitions&&g(e.compactNavMiniTabletWidth))},oi=function(t){n("html").hasClass("hdr-expanded-nav")&&w(),n("html").hasClass("hdr-expanded-nav")&&!Modernizr.csstransitions&&(t.matches?g(e.compactNavPhoneWidth):g(e.compactNavMiniTabletWidth))},si=function(n){n.matches&&hi()},rr=function(n){n.matches&&b()&&Wol.Util.Visibility.notifyHideListeners(c)},ur=function(){if(!ft){hi();return}si(ut),ui(ut),fi(lt),ei(at),oi(vt),ut.addListener(ui),ut.addListener(si),lt.addListener(fi),at.addListener(ei),vt.addListener(oi),ri.addListener(rr)},hi=function(){kt||(n(i.secondaryNav).length>0&&setTimeout(function(){vr(),or(),o.length>1&&sr()},dt),kt=!0)},fr=function(n){var t=n.attr("id"),i=t+di;ti[t]=i,ii[i]=t},er=function(n){var t=-2.9*Math.pow(n,4)+7.1*Math.pow(n,3)-6.6*Math.pow(n,2)+3.34*n;return.9*3*Math.pow(1-t,2)*t+3*(1-t)*Math.pow(t,2)+Math.pow(t,3)},yt=function(t,i,r,u){var s="+="+r+"px",f={duration:d,easing:"fastToSlow",queue:!1},e={duration:rt,easing:"fastToSlow",queue:!1,done:function(){n(this).css("opacity",i)}},o;u&&(o=d>rt?f:e,o.queue=!0,o.complete=u),t.animate({left:s},f),t.animate({opacity:i},e)},or=function(){var t,r,u;o.length>0&&(t=o[s],t.appendTo(i.secondaryNav),r=h.isLtr()?1:-1,u=r*st,t.each(function(t,i){i.style.left=u+"px",n(i).fadeTo(0,0)}),yt(t,1,-r*st))},sr=function(){var r=n(i.pagination),v={duration:rt,easing:"fastToSlow",queue:!1},f=h.isLtr()?"marginRight":"marginLeft",e={},y,t,u,a;if(e[f]="0px",y=function(){r.animate({opacity:1},v),r.animate(e,d,"fastToSlow")},r.fadeTo(0,0),r[0].style[f]=-st+"px",setTimeout(y,ct),nr){var c=h.isLtr()?1:-1,p="-="+c*ni+"px",w="+="+c*ni+"px",b=[p,w],k=[n(i.prevButtonSpriteClip),n(i.nextButtonSpriteClip)],l=[s>0,s<o.length-1];for(t=0;t<l.length;t++)if(l[t])for(u=k[t],u.delay(ct+d+it),a=0;a<gi;a++)u.animate({left:b[t]},it,"fastToSlow"),u.animate({left:"0px"},it,"fastToSlow")}},ci=function(t){for(var r,i=0;i<o.length;i++)r=o[i],t&&r.stop(!0,!0),i!==s&&r.remove(),r.each(function(t,i){i.style.left="auto";var r=ii[n(i).attr("id")];r&&n(i).attr("id",r)});o[s].fadeTo(0,1)},hr=function(){r.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.hasClass("hdr-animate-collapse-nav")&&(c.css("top",""),r.css("top",""),r.removeClass("hdr-animate-collapse-nav"),u.removeClass("hdr-animate-collapse-nav"),n("html").toggleClass("hdr-expanded-nav"),r.hide())});u.click(function(t){n("html").hasClass("hdr-expanded-nav")&&(wt(),t.preventDefault())}),ft&&(n(window).smartresize(pt),pt())},g=function(n){var t=Wol.Util.Direction.isLtr()?{right:"0px"}:{left:"0px"},i=Wol.Util.Direction.isLtr()?{right:n+"px",opacity:e.peekOpacity}:{left:n+"px",opacity:e.peekOpacity};r.animate(t,500,"fastToSlow",function(){nt(!0)}),u.animate(i,500,"fastToSlow")},cr=function(t){var i=Wol.Util.Direction.isLtr()?{right:-1*t+"px"}:{left:-1*t+"px"},f=Wol.Util.Direction.isLtr()?{right:"0px"}:{left:"0px"};r.animate(i,500,"fastToSlow",function(){r.removeClass("hdr-animate-collapse-nav").css("top",""),u.removeClass("hdr-animate-collapse-nav"),r.css("top",""),c.css("top",""),n("html").toggleClass("hdr-expanded-nav"),r.hide(),n(window).scrollTop(0),nt(!1)}),u.animate(f,500,"fastToSlow")},w=function(){var t=n(i.fullBleedMain).height();c.css("top",t+"px"),r.css("top",t+"px"),u.css("top",t+"px")},pt=function(){r.css("min-height",n(window).height()-120+"px"),u.css("height",r.outerHeight(!0)+"px")},wt=function(t){if(t!==!0&&(r.css("transition",""),u.css("transition","")),Modernizr.csstransitions){if(n("html").hasClass("hdr-expanded-nav")){r.addClass("hdr-animate-collapse-nav"),u.hide(),u.addClass("hdr-animate-collapse-nav"),nt(!1),n(window).scrollTop(0),Wol.Util.Visibility.notifyShowListeners(c);return}pt(),r.show(),Wol.Util.Visibility.notifyHideListeners(c),u.show(0,function(){nt(!0),n("html").toggleClass("hdr-expanded-nav"),w()})}else{var i=li();n("html").hasClass("hdr-expanded-nav")?(u.css("opacity",0),r.addClass("hdr-animate-collapse-nav"),u.addClass("hdr-animate-collapse-nav"),Wol.Util.Visibility.notifyShowListeners(c),cr(i)):(t!==!0?u.css("opacity",0):u.css("opacity",e.peekOpacity),r.show(),Wol.Util.Visibility.notifyHideListeners(c),w(),n("html").toggleClass("hdr-expanded-nav"),g(i))}n("html").hasClass("hdr-expanded-nav")?v.attr("aria-pressed","true"):v.attr("aria-pressed","false"),a(n("html"),r,"hdr-expanded-nav"),a(n("html"),k,"hdr-expanded-nav")},li=function(){var n=e.compactNavTabletWidth;return vt.matches?n=e.compactNavPhoneWidth:at.matches?n=e.compactNavMiniTabletWidth:lt.matches&&(n=e.compactNavTabletWidth),n},ai=function(){p.slideToggle(700,"fastToSlow"),l.toggleClass("hdr-show-search"),a(l,p,"hdr-show-search");var t=f.searchInput+" input";n("html").hasClass("hdr-expanded-nav")&&w(),l.hasClass("hdr-show-search")?(y.attr("aria-pressed","true"),n(t).first().focus()):(n(t).first().blur(),y.attr("aria-pressed","false")),vi()},vi=function(){var n=Wol.SearchBox.getInstance(l);n&&n.resizeTextBox()},a=function(n,t,i){n.hasClass(i)?t.attr("aria-hidden","false"):t.attr("aria-hidden","true")},yi=function(t){var u,e,f,a,v,y;if(t=t<0?-1:1,u=s+t,0<=u&&u<o.length){ci(!0),e=o[s],s=u;var r=o[s],c=t<0?r.last():r.first(),l=ti[c.attr("id")];l&&c.attr("id",l),r.appendTo(i.secondaryNav),r.show(),f=h.isLtr()?1:-1,a=h.position(e.first()).near-h.position(r.first()).near+f*t*ht,r.each(function(t,i){i.style.left=a+"px",n(i).fadeTo(0,0)}),v=r.length,y=function(){--v==0&&ci(),n(i.secondaryNav).children().first().focus()},yt(e,0,f*-t*ht),r.delay(gt),r.queue(function(i){yt(n(this),1,f*-t*ht,y),i()}),pi()}},pi=function(){n(i.pagination).children().removeAttr("disabled"),s===0&&n(i.prevButton).attr("disabled","disabled"),s===o.length-1&&n(i.nextButton).attr("disabled","disabled")},lr=function(n){var t=n.children();n.empty(),n.append(t)},ar=function(n){if(window.serverProcessing){var t="."+serverProcessing.Detection.ExclDevice;n.children(t).remove()}},vr=function(){var t=n(i.secondaryNav),c,u,r,h,f,e;for(lr(t),ot=jQuery.trim(n(i.ellipsis).text()),yr()?n(i.pagination).show():t.css({width:"auto",maxWidth:"none"}),c=t.width(),o=pr(c),s=0,u=!1,r=o.length-1;!u&&r>=0;r--)for(h=o[r],f=0;!u&&f<h.length;f++)h.eq(f).hasClass("hdr-act-tax")&&(s=r,u=!0);for(pi(),t.children().css("visibility","visible"),e=0;e<o.length;e++)o[e].css("visibility","visible")},yr=function(){var r=n(i.secondaryNav),t=h.position(r.children().last()),u=n(i.secondaryContainer).width();return t.far<0||u<t.far},pr=function(t){for(var l=n(i.secondaryNav).children(),y=l.filter(f.separator).length,r=l.slice(y*2),p=function(n){var i=h.position(r[n]);return 0<i.near&&i.near<t},a=[];r.length>0;){var o=Math.max(1,bi.partitionPoint(r,p)),s=r.eq(o-1),v=h.position(s),w=h.isLtr()?t-v.near:v.near,u=bt.truncateWithEllipsis(s,ot,w);u||(o=Math.max(1,o-1));var e=r.slice(0,o).clone(),c=o,b=u.length>0&&u!==s.text();e.length>1&&b&&(fr(e.last()),--c),u&&(u===ot?e.splice(e.length-1,1):e.last().text(u)),a.push(e),r.slice(0,c).remove(),r=r.slice(c)}return a},wr=function(){window.serverProcessing&&n("body").addClass(serverProcessing.Detection.Device)},br=function(){n("*[tabindex]").each(function(){var t=n(this).attr("tabindex");t!=-1&&n(this).attr("tabindex",t+100)});var r=1,t=function(t){n(t).each(function(){n(this).attr("tabindex",r),r++})};t(i.vectorLogo+" a"),t(i.imgLogo+" a"),t(i.skipToContent),t(i.stubSearchButton),n(f.searchInput+" input").first().attr("tabindex",r),r++,n(f.searchSubmit+" button").first().attr("tabindex",r),r++,t(i.menuButton),t(i.compactNav+" ul li a"),t(i.primaryNav+" a"),t(f.userName),t(f.signOutLink),t(f.signinLink),t(i.secondaryNav+" a"),t(i.prevButton),t(i.nextButton)},nt=function(n){n?Ms.Wol.Cookies.SetCookie("hdr-nav-compact",e.cookieExpandedState,"",!0):Ms.Wol.Cookies.SetCookie("hdr-nav-compact",e.cookieCollapsedState,"",!0)},b=function(){return wi()&&ri.matches?!0:!1},wi=function(){return Ms.Wol.Cookies.GetCookie("hdr-nav-compact",!0)===e.cookieExpandedState?!0:!1};return{setCompactNavCookieState:nt,isCompactNavShown:b}}(jQuery),Wol.Aobi=function(n){"use strict";var i={outerAobiSelector:".section_oly",backgroundAobiSelector:".section_oly-bg",clickableAobiSelector:".section_oly-bg-clickable",clickableAobiBgImageSelector:".section_oly-bg .navigationLink"};n(function(){u()});var u=function(){n(i.clickableAobiSelector).click(f),n(i.clickableAobiBgImageSelector).click(r)},f=function(n){if(!Wol.Util.AnchorClick.isClickOnAnchorElement(n))return r(n)},r=function(t){var r=n(t.target).parents(i.outerAobiSelector),u,f;if(r.length)return(u=r.first().children(i.backgroundAobiSelector),!u.length)?void 0:(f=u.first().children("a"),!f.length)?void 0:(Wol.Util.AnchorClick.clickOnAnchor(f[0],{ExId:"AOBIBackgroundLink"}),!1)};return{}}(jQuery),window.Wol||(window.Wol={}),Wol.Dropdown=function(n){"use strict";function p(n,t){var i=t.attr("data-value");i?(n.dropdownButtonAnchor.attr("href",i),n.dropdownButtonAnchor.removeClass("dropdown_button_disabled")):(n.dropdownButtonAnchor.addClass("dropdown_button_disabled"),n.dropdownButtonAnchor.removeAttr("href"))}var i=null,e=function(){typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"?Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(f):n(function(){f()});n(document).on("done.mvt",f)},o=function(t){var f=t.data.dropdownData;if(!f.isDropdownOpen){i&&u(i),w(f),Wol.Util.BrowserSpecific.isIE7orLower()&&f.dropdownControl.css("z-index",1),f.dropdownList.addClass("dropdown_open"),r(f,f.selectedIndex);n(document).one("click",function(){u(f)});return f.dropdownTextAnchor.focus(),f.isDropdownOpen=!0,i=f,!1}return!0},u=function(n){n.isDropdownOpen&&(n.dropdownList.removeClass("dropdown_open"),Wol.Util.BrowserSpecific.isIE7orLower()&&n.dropdownControl.css("z-index",0),n.isDropdownOpen=!1,i=null)},s=function(n){n.selectedIndex<n.listItems.length-1&&t(n,n.selectedIndex+1)},h=function(n){n.selectedIndex>0&&t(n,n.selectedIndex-1)},c=function(n){n.focusedIndex<n.listItems.length-1&&r(n,n.focusedIndex+1)},l=function(n){n.focusedIndex>0&&r(n,n.focusedIndex-1)},a=function(n){n.dropdownLink.addClass("dropdown_link_focused")},v=function(n){n.dropdownLink.removeClass("dropdown_link_focused")},y=function(n){var i=n.data.dropdownData,r=!1;if(i.isDropdownOpen)switch(n.which){case 9:case 13:t(i,i.focusedIndex),i.dropdownTextAnchor.click(),r=!0;break;case 27:u(i),r=!0;break;case 38:l(i),r=!0;break;case 40:c(i),r=!0}else if(document.activeElement===i.dropdownTextAnchor[0])switch(n.which){case 38:h(i),r=!0;break;case 40:s(i),r=!0}return!r},t=function(n,t,i){var u,r;if(i||n.dropdownTextAnchor.focus(),n.selectedIndex!==undefined){if(n.selectedIndex===t)return;u=n.listItems[n.selectedIndex],u.removeClass("accentForeground").removeClass("accentBackground")}r=n.listItems[t],r.addClass("accentForeground").addClass("accentBackground"),r.closest("ul").attr("aria-activedescendant",r.attr("id")),n.dropdownTextAnchorSpan.text(r.text()),n.selectedIndex=t,p(n,r)},r=function(n,t){n.focusedIndex!==undefined&&n.listItems[n.focusedIndex].removeClass("dropdown_item_focused_and_selected").removeClass("dropdown_item_focused");var i;i=t===n.selectedIndex?"dropdown_item_focused_and_selected":"dropdown_item_focused",n.listItems[t].addClass(i),n.focusedIndex=t},w=function(t){var o=t.dropdownLink.offset(),u=o.top-n(window).scrollTop(),e=n(window).height()-(u+t.listItemHeight),s=t.selectedIndex*t.listItemHeight,h=(t.listItems.length-t.selectedIndex)*t.listItemHeight,f=(t.listItems.length-1)*t.listItemHeight,r;r=s>u&&f<e?0:h>e&&f<u?f:t.selectedIndex*t.listItemHeight,t.dropdownList.css("top",-r+"px")},b=function(i){i.dropdownLink.click({dropdownData:i},o),i.dropdownTextAnchor.focus(function(){a(i)}),i.dropdownTextAnchor.focusout(function(){v(i)}),n(i.listItems).each(function(n){this.click(function(){t(i,n)}),this.hover(function(){r(i,n)})}),n(document).keydown({dropdownData:i},y)},k=function(t){var i=0,u,r;n(t.listItems).each(function(){var n=this.outerWidth();n>i&&(i=n)}),u=t.dropdownImage.outerWidth(),r=i+u,t.dropdownLink.width(r),t.dropdownList.width(r)},d=function(i){var r=i.find(".dropdown_link"),e=r.children(".dropdown_link_text"),o=e.children("a"),h=o.children("span"),c=r.children(".dropdown_link_image"),l=i.find("a.dropdown_button"),s=i.find(".dropdown_list"),a=s.find("li"),u=[],v,f;a.each(function(){u.push(n(this))}),v=u[0].outerHeight(),f={dropdownControl:i,dropdownLink:r,dropdownText:e,dropdownTextAnchor:o,dropdownTextAnchorSpan:h,dropdownImage:c,dropdownButtonAnchor:l,dropdownList:s,listItems:u,listItemHeight:v},k(f),b(f),t(f,0,!0),i.attr("data-initialized",!0)},f=function(){for(var i=n(".section_section-list-dropdown_script").not("[data-initialized]"),t=i.length-1;t>=0;t--)d(n(i[t]))};return e(),{}}(jQuery),window.Wol||(window.Wol={}),Wol.Social=function(n,t){"use strict";var i={},r=window.matchMedia("screen and (min-width:56.25em)"),f=function(){r.addListener(u)};n(document).ready(function(){u(r)});var u=function(t){t.matches?n("#sc-03 .socialCompAction").insertAfter("#sc-03 .socialCompCaption"):n("#sc-03 .socialCompAction").insertAfter("#sc-03 .socialCompTitle")},e=function(n,i,r){var u,f,o,e;if(n!==t)return window.location===t?void 0:(u=null,f=null,i!==t&&i!==null&&(o=window.location.href,e={},e[i]=o,u=jQuery.param(e)),r!==t&&r!==null&&(u=u!==null?u+"&"+r:r),f=u!==null?n+"?"+u:n)},o=function(r){var f=n(r),c=f.data("action-endpoint-url"),l=f.data("page-url-parameter-name"),a=f.data("query-string"),h=f.data("window-options"),s=f.data("share-target-id"),o=e(c,l,a),u;return o===t?!1:(u=i[s],u===t||u===null||u.closed?(u=h===t||h===null?window.open(o,s):window.open(o,s,h),i[s]=u):u.location=o,Wol.ContentInstrumentation!==t&&Wol.ContentInstrumentation.Logging!==t&&Wol.ContentInstrumentation.Logging.FireClickEvent(null,r,o),u.focus(),!1)};return f(),{SharePage:o}}(jQuery),function(n){"use strict";var r=0;n(function(){i(),typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"&&Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function(){i()});n(document).on("done.mvt",i)});var i=function(){n("div.UnresolvedVideoContainer").each(function(){u(this)})},u=function(t){var i=n(t),u=i.data("video-detection"),l,a;if(!u)throw"The data-video-detection attribute does not contain a valid information to resolve the video player";var s=i.data("show-error-for-mobile"),h=s&&f(),o=e(u,h);o&&(l=c(o.html),i.append(l)),i.removeClass("UnresolvedVideoContainer").addClass("VideoContainerInner"),Wol.Video&&Wol.Video.PlayerBase&&(a=!Wol.Video.PlayerBase.initialize(i[0]),a&&(i.css("width","auto"),i.addClass("NoVideoPlayer"))),Wol.Video&&Wol.Video.Hero&&Wol.Video.Hero.initialize(i[0]),r++},f=function(){var n=window.serverProcessing&&window.serverProcessing.Detection&&window.serverProcessing.Detection.Device;return n==="detphone"||n==="dettablet"},e=function(n,t){for(var i=0,f=n.length;i<f;i++){var r=n[i],u=r.reqType,e=r.reqParam;if(t&&u==="errorfallback"||!t&&o(u,e))return r}return null},o=function(t,i){switch(t){case"html5player":return s(n.parseJSON(i));case"silverlightplayer":return h(i,"4.0.50401.0");case"errorfallback":return!0;default:return!1}},s=function(n){var i,t,r;try{if(navigator.userAgent&&navigator.userAgent.match(/Windows NT 5\.1/i)||(i=document.createElement("video"),!i.canPlayType))return!1;for(t=0;t<n.length;t++)if(r=n[t],i.canPlayType(r))return!0;return!1}catch(u){return!1}},h=function(t,i){try{return n.ajax({url:t,async:!1,cache:!0,dataType:"script"}),Silverlight.isInstalled(i)}catch(r){return!1}},c=function(n){var t=/(data-script-id="|ScriptableName=)(p[0-9a-f]{32})/g;return n.replace(t,"$1$2_"+r)}}(jQuery),function(n){"use strict";n(document).ready(function(){n(".accordion-to-grid-group").each(function(){n(this).data("refObject")||n(this).data("refObject",new Wol.GroupList.Accordion(n(this)))})})}(jQuery),function(n,t,i){"use strict";var o=function(n){this._setInitialAccordionState(n)},r={controlSelector:"accordion-to-grid-group",elementSelector:"accordion-to-grid-item",titleSelector:"accordion-title",selectedElementClass:"accordion-element-selected",contentClass:"group-list-content",KeyCodes:{enter:13,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40}},s=function(n){var i=[],f=this,e=window.matchMedia("screen and (min-width:47.5em)");n.find("."+r.elementSelector).each(function(){var n=t(this),e=n.find("."+r.titleSelector),o=n.find("."+r.contentClass),u=new Wol.GroupList.GroupItem.Accordion(n,e,o);n.hasClass(r.selectedElementClass)&&(f._selectedElement=u),i.push(u),u.$root.keydown(function(n){c.call(u,n,i,f)})}),e.addListener(function(n){u(n,i)}),u(e,i),this._attachEvents(i)},h=function(n){for(var t=0;t<n.length;t++)n[t].$title.click(f.bind(this,n[t],n,!0))},u=function(n,u){var o,f;if(n.matches){for(f=0;f<u.length;f++)u[f].$root.removeAttr("role"),u[f].$title.removeAttr("aria-selected").removeAttr("tabindex");t(".FooterBigRegion").removeAttr("role"),t("#bodyBigFooter").removeAttr("role")}else{for(o=i,f=0;f<u.length;f++)u[f].$root.attr("role","tabpanel"),u[f].$root.hasClass(r.selectedElementClass)?(o=u[f],u[f].$title.attr("aria-selected","true")):u[f].$title.attr("aria-selected","false");e(u,o),t(".FooterBigRegion").attr("role","tabpanel"),t("#bodyBigFooter").attr("role","tablist")}},f=function(n,t,u){n.$root.hasClass(r.selectedElementClass)?(n.collapse(),n.$title.attr("aria-selected","false"),this._selectedElement=i):(n.expand(this._selectedElement),n.$title.attr("aria-selected","true"),this._selectedElement=n),u&&n.$title.blur(),e(t,this._selectedElement)},e=function(n,t){for(var i=0;i<n.length;i++)n[i].$title.attr("tabindex","-1");t?t.$title.attr("tabindex","0"):n[0].$title.attr("tabindex","0")},c=function(n,i,u){var o,s,e;switch(n.which){case r.KeyCodes.leftArrow:case r.KeyCodes.upArrow:for(o=a.call(this,i),e=0;e<i.length;e++)i[e].$title.attr("tabindex","-1");o.$title.attr("tabindex","0"),o.$title.focus(),n.preventDefault();break;case r.KeyCodes.rightArrow:case r.KeyCodes.downArrow:for(s=l.call(this,i),e=0;e<i.length;e++)i[e].$title.attr("tabindex","-1");s.$title.attr("tabindex","0"),s.$title.focus(),n.preventDefault();break;case r.KeyCodes.enter:if(!t(n.target).hasClass("accordion-title"))break;f.call(u,this,i,!1),n.preventDefault()}},l=function(n){for(var t=0;t<n.length;t++)if(n[t]===this)break;return n[(t+1)%n.length]},a=function(n){for(var t=0;t<n.length;t++)if(n[t]===this)break;return t===0?n[n.length-1]:n[t-1]};n.Namespace.define("Wol.GroupList",{Accordion:n.Class.define(o,{_setInitialAccordionState:s,_attachEvents:h})})}(WinJS,jQuery),function(n){"use strict";var u=function(n,t,i){this.$root=n,this.$title=t,this.$content=i},r={selectedElementClass:"accordion-element-selected",animationDuration:700},f=function(n){n&&(n.$title.attr("aria-selected","false"),n.collapse()),this.$content.slideDown(r.animationDuration,"fastToSlow"),this.$root.addClass(r.selectedElementClass)},e=function(){var n=this;n.$content.slideUp(r.animationDuration,"fastToSlow",function(){n.$root.removeClass(r.selectedElementClass)})};n.Namespace.define("Wol.GroupList.GroupItem",{Accordion:n.Class.define(u,{expand:f,collapse:e})})}(WinJS,jQuery),function(n,t){"use strict";var e=".iListShimCol",o=".iListShimPool",s=".iListInnerList",u=-1,h=[];t(function(){f();t(document).on("done.mvt",f)});var f=function(){Modernizr.csscolumns||t("div.iListFlow").not("[data-initialized]").each(function(){h.push(new Wol.ItemList(this))})},c=function(n){var i;if(this.$itemListElement=t(n),this.preferredColumns=a(this.$itemListElement),this.currentColumns=1,!(this.preferredColumns<2)){if(v(this.$itemListElement),i=this,Modernizr.mq("only all"))try{var f=window.matchMedia("screen and (max-width:19.99375em)"),e=window.matchMedia("screen and (min-width:31.875em) and (max-width:47.475em)"),o=window.matchMedia("screen and (min-width:47.5em) and (max-width:56.225em)"),s=window.matchMedia("screen and (min-width:56.25em)");f.matches?r(i,1):e.matches?r(i,2):o.matches?r(i,3):s.matches&&r(i,4),f.addListener(function(){r(i,1)}),e.addListener(function(){r(i,2)}),this.preferredColumns>2&&o.addListener(function(){r(i,3)}),this.preferredColumns>3&&s.addListener(function(){r(i,4)})}catch(h){r(i,u)}else r(i,u);t(this).attr("data-initialized",!0)}},l=function(n,t){n.removeClass("iListShim2CC"),n.removeClass("iListShim3CC"),n.removeClass("iListShim4CC");switch(t){case 2:n.addClass("iListShim2CC");break;case 3:n.addClass("iListShim3CC");break;case 4:n.addClass("iListShim4CC")}},a=function(n){return n.hasClass("iList2Col")?2:n.hasClass("iList3Col")?3:n.hasClass("iList4Col")?4:1},v=function(n){var i=n.children(s),u,r,t;i.addClass("iListShimCol"),i.addClass("iListShimC1"),u="<"+i[0].tagName+' class="',n.append(u+'iListShimPool"/>'),r=u+"iListInnerList iListShimCol ",t=r+'iListShimC2"/>',n.append(t),t=r+'iListShimC3"/>',n.append(t),t=r+'iListShimC4"/>',n.append(t)},r=function(n,i){var r,h=n.$itemListElement,y,c,f,k;if(r=u===i?n.preferredColumns:Math.min(i,n.preferredColumns),n.currentColumns!=r){l(h,r),y=h.children(e),c=h.children(o),y.each(function(){var n=t(this);n.children().each(function(){var n=t(this),i=n.detach();c.append(i)})});for(var p=c.children().length,w=Math.floor(p/r)-1,b=p%r,a=[],v=0,s=w,f=0;f<r;f++)b>0&&(s++,b--),a[f]=c.children().slice(v,s+1),v=s+1,s=v+w;f=0,k=1,y.each(function(){var n=t(this);f<r&&(n.css("counter-reset","item "+k),k+=a[f].length,a[f].detach().appendTo(n)),f++}),n.currentColumns=r}};n.Namespace.define("Wol",{ItemList:n.Class.define(c,{},{})})}(WinJS,jQuery),function(n,t){"use strict";var r=window.matchMedia("only all").matches,u=window.matchMedia("screen and (min-width: 47.5em)");t(function(){f();t(document).on("done.mvt",f)});var f=function(){t(".hero-base").each(function(){var n=t(this);n.data("hero-object")||n.data("hero-object",new Wol.Hero(n))})},e=function(n){this.$rootElement=n,this.$heroContainer=n.find(".hero-container").first(),this.$minHeightCell=this.$heroContainer.find(".hero-min-height-cell > div"),this.$bottomStackingCell=n.find(".hero-bottom-stk-cell"),this.$topStackingCell=n.find(".hero-top-stk-cell"),this.isStackingOnMiniTablet=!n.hasClass("hero-no-stack"),this.minHeightPhone=this.$heroContainer.data("min-height-phone"),this.minHeightDesktop=this.$heroContainer.data("min-height-desktop"),this.resizeSlope=(this.minHeightDesktop-this.minHeightPhone)/680,this.resizeOffset=this.minHeightDesktop-this.resizeSlope*1e3,this._refreshMinHeight(),this._verticalAlignFarCellImage(),this.$trapezoidContent=n.find(".hero-tr-content"),this._verticalAlignTrapezoidContent(),r&&t(window).smartresize(o.bind(this))},o=function(){this._refreshMinHeight(),this._verticalAlignFarCellImage(),this._verticalAlignTrapezoidContent()},s=function(){var n;r?(n=this.resizeSlope*t(window).width()+this.resizeOffset,n=Math.max(Math.min(n,this.minHeightDesktop),this.minHeightPhone),n=n+"px"):n=this.minHeightDesktop+"px",!r||u.matches?(this.$minHeightCell.css("min-height",n),this.isStackingOnMiniTablet&&(this.$topStackingCell.css("height",""),this.$heroContainer.css("background-size",""),this.$bottomStackingCell.css("margin-top",""))):this.isStackingOnMiniTablet&&(this.$topStackingCell.css("height",n),this.$heroContainer.css("background-size","auto "+n),this.$bottomStackingCell.css("margin-top",n))},h=function(){var t=this.$topStackingCell.find(".hero-dock-elm"),i=t.height(),o=t.width(),a=o/i,n=t.find("img").first(),f,e;if(n.length)if(!r||u.matches)n.css({position:"",top:""});else{f=new Image,f.src=n.attr("src");var s=f.height,c=f.width,l=c/s,h=Math.min(s,o/l);i>h?(e=(i-h)/2,e=Math.max(0,e),n.css("position","relative"),n.css("top",e+"px")):n.css({position:"",top:""})}},c=function(){this.$trapezoidContent.each(function(){var n=t(this);if(!r||u.matches){n.css("padding-top","0");var f=n.parent().outerHeight(),e=n.height(),i=(f-e-20)/2;i=Math.max(0,i),n.css("top",i+"px")}else n.css({"padding-top":"",top:""})})};n.Namespace.define("Wol",{Hero:n.Class.define(e,{_refreshMinHeight:s,_verticalAlignFarCellImage:h,_verticalAlignTrapezoidContent:c},{})})}(WinJS,jQuery),function(n,t){"use strict";var r={phone:window.matchMedia("screen and (max-width: "+509.9/16+"em)"),"mini-tablet":window.matchMedia("screen and (max-width: "+759.9/16+"em)"),tablet:window.matchMedia("screen and (max-width: "+899.9/16+"em)"),desktop:window.matchMedia("all")},f=window.matchMedia("only all").matches;t(function(){u(!1);t(document).on("done.mvt",u.bind(this,!0))});var u=function(n){var i;i=n?t(".res-bg-img"):t(":not(.mvt-factor-container) .res-bg-img"),i.each(function(){var n=t(this);n.data("background-image-set-object")||n.data("background-image-set-object",new Wol.Responsive.BgImageSet(n))})},e=function(n){var i,u,e,s,h,c,t;if(this.$rootElement=n,i=n.data("background-set"),i&&i.length>0)if(f){u=[];for(e in r)if(r.hasOwnProperty(e))for(t=0;t<i.length;t++)if(i[t].breakpoint===e){s=r[e],u.push({image:i[t],match:s}),i.splice(t,1);break}for(this.prioritizedImageSet=u,this._refreshImage(),h=o.bind(this),t=0,c=this.prioritizedImageSet.length;t<c;t++)u[t].match.addListener(h)}else for(t=0;t<i.length;t++)if(i[t].breakpoint==="desktop"){this._applyImage(i[t]);break}},o=function(){this._refreshImage()},s=function(){for(var t=!1,i,n=0,r=this.prioritizedImageSet.length;n<r;n++)if(i=this.prioritizedImageSet[n],i.match.matches){this._applyImage(i.image),t=!0;break}t||this._applyImage(null)},h=function(n){n?this.$rootElement.css("background-image","url('"+n.url+"')"):this.$rootElement.css("background-image","")};n.Namespace.define("Wol.Responsive",{BgImageSet:n.Class.define(e,{_refreshImage:s,_applyImage:h},{})})}(WinJS,jQuery),function(n,t,i){"use strict";var r={None:0,Immediate:1,TopVisible:2,BottomVisible:3},u=function(){},f=function(){throw"Not implemented";},e=function(){throw"Not implemented";},o=function(){throw"Not implemented";},s=function(){throw"Not implemented";},h=function(){throw"Not implemented";},c=function(){throw"Not implemented";},l=function(){throw"Not implemented";},a=function(){if(this.$rootElement.isVisible()&&!Wol.Header.isCompactNavShown()){if(this._autoStart===r.None)return;if(this._autoStart===r.Immediate)this.play();else{var i=t(window).scrollTop(),f=i+t(window).height(),u=this.$rootElement.offset().top,n;this._autoStart===r.TopVisible?n=u:this._autoStart===r.BottomVisible&&(n=u+this.$rootElement.height()),n>i&&n<f&&(this.play(),this._deactivateAutoPlay())}}},v=function(){this._autoStart=r.None,this._autoStartScrollEvent&&(t(window).off("scroll",this._autoStartScrollEvent),this._autoStartScrollEvent=i)},y=function(){this._activateAutoPlay()},p=function(){this._playOnShown?(this.play(),this._playOnShown=!1):this._activateAutoPlay()},w=function(){this._activateAutoPlay()},b=function(){this._deactivateAutoPlay()},k=function(){this._playOnShown=!this.paused(),this.pause()},d=function(n){this.dispatchEvent("shown",n)},g=function(n){var i=null,u,f;if(Wol.Video.MetroPlayer.isCompatible(n)?i=new Wol.Video.MetroPlayer(n):Wol.Video.SilverlightPlayer.isCompatible(n)&&(i=new Wol.Video.SilverlightPlayer(n)),i){if(new Wol.Video.BI(i),i._autoStart=i.$rootElement.hasClass("AutoStartImmediate")?r.Immediate:i.$rootElement.hasClass("AutoStartWhenTopVisible")?r.TopVisible:i.$rootElement.hasClass("AutoStartWhenBottomVisible")?r.BottomVisible:r.None,i._autoStart===r.TopVisible||i._autoStart===r.BottomVisible){i._autoStartScrollEvent=w.bind(i);t(window).on("scroll",i._autoStartScrollEvent)}i.addEventListener("loadedmetadata",y.bind(i),!1),i.addEventListener("shown",p.bind(i),!1),i.addEventListener("play",b.bind(i),!1),u=t(n),Wol.Util.Visibility.initHideListener(u,k.bind(i)),Wol.Util.Visibility.initShowListener(u,d.bind(i)),f=i.$rootElement.parent(),f.data("wolVideoPlayer",i),f.addClass("wolVideoPlayer")}return i},nt=function(n){var i=t(n).find(".wolVideoPlayer").first().data("wolVideoPlayer");return i&&i instanceof Wol.Video.PlayerBase?i:null};n.Namespace.define("Wol.Video",{PlayerBase:n.Class.define(u,{play:f,pause:e,currentTime:o,duration:s,enableTabbing:h,buffered:c,fullScreen:l,_activateAutoPlay:a,_deactivateAutoPlay:v},{initialize:g,getVideoPlayer:nt})}),n.Class.mix(Wol.Video.PlayerBase,n.Utilities.createEventProperties("play","pause","timeupdate","ended","progress","loadedmetadata","fullscreenchange","closedcaptionchange","cuechange","shown")),n.Class.mix(Wol.Video.PlayerBase,n.Utilities.eventMixin)}(WinJS,jQuery),function(n,t,i){"use strict";var e=function(n){var i=t(n);if(i.hasClass("mpContainer"))this.$rootElement=i;else if(this.$rootElement=i.find("div.mpContainer").first(),!this.$rootElement.length)throw"MetroPlayer: Unable to initialize video";this.videoTechnology="HTML5",this.hasError=!1,o.call(this)},u,o=function(){this.isInitialized||(this.videoElementObj=new Wol.Video.MetroPlayer.VideoElement(this),u=Wol.Video.MetroPlayer.Utils.fullScreen.eventName,u&&document.addEventListener(u,f.bind(this)),this.$rootElement.bind("selectstart",function(n){n.preventDefault()}),t(window).smartresize(l.bind(this)),this.addEventListener("ended",a.bind(this),!1),this.addEventListener("error",v.bind(this),!1),this.addEventListener("shown",y.bind(this),!1),this.components={controlBar:new Wol.Video.MetroPlayer.ControlBar(this),keyboardAccessibility:new Wol.Video.MetroPlayer.KeyboardAccessibility(this),poster:new Wol.Video.MetroPlayer.Poster(this),track:new Wol.Video.MetroPlayer.TextTrack(this),closedCaptionOverlay:new Wol.Video.MetroPlayer.ClosedCaptionOverlay(this)},this.isChromeless=!this.components.controlBar.$rootElement.length,this.isInitialized=!0,this.$rootElement.hasClass("mpCaptionAutoOn")&&this.closedCaption(!0))},r=function(n){return function(){var t=Array.prototype.slice.call(arguments,0);return this.videoElementObj[n].apply(this.videoElementObj,t)}},s=function(n){var t=Wol.Video.MetroPlayer.Utils.fullScreen(this.$rootElement.get(0),n);return n===i||u||f.call(this,n),t},h=function(n){var t=this.components.track;return t?t.enable(n):!1},c=function(n){n?this.$rootElement.find("button").removeAttr("tabIndex"):this.$rootElement.find("button").attr("tabIndex","-1").blur()},f=function(n){this.dispatchEvent("fullscreenchange",n),this.dispatchEvent("resize",n)},l=function(n){this.dispatchEvent("resize",n)},a=function(){this.fullScreen(!1)},v=function(){this.fullScreen(!1)},y=function(n){this.dispatchEvent("resize",n)},p=function(n){var i=t(n);return i.hasClass("mpContainer")||!!t(n).find(".mpContainer").length};n.Namespace.define("Wol.Video",{MetroPlayer:n.Class.derive(Wol.Video.PlayerBase,e,{play:r("play"),pause:r("pause"),currentTime:r("currentTime"),duration:r("duration"),buffered:r("buffered"),ended:r("ended"),paused:r("paused"),volume:r("volume"),muted:r("muted"),mediaUrl:r("mediaUrl"),fullScreen:s,closedCaption:h,enableTabbing:c},{isCompatible:p})})}(WinJS,jQuery),function(n){"use strict";var r=function(){},u=function(){},f=function(){};n.Namespace.define("Wol.Video.MetroPlayer",{ControlBase:n.Class.define(r,{show:u,hide:f},{})})}(WinJS,jQuery),function(n,t,i){"use strict";var r,f=function(){var n;return document.exitFullscreen?(n=function(n,t){return t===i?document.fullscreenElement===n:(t?n.requestFullscreen():document.exitFullscreen(),t)},n.eventName="fullscreenchange"):document.webkitCancelFullScreen?(n=function(n,t){return t===i?document.webkitFullscreenElement===n:(t?(n.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT),document.webkitCurrentFullScreenElement!==n&&n.webkitRequestFullScreen()):document.webkitCancelFullScreen(),t)},n.eventName="webkitfullscreenchange"):document.msExitFullscreen?(n=function(n,t){return t===i?document.msFullscreenElement===n:(t?n.msRequestFullscreen():document.msExitFullscreen(),t)},n.eventName="MSFullscreenChange"):document.mozCancelFullScreen?(n=function(n,t){return t===i?document.mozFullScreenElement===n:(t?n.mozRequestFullScreen():document.mozCancelFullScreen(),t)},n.eventName="mozfullscreenchange"):(n=function(n,u){var f=t(n);return u===i?f.hasClass("mpFullBrowserMode"):(u?(r=t(window).scrollTop(),f.addClass("mpFullBrowserMode")):(f.removeClass("mpFullBrowserMode"),r&&t(window).scrollTop(r)),u)},n.eventName=null),n}(),u=!!navigator.userAgent.match(/Trident/i),e=function(n){var t=n.offset().left;return u&&(t-=window.pageXOffset-document.documentElement.scrollLeft),t},o=function(n){var t=n.offset().top;return u&&(t-=window.pageYOffset-document.documentElement.scrollTop),t};n.Namespace.define("Wol.Video.MetroPlayer.Utils",{fullScreen:f,getTotalOffsetLeft:e,getTotalOffsetTop:o})}(WinJS,jQuery),function(n,t,i){"use strict";var u=function(n){this.playerObj=n,this.videoElement=n.$rootElement.find("video").get(0),this.videoElement.controls=!1,this.videoElement.addEventListener("play",r.bind(this,"play"),!1),this.videoElement.addEventListener("pause",r.bind(this,"pause"),!1),this.videoElement.addEventListener("timeupdate",r.bind(this,"timeupdate"),!1),this.videoElement.addEventListener("ended",r.bind(this,"ended"),!1),this.videoElement.addEventListener("progress",r.bind(this,"progress"),!1),this.videoElement.addEventListener("loadedmetadata",r.bind(this,"loadedmetadata"),!1),this.videoElement.addEventListener("volumechange",r.bind(this,"volumechange"),!1),this.videoElement.addEventListener("error",f.bind(this),!1),this.videoElement.addEventListener("ended",w.bind(this),!1),this.videoElement.addEventListener("mousedown",b.bind(this),!1),this.videoElement.addEventListener("dblclick",k.bind(this),!1),this.videoElement.addEventListener("contextmenu",d.bind(this),!1)},r=function(n,t){this.playerObj.dispatchEvent(n,t)},f=function(n){n&&n.target&&n.target.error&&(n.code=n.target.error.code),this.playerObj.hasError=!0,this.playerObj.dispatchEvent("error",n)},e=function(){return this.videoElement.play()},o=function(){this.videoElement.pause()},s=function(n){return n===i?this.videoElement.currentTime:this.videoElement.currentTime=n},h=function(){return this.videoElement.duration},c=function(){return this.videoElement.buffered},l=function(){return!!this.videoElement.ended},a=function(){return!!this.videoElement.paused},v=function(n){return n===i?this.videoElement.volume:this.videoElement.volume=n},y=function(n){return n===i?this.videoElement.muted:this.videoElement.muted=n},p=function(){return this.videoElement.currentSrc},w=function(){this.pause(),this.currentTime(0)},b=function(n){n.which===1&&(this.videoElement.paused?this.videoElement.play():this.videoElement.pause(),n.preventDefault())},k=function(n){n.which===1&&(this.playerObj.isChromeless||(this.playerObj.fullScreen()?this.playerObj.fullScreen(!1):this.playerObj.fullScreen(!0)),n.preventDefault())},d=function(n){n.preventDefault()};n.Namespace.define("Wol.Video.MetroPlayer",{VideoElement:n.Class.define(u,{play:e,pause:o,currentTime:s,duration:h,buffered:c,ended:l,paused:a,volume:v,muted:y,mediaUrl:p},{})})}(WinJS,jQuery),function(n,t){"use strict";var f=function(n){if(this.playerObj=n,this.$rootElement=n.$rootElement.find("div.mpControlBar").first(),!this.$rootElement.length)return null;this.$controlBarNear=this.$rootElement.find("div.mpControlBarNear").first(),this.$controlBarFill=this.$rootElement.find("div.mpControlBarFill").first(),this.$controlBarFar=this.$rootElement.find("div.mpControlBarFar").first(),this.$controlBarError=this.$rootElement.find("div.mpControlBarError").first(),this.buttons={playPauseButton:new Wol.Video.MetroPlayer.PlayPauseButton(n,this),timeline:new Wol.Video.MetroPlayer.Timeline(n,this),timeBox:new Wol.Video.MetroPlayer.TimeBox(n,this),closedCaptionButton:new Wol.Video.MetroPlayer.ClosedCaptionButton(n,this),volumeButton:new Wol.Video.MetroPlayer.VolumeButton(n,this),fullScreenButton:new Wol.Video.MetroPlayer.FullScreenButton(n,this)},this._resize(),n.addEventListener("loadedmetadata",h.bind(this),!1),n.addEventListener("error",s.bind(this),!1),n.addEventListener("resize",o.bind(this),!1),this._isVisible=!1,this._isMouseDown=!1,n.$rootElement.mousemove(c.bind(this)),n.$rootElement.mousedown(l.bind(this)),n.$rootElement.keydown(a.bind(this)),n.$rootElement.keyup(v.bind(this)),this.$rootElement.mousedown(p.bind(this)),t(document).mouseup(w.bind(this)),this._touchId=null,Modernizr.touch&&(n.$rootElement[0].addEventListener("touchstart",y.bind(this),!1),this.$rootElement[0].addEventListener("touchstart",b.bind(this),!1),this.$rootElement[0].addEventListener("touchend",r.bind(this),!1),this.$rootElement[0].addEventListener("touchcancel",r.bind(this),!1))},e=function(){var n=this.$rootElement.width();n>=613?(this.buttons.timeline.show(),this.buttons.timeBox.show()):n>=288?(this.buttons.timeline.show(),this.buttons.timeBox.hide()):(this.buttons.timeline.hide(),this.buttons.timeBox.hide());var t=this.$controlBarNear.outerWidth(!0),i=this.$controlBarFar.outerWidth(!0),r=n-t-i-16;this.$controlBarFill.width(r)},o=function(){this._resize()},s=function(){this.buttons.playPauseButton.enable(!1),this.$controlBarFill.hide(),this.$controlBarFar.hide(),this.$controlBarError.show(),this._showControlBar()},h=function(){this._resize()},c=function(n){(n.pageX!==this._lastMousePageX||n.pageY!==this._lastMousePageY)&&(this._lastMousePageX=n.pageX,this._lastMousePageY=n.pageY,setTimeout(u.bind(this),100))},l=function(n){this._isVisible||n.preventDefault(),this._showControlBar()},a=function(){this._showControlBar()},v=function(){this._showControlBar()},y=function(){this._showControlBar()},p=function(n){n.which===1&&(this._isMouseDown=!0)},w=function(){this._isMouseDown&&(this._isMouseDown=!1,this._showControlBar())},b=function(n){if(this._touchId===null){var t=n.changedTouches[0];this._touchId=t.identifier,this._showControlBar()}},r=function(n){var i,t;if(this._touchId!==null)for(i=n.changedTouches,t=0;t<i.length;t++)if(i[t].identifier===this._touchId){this._touchId=null,this._showControlBar();break}},u=function(){this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null),this.$rootElement.stop(),this.$rootElement.fadeTo(0,1),this.$rootElement.addClass("mpControlBarVisible"),this.$rootElement.attr("aria-hidden","false"),this._isVisible=!0,this._isMouseDown||this._touchId!==null||this.playerObj.hasError||(this.hideTimer=setTimeout(k.bind(this),2e3))},k=function(){this.$rootElement.fadeTo(1e3,0,d.bind(this))},d=function(){this.$rootElement.removeClass("mpControlBarVisible"),this.$rootElement.attr("aria-hidden","true"),this._isVisible=!1};n.Namespace.define("Wol.Video.MetroPlayer",{ControlBar:n.Class.define(f,{_resize:e,_showControlBar:u},{})})}(WinJS,jQuery),function(n){"use strict";var u=function(n,t){this.playerObj=n,this.controlBarObj=t,this.$playButtonElement=t.$rootElement.find("button.mpBtnPlay").first(),this.$pauseButtonElement=t.$rootElement.find("button.mpBtnPause").first(),n.addEventListener("play",r.bind(this,!1),!1),n.addEventListener("pause",r.bind(this,!0),!1),n.addEventListener("ended",f.bind(this),!1),this.$playButtonElement.click(e.bind(this)),this.$pauseButtonElement.click(o.bind(this))},r=function(n){this._setState(n)},f=function(){this._setState(!0)},e=function(){this.playerObj.ended()&&this.playerObj.currentTime(0),this.playerObj.play()},o=function(){this.playerObj.pause()},s=function(n){this.$playButtonElement[0].disabled=!n,this.$pauseButtonElement[0].disabled=!n,n||this._setState(!0)},h=function(n){var t,i;n?(t=this.$pauseButtonElement.is(":focus"),this.$playButtonElement.show(),this.$pauseButtonElement.hide(),t&&this.$playButtonElement.focus()):(i=this.$playButtonElement.is(":focus"),this.$playButtonElement.hide(),this.$pauseButtonElement.show(),i&&this.$pauseButtonElement.focus())};n.Namespace.define("Wol.Video.MetroPlayer",{PlayPauseButton:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,u,{enable:s,_setState:h},{})})}(WinJS,jQuery),function(n,t){"use strict";var u=function(n,i){this.playerObj=n,this.controlBarObj=i,this.$timelineButton=i.$rootElement.find("button.mpTimeline").first(),this.$loadedBar=i.$rootElement.find("div.mpTimelineLoaded").first(),this.$watchedBar=i.$rootElement.find("div.mpTimelineWatched").first(),this.$marker=i.$rootElement.find("div.mpTimelineMarker").first(),n.addEventListener("timeupdate",a.bind(this),!1),n.addEventListener("progress",v.bind(this),!1),this.$timelineButton.mousedown(f.bind(this));var u=t(document);u.mouseup(o.bind(this)),this.document_OnMouseMove=e.bind(this),this._touchId=null,Modernizr.touch&&(this.$timelineButton[0].addEventListener("touchstart",s.bind(this),!1),this.$timelineButton[0].addEventListener("touchmove",h.bind(this),!1),this.$timelineButton[0].addEventListener("touchend",r.bind(this),!1),this.$timelineButton[0].addEventListener("touchcancel",r.bind(this),!1))},f=function(n){n.which===1&&(this._mouseLeftButtonDown=!0,this._attachMouseMoveEvent(),this._respondToMouse(n))},e=function(n){this._mouseLeftButtonDown&&this._respondToMouse(n)},o=function(){this._detachMouseMoveEvent(),this._mouseLeftButtonDown=!1},s=function(n){if(this._touchId===null){var t=n.changedTouches[0];this._touchId=t.identifier,this._respondToMouse(t)}n.preventDefault()},h=function(n){var i,t,r;if(this._touchId!==null)for(i=n.changedTouches,t=0;t<i.length;t++)if(r=i[t],r.identifier===this._touchId){this._respondToMouse(r);break}n.preventDefault()},r=function(n){var i,t;if(this._touchId!==null)for(i=n.changedTouches,t=0;t<i.length;t++)if(i[t].identifier===this._touchId){this._touchId=null;break}n.preventDefault()},c=Wol.Video.MetroPlayer.Utils.getTotalOffsetLeft,l=function(n){var t=(n.pageX-c(this.$timelineButton)-6)/(this.$timelineButton.width()-13);t<0?t=0:t>1&&(t=1),this._setWatchedPosition(t,!0),this._setCurrentTime(t),this._suppressProgressUpdateByPlayer()},a=function(){if(!this._skipUpdate){var t=this.playerObj.currentTime(),i=this.playerObj.duration(),r=t/i;this._setWatchedPosition(r)}},v=function(){var t=this.playerObj.buffered(),i=0,r,u;t.length>0&&(r=this.playerObj.duration(),u=t.end(0),i=u/r),this._setLoadedPosition(i)},y=function(){this.$timelineButton.hide()},p=function(){this.$timelineButton.show()},w=function(n){var t=n*100;this.$watchedBar.width(t+"%"),this.$marker.css("left",t+"%")},b=function(n){var t=Math.ceil(n*100);this.$loadedBar.width(t+"%")},k=function(){this._skipUpdate=!0,clearTimeout(this._skipUpdateTimer),this._skipUpdateTimer=setTimeout(d.bind(this),1e3)},d=function(){this._skipUpdate=!1},g=function(n){var i=this.playerObj.duration(),t=n*i;t<0&&(t=0),this.playerObj.currentTime(t)},nt=function(){t(document).bind("mousemove",this.document_OnMouseMove)},tt=function(){t(document).unbind("mousemove",this.document_OnMouseMove)};n.Namespace.define("Wol.Video.MetroPlayer",{Timeline:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,u,{hide:y,show:p,_setWatchedPosition:w,_setLoadedPosition:b,_respondToMouse:l,_setCurrentTime:g,_suppressProgressUpdateByPlayer:k,_attachMouseMoveEvent:nt,_detachMouseMoveEvent:tt},{})})}(WinJS,jQuery),function(n){"use strict";var u=function(n,t){this.playerObj=n,this.controlBarObj=t,this.$timeBoxElement=t.$rootElement.find("div.mpTimeBox").first(),this.$timeElapsedElement=t.$rootElement.find("span.mpTimeElapsed").first(),this.$timeRemainingElement=t.$rootElement.find("span.mpTimeRemaining").first(),n.addEventListener("timeupdate",f.bind(this),!1),n.addEventListener("loadedmetadata",e.bind(this),!1)},f=function(){this._refreshTime()},e=function(){this._refreshTime()},o=function(){this.$timeBoxElement.hide()},s=function(){this.$timeBoxElement.show()},h=function(){var n=Math.round(this.playerObj.currentTime()||0),t,i;n!==this._prevTimeElapsed&&(this._prevTimeElapsed=n,t=Math.round(this.playerObj.duration()||0),i=t-n,this.$timeElapsedElement.text(r(n)),this.$timeRemainingElement.text(r(i)))},r=function(n){var t,i;n<0&&(n=0),t=n%60,n=(n-t)/60,i=n%60,n=(n-i)/60;var r=n,u=i<10?"0"+i:""+i,f=t<10?"0"+t:""+t;return r+":"+u+":"+f};n.Namespace.define("Wol.Video.MetroPlayer",{TimeBox:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,u,{show:s,hide:o,_refreshTime:h},{})})}(WinJS,jQuery),function(n){"use strict";var r=function(n,t){if(this.playerObj=n,this.controlBarObj=t,this.$closedCaptionButton=t.$rootElement.find("button.mpBtnCaption").first(),!this.$closedCaptionButton.length)return null;this.$closedCaptionButton.click(u.bind(this))},u=function(){this.playerObj.closedCaption()?this.playerObj.closedCaption(!1):this.playerObj.closedCaption(!0)};n.Namespace.define("Wol.Video.MetroPlayer",{ClosedCaptionButton:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,r,{},{})})}(WinJS,jQuery),function(n,t){"use strict";var e=function(n,i){if(this.playerObj=n,this.controlBarObj=i,this.$volumeButton=i.$rootElement.find("button.mpBtnVolume").first(),this.$muteButton=i.$rootElement.find("button.mpBtnMute").first(),this.$volumeSliderContainer=i.$rootElement.find("div.mpVolSliderContainer").first(),this.$volumeSliderButton=i.$rootElement.find("button.mpVolSlider").first(),this.$volumeSliderBar=this.$volumeSliderButton.find("div.mpVolFilledBar").first(),this.$volumeSliderMarker=this.$volumeSliderButton.find("div.mpVolMarker").first(),!this._isVolumeControlSupported())return this.$volumeButton.hide(),null;this._isMouseDown=!1,this._isSliderVisible=!1,this._suppressVolumeChangeEvent=!0,this._defaultVolumeTitle=this.$volumeButton.data("default-title"),this._popUpVolumeTitle=this.$volumeButton.data("pop-up-title"),this.$volumeButton.click(o.bind(this)),this.$muteButton.click(s.bind(this)),this.$volumeSliderButton.mousedown(h.bind(this)),t(document).mouseup(l.bind(this)),this._document_OnMouseMove=c.bind(this),this._touchId=null,Modernizr.touch&&(this.$volumeSliderButton[0].addEventListener("touchstart",a.bind(this),!1),this.$volumeSliderButton[0].addEventListener("touchmove",v.bind(this),!1),this.$volumeSliderButton[0].addEventListener("touchend",u.bind(this),!1),this.$volumeSliderButton[0].addEventListener("touchcancel",u.bind(this),!1)),this.playerObj.addEventListener("volumechange",p.bind(this),!1),t(window).bind("load",y.bind(this)),this.playerObj.addEventListener("fullscreenchange",r.bind(this),!1),t(window).smartresize(r.bind(this)),r.call(this)},r=function(){var n=this._setSliderHeight();!n&&this._isSliderVisible&&this._fadeSlider(10)},o=function(){var t=this._setSliderHeight();(!t||this._isSliderVisible)&&this.playerObj.muted(!0),this._showSlider()},s=function(){this.playerObj.muted(!1)},h=function(n){n.which===1&&(this._isMouseDown=!0,this._attachMouseMoveEvent(),this.playerObj.muted(!1),this._respondToMouse(n))},c=function(n){this._isMouseDown&&this._respondToMouse(n)},l=function(){this._detachMouseMoveEvent(),this._isMouseDown&&(this._isMouseDown=!1,this._showSlider())},a=function(n){if(this._touchId===null){var t=n.changedTouches[0];this._touchId=t.identifier,this.playerObj.muted(!1),this._respondToMouse(t)}n.preventDefault()},v=function(n){var i,t,r;if(this._touchId!==null)for(i=n.changedTouches,t=0;t<i.length;t++)if(r=i[t],r.identifier===this._touchId){this._respondToMouse(r);break}n.preventDefault()},u=function(n){var i,t;if(this._touchId!==null)for(i=n.changedTouches,t=0;t<i.length;t++)if(i[t].identifier===this._touchId){this._touchId=null,this._showSlider();break}n.preventDefault()},y=function(){setTimeout(b.bind(this),500)},p=function(){this._setMutedButtonState(this.playerObj.muted()),this._suppressVolumeChangeEvent||this._showSlider()},w=function(){var n=this.playerObj.volume();return n===1&&(this.playerObj.volume(.999),this.playerObj.volume()===1)?!1:!0},b=function(){this._suppressVolumeChangeEvent=!1},k=Wol.Video.MetroPlayer.Utils.getTotalOffsetTop,d=function(n){var i=k(this.$volumeSliderButton),t=(i+this.$volumeSliderButton.height()-n.pageY-6)/(this.$volumeSliderButton.height()-13);t<0?t=0:t>1&&(t=1),this._setVolumeButtonState(t),this.playerObj.volume(t)},g=function(n){var t;t=n<0?0:n>1?100:Math.round(n*1e3)/10,t=t+"%",this.$volumeSliderBar.height(t),this.$volumeSliderMarker.css("bottom",t)},nt=function(n){var t,i,r;n?(t=this.$volumeButton,i=this.$muteButton,this._setVolumeButtonState(0)):(t=this.$muteButton,i=this.$volumeButton,this._setVolumeButtonState(this.playerObj.volume())),r=t.is(":focus"),t.hide(),i.show(),r&&i.focus()},tt=function(){var n=this.playerObj.$rootElement.outerHeight(),t=this.controlBarObj.$rootElement.outerHeight(),i=n/2-t,r;return this.$volumeSliderContainer.css("height",i),r=this.$volumeSliderContainer.outerHeight(),r+t<=n},it=function(){this._setSliderHeight()&&(this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null),this.$volumeSliderContainer.stop(),this.$volumeSliderContainer.show(),this.$volumeSliderContainer.fadeTo(0,1),this._isSliderVisible=!0,this.$volumeButton.attr("title",this._popUpVolumeTitle),this._isMouseDown||this._touchId!==null||(this.hideTimer=setTimeout(f.bind(this),2e3)))},f=function(n){this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null),this.$volumeSliderContainer.fadeTo(n||1e3,0,rt.bind(this))},rt=function(){this.$volumeSliderContainer.css("opacity")==="0"&&(this.$volumeSliderContainer.hide(),this._isSliderVisible=!1,this.$volumeButton.attr("title",this._defaultVolumeTitle))},ut=function(){t(document).bind("mousemove",this._document_OnMouseMove)},ft=function(){t(document).unbind("mousemove",this._document_OnMouseMove)};n.Namespace.define("Wol.Video.MetroPlayer",{VolumeButton:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,e,{_isVolumeControlSupported:w,_setVolumeButtonState:g,_setMutedButtonState:nt,_respondToMouse:d,_showSlider:it,_fadeSlider:f,_setSliderHeight:tt,_attachMouseMoveEvent:ut,_detachMouseMoveEvent:ft},{})})}(WinJS,jQuery),function(n){"use strict";var r=function(n,t){this.playerObj=n,this.controlBarObj=t,this.$fullScreenButtonElement=t.$rootElement.find("button.mpBtnFullScreen").first(),this.$restoreButtonElement=t.$rootElement.find("button.mpBtnRestore").first(),n.addEventListener("fullscreenchange",e.bind(this),!1),this.$fullScreenButtonElement.click(u.bind(this)),this.$restoreButtonElement.click(f.bind(this))},u=function(){this.playerObj.fullScreen(!0)},f=function(){this.playerObj.fullScreen(!1)},e=function(){this._setState(this.playerObj.fullScreen())},o=function(n){var t,i;n?(t=this.$fullScreenButtonElement.is(":focus"),this.$fullScreenButtonElement.hide(),this.$restoreButtonElement.show(),t&&this.$restoreButtonElement.focus()):(i=this.$restoreButtonElement.is(":focus"),this.$fullScreenButtonElement.show(),this.$restoreButtonElement.hide(),i&&this.$fullScreenButtonElement.focus())};n.Namespace.define("Wol.Video.MetroPlayer",{FullScreenButton:n.Class.derive(Wol.Video.MetroPlayer.ControlBase,r,{_setState:o},{})})}(WinJS,jQuery),function(n){"use strict";var r={escape:27,space:32,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40},u=function(n){this.playerObj=n,this.playerObj.$rootElement.get(0).addEventListener("keydown",e.bind(this),!0),this.playerObj.$rootElement.click(f.bind(this))},f=function(n){n.target!==document.activeElement&&n.currentTarget.focus()},e=function(n){if(!this.playerObj.hasError){this.playerObj.$rootElement.addClass("mpKeyboard");var t=n.which;switch(t){case r.space:this.playerObj.paused()?this.playerObj.play():this.playerObj.pause(),n.preventDefault();break;case r.leftArrow:this.playerObj.isChromeless||(this._setCurrentTime(-10),n.preventDefault());break;case r.rightArrow:this.playerObj.isChromeless||(this._setCurrentTime(10),n.preventDefault());break;case r.upArrow:this.playerObj.isChromeless||(this._setVolume(.05),n.preventDefault());break;case r.downArrow:this.playerObj.isChromeless||(this._setVolume(-.05),n.preventDefault());break;case r.escape:this._exitFullScreen(),n.preventDefault()}}},o=function(n){var t=this.playerObj.currentTime(),i=this.playerObj.duration();t+=n,t<0?t=0:t>i&&(t=i),this.playerObj.currentTime(t)},s=function(n){var t=this.playerObj.volume();t===1&&n>0?t=.999999:t===0&&n<0?t=1e-6:(t+=n,t<0?t=0:t>1&&(t=1)),this.playerObj.muted(!1),this.playerObj.volume(t)},h=function(){this.playerObj.fullScreen(!1)};n.Namespace.define("Wol.Video.MetroPlayer",{KeyboardAccessibility:n.Class.define(u,{_setCurrentTime:o,_setVolume:s,_exitFullScreen:h},{})})}(WinJS,jQuery),function(n){"use strict";var r=function(n){if(this.playerObj=n,this.$posterElement=n.$rootElement.find("div.mpPoster").first(),!this.$posterElement.length)return null;this.$posterImgElement=this.$posterElement.find("img").first(),this.endSrc=this.$posterImgElement.data("end-src"),this.$posterElement.click(e.bind(this)),this._resizePosterImage(),this.playerObj.addEventListener("play",o.bind(this),!1),this.playerObj.addEventListener("ended",s.bind(this),!1),this.playerObj.addEventListener("resize",u.bind(this),!1),this.$posterImgElement.bind("load",f.bind(this))},u=function(){this._resizePosterImage()},f=function(){var t=new Image;t.src=this.$posterImgElement.attr("src"),this._imageHeight=t.height,this._imageWidth=t.width,this._resizePosterImage()},e=function(){this.playerObj.hasError||this.playerObj.play()},o=function(){this.$posterElement.addClass("mpPosterHide"),this.endSrc&&this.$posterImgElement.attr("src",this.endSrc)},s=function(){this.$posterElement.removeClass("mpPosterHide"),this._resizePosterImage()},h=function(){var i=this.playerObj.$rootElement.width(),r=this.playerObj.$rootElement.height(),n=this._imageHeight,t=this._imageWidth,u,f;this._imageWidth&&this._imageHeight&&(u=n/r,f=t/i,u>f?(n=r,t=t/u,this.$posterImgElement.css("width","auto"),this.$posterImgElement.css("height","100%")):(t=i,n=n/f,this.$posterImgElement.css("width","100%"),this.$posterImgElement.css("height","auto")),this.$posterImgElement.css("top","50%").css("left","50%"),this.$posterImgElement.css("margin-left",-t/2).css("margin-top",-n/2))};n.Namespace.define("Wol.Video.MetroPlayer",{Poster:n.Class.define(r,{_resizePosterImage:h},{})})}(WinJS,jQuery),function(n,t){"use strict";var r=function(n,i,r){this.startTime=n,this.endTime=i,this.content=r,this.htmlContent=t("<span>"+r+"<\/span>").get(0)},u=function(){return this.htmlContent},f=function(){return this.content};n.Namespace.define("Wol.Video.MetroPlayer",{TrackCue:n.Class.define(r,{getCueAsHTML:u,getCueAsSource:f},{})})}(WinJS,jQuery),function(n,t){"use strict";var u=/^(\d{2,}):(\d{2}):(\d{2}(?:\.\d+)?)/,f=function(n){var i=[];return t(n).find("body *[begin]").each(function(){var n=t(this),u=r(n.attr("begin")),f=r(n.attr("end")),o=e(this);i.push(new Wol.Video.MetroPlayer.TrackCue(u,f,o))}),i},e=function(n){for(var i=document.createElement("div"),t,r=0;r<n.childNodes.length;++r)if(t=n.childNodes[r],t.nodeType===Node.TEXT_NODE)i.appendChild(document.createTextNode(t.nodeValue));else if(t.nodeType===Node.ELEMENT_NODE)if(t.nodeName==="br")i.appendChild(document.createElement("br"));else throw"Invalid Ttml node: "+t.localName;return i.innerHTML},r=function(n){var t;if(!n)throw"Ttml time absent";if(t=u.exec(n),!t)throw"Ttml time in incorrect format: "+n;var i=parseInt(t[1],10),r=parseInt(t[2],10),f=parseFloat(t[3]);return i*3600+r*60+f};n.Namespace.define("Wol.Video.TtmlParser",{parse:f})}(WinJS,jQuery),function(n,t,i){"use strict";var r=function(n){if(this.playerObj=n,this.$trackElement=n.$rootElement.find("track").first(),!this.$trackElement.length)return null;this._trackUrl=this.$trackElement.attr("src"),this.enabled=!1,this.hasError=!1,this.activeCuesArray=[],this.loadedCuesArray=null,this._currentCueIndex=-1,this._lastGoodCueIndex=-1,this._player_OnTimeUpdate=u.bind(this)},u=function(){this._refreshCues()},f=function(n){return n!==i&&(n=!!n,this.enabled!==n&&(this.enabled=n,n?(this._currentCueIndex=-1,this._lastGoodCueIndex=-1,this._attachEventListeners(),this.loadedCuesArray||this._loadCues(),this._refreshCues()):this._detachEventListeners(),a.call(this))),this.enabled},e=function(){return this.activeCuesArray},o=function(){var t=this.playerObj.currentTime(),i=this._lastGoodCueIndex,n=this._findCueIndex(t,i);n!==this._currentCueIndex&&(this.activeCuesArray.length=0,n!==-1&&(this.activeCuesArray.push(this.loadedCuesArray[n]),this._lastGoodCueIndex=n),this._currentCueIndex=n,v.call(this))},s=function(n,t){var i,u,r;if(!this.loadedCuesArray)return-1;if(t=t||0,t=Math.max(t,0),i=this.loadedCuesArray[t],u=this.loadedCuesArray.length,n>=i.startTime)for(r=t+1;r<u&&n>=this.loadedCuesArray[r].startTime;)t=r,r++;else while(t>=1&&this.loadedCuesArray[t].startTime>n)t--;return i=this.loadedCuesArray[t],i.startTime<=n&&i.endTime>=n?t:-1},h=function(){this.playerObj.addEventListener("timeupdate",this._player_OnTimeUpdate,!1)},c=function(){this.playerObj.removeEventListener("timeupdate",this._player_OnTimeUpdate,!1)},l=function(){t.ajax({url:this._trackUrl,context:this,dataType:"xml"}).done(function(n){try{this.loadedCuesArray=Wol.Video.TtmlParser.parse(n),this.hasError=!this.loadedCuesArray,!this.hasError&&this.enabled&&this._refreshCues()}catch(t){this.hasError=!0}}).fail(function(){this.hasError=!0})},a=function(){this.playerObj.dispatchEvent("closedcaptionchange",this)},v=function(){this.playerObj.dispatchEvent("cuechange",this)};n.Namespace.define("Wol.Video.MetroPlayer",{TextTrack:n.Class.define(r,{enable:f,activeCues:e,_loadCues:l,_refreshCues:o,_findCueIndex:s,_attachEventListeners:h,_detachEventListeners:c},{})})}(WinJS,jQuery),function(n){"use strict";var r=function(n){this.playerObj=n,this.$captionElement=n.$rootElement.find("div.mpCaption"),this.$captionInnerElement=this.$captionElement.find("div.mpCaptionInner"),this.playerObj.addEventListener("play",u.bind(this),!1),this.playerObj.addEventListener("ended",f.bind(this),!1),this.playerObj.addEventListener("cuechange",e.bind(this),!1),this.playerObj.addEventListener("closedcaptionchange",o.bind(this),!1),this.playerObj.addEventListener("resize",s.bind(this),!1)},u=function(){this._enableOverlay(this.playerObj.closedCaption())},f=function(){this._enableOverlay(!1)},e=function(n){var t=n.detail.activeCues();this.$captionInnerElement.children().remove(),t.length!==0?(this.$captionInnerElement.append(t[0].getCueAsHTML()),this.$captionElement.show()):this.$captionElement.hide()},o=function(n){this._enableOverlay(n.detail.enabled)},s=function(){this._resize()},h=function(n){n?this._resize():this.$captionElement.hide()},c=function(){var t=this.playerObj.$rootElement.width(),n=Math.max(t/50,14);this.fontSize=n,this.$captionElement.css("font-size",n+"px")};n.Namespace.define("Wol.Video.MetroPlayer",{ClosedCaptionOverlay:n.Class.define(r,{_enableOverlay:h,_resize:c},{})})}(WinJS,jQuery),function(n,t,i){"use strict";window.onPlayerReady=function(n){var t=n.Name,i=r[t];i&&(i._initialize(n),u[t]=i,delete r[t])},window.onPlayerCaptionsActivated=function(n){var t=u[n];t&&t._raiseClosedCaptionChangeEvent()};var r={},u={},f=function(n){var i=t(n),u,f;if(this.$rootElement=i.find("object.VideoPlayer").first(),!this.$rootElement.length)throw"SilverlightPlayer: Unable to initialize video";this._isPaused=!0,this._isClosedCaptionEnabled=!1,this._isFullScreen=!1,this._isEnded=!1,this.videoTechnology="Silverlight",u=this.$rootElement.children("param[name=InitParams]").attr("value"),this.initParams=ut(u),this.isInitialized=!1,f=this.$rootElement.data("script-id"),r[f]=this},e=function(n){this.isInitialized||(this.playerObj=n,this.playerObj.addEventListener("MediaOpened",o.bind(this)),this.playerObj.addEventListener("MediaEnded",s.bind(this)),this.playerObj.addEventListener("PlayStateChanged",h.bind(this)),this.playerObj.addEventListener("FullScreenChanged",c.bind(this)),this.isInitialized=!0)},o=function(){this.dispatchEvent("loadedmetadata")},s=function(){this._isEnded=!0,this.dispatchEvent("ended")},h=function(n,t){t&&(this._isPaused=t.Result!=="Playing",this._isPaused?this.dispatchEvent("pause"):(this._isEnded=!1,this.dispatchEvent("play")))},c=function(){this._isFullScreen=!this._isFullScreen,this.dispatchEvent("fullscreenchange",this._isFullScreen)},l=function(){this.isInitialized&&this.playerObj.Play()},a=function(){this.isInitialized&&this.playerObj.Pause()},v=function(n){return this.isInitialized?(n!==i&&this.playerObj.SeekToPosition(n),this.playerObj.PlaybackPositionSeconds):null},y=function(){return this.isInitialized?this.playerObj.EndPositionSeconds:null},p=function(){},w=function(){return this._isEnded},b=function(){return this._isPaused},k=function(n){return this.isInitialized?(n!==i&&this.playerObj.SetVolume(n),this.playerObj.GetVolume()):null},d=function(n){return this.isInitialized?(n!==i&&(n?(this._prevVolume=this.playerObj.GetVolume(),this.playerObj.SetVolume(0)):this._prevVolume&&this.playerObj.SetVolume(this._preVolume)),this.playerObj.GetVolume()===0):null},g=function(){return this.initParams.mediaurl},nt=function(){return this._isFullScreen},tt=function(){return this._isClosedCaptionEnabled},it=function(){throw"Not supported";},rt=function(){this._isClosedCaptionEnabled=!0,this.dispatchEvent("closedcaptionchange",{enabled:!0})},ut=function(n){for(var r={},u=n.split(","),i,t=0,f=u.length;t<f;t++)i=/([^=]*)=(.*)/.exec(u[t]),i&&(r[i[1]]=i[2]);return r},ft=function(n){var i=t(n);return!!t(n).find("object.VideoPlayer").length};n.Namespace.define("Wol.Video",{SilverlightPlayer:n.Class.derive(Wol.Video.PlayerBase,f,{play:l,pause:a,currentTime:v,duration:y,buffered:it,ended:w,paused:b,volume:k,muted:d,mediaUrl:g,fullScreen:nt,closedCaption:tt,enableTabbing:p,_initialize:e,_raiseClosedCaptionChangeEvent:rt},{isCompatible:ft})})}(WinJS,jQuery),function(n,t){"use strict";var r={heroEntranceDurationMS:1e3,immediate:0,opacity:{transparent:0,opaque:1},heroObjectKey:"wolVideoHero",Selectors:{heroContainer:"div.HeroContainer",heroVideoContainer:"div.HeroVideoContainer",heroVideoSizingContainer:"div.HeroVideoSizingContainer",endCardContainer:"div.EndCardContainer",heroVideoContainerParent:"div.HeroVideoContainerParent",cards:"div.heroVideoCard",heroCardShow:"div.heroVideoCardShow",background:".HeroVideoContainerBackground"}},e=function(n,i){if(this.$heroContainer=t(n),this.$heroContainer.hasClass("HeroContainer")||(this.$heroContainer=this.$heroContainer.find(r.Selectors.heroContainer).first()),!this.$heroContainer.length)throw"Wol.Video.Hero: Unable to instantiate due to missing hero container element";if(!i)throw"Wol.Video.Hero: Unable to instantiate due to an invalid player object";this.playerObj=i,this.hasEndCard=!1,t(o.bind(this))},o=function(){this.$heroVideoContainer=this.$heroContainer.find(r.Selectors.heroVideoContainer).first(),this.$endCardContainer=this.$heroContainer.find(r.Selectors.endCardContainer).first(),this.$heroVideoContainerParent=this.$heroContainer.find(r.Selectors.heroVideoContainerParent).first(),this.$backgroundCard=this.$heroContainer.find(r.Selectors.background).first(),this.$cards=this.$heroContainer.find(r.Selectors.cards),this.$endCardContainer.length?(this.hasEndCard=!0,this.$heroContainer.is(".ShowTitleCard")&&this.playerObj.enableTabbing(!1)):this.hasEndCard=!1,this._centerContent(),this.playerObj.addEventListener("ended",h.bind(this),!1),this.hasEndCard&&(this.$endCardContainer.find(".VSContainerSelected").click(c.bind(this)),this.$heroVideoSizingContainer=this.$heroContainer.find(r.Selectors.heroVideoSizingContainer).first(),this.sizingRatio=this.$heroVideoSizingContainer.data("aspect-ratio")||0,t(window).smartresize(u.bind(this)),u.call(this))},u=function(){var n=this.$heroVideoContainerParent.outerHeight()-this.$heroVideoSizingContainer.outerHeight(),t=this.$endCardContainer.outerHeight(),i=(t-n)*this.sizingRatio;this.$heroVideoSizingContainer.css("max-width",i)},s=function(){var i=this.$cards.filter(function(){var n=t(this).css("float");return n&&n!=="none"}),r,n;i.length>0&&(r=this.$heroContainer.innerHeight(),n=0,i.each(function(){var u=t(this),i=u.outerHeight(!0),f,e;n=Math.max(n,i),f=(r-i)/2,e=r-f-i,u.css({paddingTop:f,paddingBottom:e})}),this.$heroContainer.height(n))},h=function(){this.showEndCard()},c=function(n){this.replayVideo(),n.preventDefault()},l=function(n,i){var u=this.$cards.filter(n),e=this.$cards.not(n);return i?u=u.add(this.$backgroundCard):e=e.add(this.$backgroundCard),e.filter(r.Selectors.heroCardShow).fadeTo(r.immediate,r.opacity.opaque).fadeTo(r.heroEntranceDurationMS,r.opacity.transparent,function(){t(this).removeClass("heroVideoCardShow"),f(this)}),u.not(r.Selectors.heroCardShow).fadeTo(r.immediate,r.opacity.transparent).addClass("heroVideoCardShow").fadeTo(r.heroEntranceDurationMS,r.opacity.opaque,function(){f(this)}),this.$cards.promise()},a=function(){if(!this.hasEndCard)return!1;if(!this.$endCardContainer.hasClass("heroVideoCardShow")){var n=this.playerObj;n.enableTabbing(!1),this._showCard(this.$endCardContainer,!1)}return!0},v=function(){var n=this.$heroVideoContainerParent.offset(),i=this.$heroVideoContainerParent.innerHeight(),u=window.innerHeight,f;(n.top<window.pageYOffset||n.top+i>window.pageYOffset+u)&&(f=n.top-(u-i)/2,t("html,body").animate({scrollTop:f},{duration:r.heroEntranceDurationMS,queue:!1,always:function(){window.scrollTo(window.pageXOffset,f)}}))},y=function(){var n=this.playerObj;n.play(),this.hasEndCard&&this._showCard(this.$heroVideoContainerParent,!0).done(function(){n.enableTabbing(!0)}),this.ensureVideoVisible()},f=function(n){t(n).css("filter","")},p=function(n){n.addClass("ErrorOverride");var t=n.find(r.Selectors.cards);t.not(r.Selectors.heroVideoContainerParent).removeClass("heroVideoCardShow"),t.filter(r.Selectors.heroVideoContainerParent).addClass("heroVideoCardShow")},w=function(n){var i=t(n).closest(r.Selectors.heroContainer),f,u;return i.length?(f=Wol.Video.PlayerBase.getVideoPlayer(i.get(0)),!f)?(p(i),null):(u=new Wol.Video.Hero(i,f),u&&i.data(r.heroObjectKey,u),u):null},b=function(n){var i=t(n).closest(r.Selectors.heroContainer),u;return i.length?(u=i.data(r.heroObjectKey),u instanceof Wol.Video.Hero)?u:null:null};n.Namespace.define("Wol.Video",{Hero:n.Class.define(e,{showEndCard:a,replayVideo:y,ensureVideoVisible:v,_showCard:l,_centerContent:s},{initialize:w,getParentHero:b})})}(WinJS,jQuery),function(n){"use strict";var r=0,u=255,f=function(n){this.playerObj=n,this.started=!1,this.errorCode=r,this.fullscreen=!1,this.closedCaptions=!1,this.watchTime=0,this.duration=0,this.videoTech=n.videoTechnology,this.hasLogged=!1,n.addEventListener("loadedmetadata",e.bind(this),!1),n.addEventListener("error",o.bind(this),!1),n.addEventListener("play",s.bind(this),!1),n.addEventListener("ended",h.bind(this),!1),n.addEventListener("closedcaptionchange",c.bind(this),!1),n.addEventListener("fullscreenchange",l.bind(this),!1),y(a.bind(this))},e=function(){this.duration=this.playerObj.duration()||0,this.mediaUrl=this.playerObj.mediaUrl()||""},o=function(n){this.errorCode=n&&n.detail&&n.detail.code?n.detail.code:u;try{this.watchTime=this.playerObj.currentTime()||0}catch(n){}this._notify()},s=function(){this.started=!0},h=function(){this.watchTime=this.duration,this._notify()},c=function(){this.closedCaptions=!0},l=function(){this.playerObj.fullScreen()&&(this.fullscreen=!0)},a=function(){this.watchTime=this.playerObj.currentTime()||0,this._notify()},v=function(n,t){var i=t>0?Math.round(10*(n/t))*10:0;return!i||i<0?i=0:i>100&&(i=100),i},y=function(n){Wol.Util.OnBeforeUnload.attach(n)},p=function(){if(!this.hasLogged){var n={"Video.Tech":this.videoTech,"Video.Url":this.mediaUrl,"Video.Error":this.errorCode,"Video.Start":this.started?1:0,"Video.FullScreen":this.fullscreen?1:0,"Video.ClosedCaption":this.closedCaptions?1:0,"Video.Length":this.duration,"Video.WatchTime":this.watchTime,"Video.CompletionRate":v(this.watchTime,this.duration)};Wol.ContentInstrumentation.Logging.LogCustomBI("Video",n,this.playerObj.$rootElement[0]),this.hasLogged=!0}};n.Namespace.define("Wol.Video",{BI:n.Class.define(f,{_notify:p},{})})}(WinJS,jQuery),function(n,t){"use strict";t(function(){r(),typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"&&Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function(){r()});t(document).on("done.mvt",r)});var r=function(){u(t(document)),f(t(document))},u=function(n){Modernizr.svg||n.find("img.png-fallback").removeClass("png-fallback").attr("src",function(n,i){t(this).attr("src",i.replace(".svg",".png"))})},f=function(n){n.find("div.svg-embed").each(function(){var r=t(this).parent(),n=t(this);if(Modernizr.inlinesvg){var u=n.data("svg-sprite"),f=n.data("svg-fragment"),e=n.data("svg-css-class");t.ajax({url:u,dataType:"html"}).done(function(n){var o=t(n),s=o.find("symbol[id="+f+"]"),u=t('<svg xmlns="http://www.w3.org/2000/svg"><\/svg>');u.attr("class",e),u.attr("width","100%"),u.attr("height","100%"),u.append(s.children()),r.append(u)})}else{var o=n.data("fallback-png-sprite"),i=t("<img/>"),s=n.data("fallback-img-attr");i.attr(s),i.attr("src",o),r.append(i)}n.remove()})};n.Namespace.define("Wol.Svg",{replaceSvgWithPng:u,embedSvg:f})}(WinJS,jQuery),function(n,t){"use strict";var p="MS.MvtFactor",h={NoCall:0,Success:1,Failure:2},r,e=[],c=[],l=h.NoCall,a="",v=null,o=null,s=!1,u=function(n){r&&r.css("visibility",n?"inherit":"hidden")},y=function(n){var r=t("div#"+n+"_container"),i=function(){return r.data("default-treatment-id")||""},u=function(r){var u=i(),o=u;if(u&&r&&u!==r){var f=t("div#"+r),s=t("div#"+u),h=f.data("treatment");s.length>0&&f.length>0&&h&&(s.html("").addClass("mvt-unselected-treatment"),f.html(h).removeClass("mvt-unselected-treatment"),o=r)}e.push(n),c.push(o)};return{getDefaultTreatment:i,selectTreatment:u}},b=function(){var n="",t;try{t=Wol.Util.Tools.parseUrlParams(window.location.search),n=t.mvt}catch(i){}return n},k=function(n){var o,i,r,f,e,s;u(!1);try{for(o=n.split(","),e=0,s=o.length;e<s;e++)i=o[e].split(":"),i.length>1&&(r=t.trim(i[0])||"",f=t.trim(i[1])||"",r&&f&&y(r).selectTreatment(r+"_"+f))}catch(h){}t(document).trigger("done.mvt"),u(!0)},w=function(){r.each(function(){var i=t(this).attr(p)||"",r;t.inArray(i,e)===-1&&(r=y(i).getDefaultTreatment(),i&&r&&(e.push(i),c.push(r)))});var n={CallResult:l,CallDuration:o&&v?o-v:0,Factors:e,Treatments:c};Wol.ContentInstrumentation.Logging.LogCustomBI("Mvt",n)},f=function(){u(!0),l=h.Failure,o=new Date,w()},d=function(n){var t=n.params&&n.params.display===!1||!1;u(!t)},g=function(n){r&&r.each(function(){var i=t(this).attr(p),r=t("div#"+i,this),u=i+"_"+(r&&r.text()||"");y(i).selectTreatment(u)}),a=n.target&&n.target.getParams().testAlias||"",t(document).trigger("done.mvt")},nt=function(){r&&r.length>0&&(l=h.Success,o=new Date,w()),t("a[MS\\.ConversionCode]").click(function(){try{var n=t(this).attr("MS.ConversionCode");WTOptimize&&a&&n&&WTOptimize.conversion(a,this,{conversionPoint:n,beacon:!0})}catch(i){}})},tt=function(n){var i,u;try{i=!0,r=t("div[MS\\.MvtFactor]"),r&&r.length>0&&(u=b(),u&&(k(u),i=!1,s=!0)),i&&WTOptimize&&(s=!0,WTOptimize.addEventHandler(WTEvent.INVALID,f),WTOptimize.addEventHandler(WTEvent.ABORT,f),WTOptimize.addEventHandler(WTEvent.RENDER,g,f),WTOptimize.addEventHandler(WTEvent.DONE,nt,f),WTOptimize.addEventHandler(WTEvent.PAGEVIEW,null,f),WTOptimize.addEventHandler(WTEvent.HIDESHOW,d),v=new Date,WTOptimize.setup({s_pageDisplayMode:"none",s_pageTimeout:n}))}catch(e){s=!1}};n.Namespace.define("Wol.Mvt",{initialize:tt}),t(function(){s||(r||(r=t("div[MS\\.MvtFactor]")),u(!0))})}(WinJS,jQuery);